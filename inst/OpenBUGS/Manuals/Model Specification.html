<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Model Specification</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="model specification0.bmp" alt="[model specification0]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="6"><strong><sup>Model Specification Language</sup></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"> </font><font face="Arial" color="#000100" size="2"><br><a id="Contents"></font><font face="Arial" color="#000100" size="5"><strong>Contents</strong></font><font face="Arial" color="#000100" size="2"></a><br></font><font face="Arial" color="#0000FF" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#GraphicalModels"></font><font face="Arial" color="#0000FF" size="4"><u>Graphical&nbsp;models</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#GraphsAsAFormalLanguage"></font><font face="Arial" color="#0000FF" size="4"><u>Graphs&nbsp;as&nbsp;a&nbsp;formal&nbsp;language</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#TheBUGSLanguageStochasticNodes"></font><font face="Arial" color="#0000FF" size="4"><u>The&nbsp;BUGS&nbsp;language:&nbsp;stochastic&nbsp;nodes</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#CensoringAndTruncation"></font><font face="Arial" color="#0000FF" size="4"><u>Censoring&nbsp;and&nbsp;truncation</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#ConstraintsOnUsingCertainDistributions"></font><font face="Arial" color="#0000FF" size="4"><u>Constraints&nbsp;on&nbsp;using&nbsp;certain&nbsp;distributions</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#LogicalNodes"></font><font face="Arial" color="#0000FF" size="4"><u>Logical&nbsp;nodes</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#ArraysAndIndexing"></font><font face="Arial" color="#0000FF" size="4"><u>Arrays&nbsp;and&nbsp;indexing</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#RepeatedStructures"></font><font face="Arial" color="#0000FF" size="4"><u>Repeated&nbsp;structures</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#DataTransformations"></font><font face="Arial" color="#0000FF" size="4"><u>Data&nbsp;transformations</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#0000FF" size="4"><u><br></u></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#NestedIndexingAndMixtures"></font><font face="Arial" color="#0000FF" size="4"><u>Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#FormattingOfData"></font><font face="Arial" color="#0000FF" size="4"><u>Formatting&nbsp;of&nbsp;data</u></font><font face="Arial" color="#0000FF" size="4"></a><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="2"><u><br></u></font><font face="Arial" color="#000100" size="2"><br><a id="GraphicalModels"></font><font face="Arial" color="#000100" size="5"><strong>Graphical models</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">We strongly recommend that the first step in any analysis should be the construction of a </font><font face="Arial" color="#000100" size="3"><em>directed graphical model</em></font><font face="Arial" color="#000100" size="3">. Briefly, this represents all quantities as nodes in a directed graph, in which arrows run into nodes from their direct influences (parents). The model represents the assumption that, given its parent nodes pa[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">], each node </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3"> is independent of all other nodes in the graph except descendants of </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">, where descendant has the obvious definition.<br><br>Nodes in the graph are of three types.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">1. </font><font face="Arial" color="#000100" size="3"><em>Constants</em></font><font face="Arial" color="#000100" size="3"> are fixed by the design of the study: they are always founder nodes (</font><font face="Arial" color="#000100" size="3"><em>i.e.</em></font><font face="Arial" color="#000100" size="3"> do not have parents), and are denoted as rectangles in the graph. They must be specified in a data file.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">2. </font><font face="Arial" color="#000100" size="3"><em>Stochastic node</em></font><font face="Arial" color="#000100" size="3">s are variables that are given a distribution, and are denoted as ellipses in the graph; they may be parents or children (or both). Stochastic nodes may be observed in which case they are </font><font face="Arial" color="#000100" size="3"><em>data</em></font><font face="Arial" color="#000100" size="3">, or may be unobserved and hence be </font><font face="Arial" color="#000100" size="3"><em>parameters</em></font><font face="Arial" color="#000100" size="3">, which may be unknown quantities underlying a model, observations on an individual case that are unobserved say due to censoring, or simply missing data.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">3. </font><font face="Arial" color="#000100" size="3"><em>Deterministic nodes</em></font><font face="Arial" color="#000100" size="3"> are logical functions of other nodes.<br><br>Quantities are specified to be data by giving them values in a data file, in which values for constants are also given.<br><br>Directed links may be of two types: a solid arrow indicates a stochastic dependence while a hollow arrow indicates a logical function. An undirected dashed link may also be drawn to represent an upper or lower bound.<br><br>Repeated parts of the graph can be represented using a 'plate', as shown below for the range</font><font face="Arial" color="#000100" size="3"><em> (i in 1:N)</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="2"><br><img src="model specification1.bmp" alt="[model specification1]"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">A simple graphical model, where Y[i] depends on mu[i] and tau, with mu[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;being a logical function of alpha and beta.<br></font><font face="Arial" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br>The conditional independence assumptions represented by the graph mean that the full joint distribution of all quantities </font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="3"> has a simple factorisation in terms of the conditional distribution p(</font><font face="Arial" color="#000100" size="3"><em>v </em></font><font face="Arial" color="#000100" size="3">| parents[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">]) of each node given its parents, so that</font><font face="Arial" color="#000100" size="2"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">p(</font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="6"><sub>P</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">p(</font><font face="Arial" color="#000100" size="3"><em>v </em></font><font face="Arial" color="#000100" size="3">| parents[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">])&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v</em></font><font face="Arial" color="#000100" size="3"> in </font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">The crucial idea is that we need only provide the parent-child distributions in order to fully specify the model, and </font><font face="Arial" color="#000100" size="3"><em>WinBUGS </em></font><font face="Arial" color="#000100" size="3">then sorts out the necessary sampling methods directly from the expressed graphical structure.<br></font><font face="Arial" color="#000100" size="2"><br><a id="GraphsAsAFormalLanguage"></font><font face="Arial" color="#000100" size="5"><strong>Graphs as a formal language</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">A special drawing tool </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/DoodleBUGS Manual.html"></font><font face="Arial" color="#0000FF" size="3"><em><u>DoodleBUGS</u></em></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> has been developed for specifying graphical models, which uses a hyper-diagram approach to add extra information to the graph to give a complete model specification. Each stochastic and logical node in the graph must be given a name using the conventions explained in </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/DoodleBUGS Manual.html#CreatingANode"></font><font face="Arial" color="#0000FF" size="3"><u>Creating&nbsp;a&nbsp;node</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="2"><br>.<img src="model specification2.bmp" alt="[model specification2]"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The shaded node Y[i] is normally distributed with mean mu[i] and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision tau.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="2"><br><img src="model specification3.bmp" alt="[model specification3]"></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">The shaded node mu[i] is a logical function of alpha, beta, and the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants x. (x is not required to be shown in the graph).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The value function of a logical node contains all the necessary information to define the logical node: the logical links in the graph are not strictly necessary.<br>&nbsp;&nbsp;&nbsp;<br>As an alternative to the Doodle representation, the model can be specified using the text-based </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language, headed by the model statement:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;text-based description of graph in BUGS language</em></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><a id="TheBUGSLanguageStochasticNodes"></font><font face="Arial" color="#000100" size="5"><strong>The </strong></font><font face="Arial" color="#000100" size="5"><strong><em>BUGS</em></strong></font><font face="Arial" color="#000100" size="5"><strong> language: stochastic nodes</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">In the text-based model description, stochastic nodes are represented by the node name followed by a twiddles symbol followed by the distribution name followed by a comma-separated list of parents enclosed in brackets </font><font face="Arial" color="#000100" size="3"><em>e.g.<br><br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r ~ dbin(p, n)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The distributions that can be used in </font><font face="Arial" color="#000100" size="3"><em>WinBUGS </em></font><font face="Arial" color="#000100" size="3">are described in </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Distributions.html"></font><font face="Arial" color="#0000FF" size="3"><u>Distributions</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">. Clicking on the name of each distribution should provide a link to an example of its use provided with this release. The parameters of a distribution must be explicit nodes in the graph (scalar parameters can also be numerical constants) and so may not be function expressions.<br><br></font><font face="Arial" color="#000100" size="3"><strong>For distributions not featured in </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Distributions.html"></font><font face="Arial" color="#0000FF" size="3"><u>Distributions</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"><strong>, see </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Tricks.html"></font><font face="Arial" color="#0000FF" size="3"><u>Tricks:&nbsp;Advanced&nbsp;Use&nbsp;of&nbsp;the&nbsp;BUGS&nbsp;Language</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3"><strong>.</strong></font><font face="Arial" color="#FF00FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><a id="CensoringAndTruncation"></font><font face="Arial" color="#000100" size="5"><strong>Censoring and truncation</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Censoring is denoted using the notation I(lower, upper) </font><font face="Arial" color="#000100" size="3"><em>e.g.</em></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x ~ ddist(theta)I(lower, upper)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>would denote a quantity x from distribution ddist with parameters theta, which had been observed to lie between lower and upper. Leaving either lower or upper blank corresponds to no limit, e.g. I(lower,) corresponds to an observation known to lie above lower. Whenever censoring is specified the censored node contributes a term to the full conditional distribution of its parents. This structure is only of use if x has not been observed (if x is observed then the constraints will be ignored).</font><font face="Arial" color="#FF00FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong>It is vital to note that this construct does NOT correspond to a truncated distribution</strong></font><font face="Arial" color="#000100" size="3">, which generates a likelihood that is a complex function of the basic parameters. Truncated distributions might be handled by working out an algebraic form for the likelihood and using the techniques for arbitrary distributions described in </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Tricks.html"></font><font face="Arial" color="#0000FF" size="3"><u>Tricks:&nbsp;Advanced&nbsp;Use&nbsp;of&nbsp;the&nbsp;BUGS&nbsp;Language</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">.<br><br>It is also important to note that if x, theta, lower and upper are all unobserved, then lower and upper must not be functions of theta.<br><br></font><font face="Arial" color="#000100" size="2"><a id="ConstraintsOnUsingCertainDistributions"></font><font face="Arial" color="#000100" size="5"><strong>Constraints on using certain distributions</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong>Contiguous elements:</strong></font><font face="Arial" color="#000100" size="3"> Multivariate nodes must form contiguous elements in an array. Since the final element in an array changes fastest, such nodes must be defined as the final part of any array. For example, to define a set of K * K Wishart variables as a single multidimensional array x[i,j,k], we could write:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:I) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i, 1:K, 1:K] ~ dwish(R[i,,], 3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>where R[i,,] is an array of specified prior parameters.<br><br></font><font face="Arial" color="#000000" size="3"><strong>No missing data:</strong></font><font face="Arial" color="#000000" size="3"> Data defined as multinomial or as multivariate Student-t must be complete, in that missing values are not allowed in the data array. We realise this is an unfortunate restriction and we hope to relax it in the future. For multinomial data, it may be possible to get round this problem by re-expressing the multivariate likelihood as a sequence of conditional univariate binomial distributions.<br></font><font face="Arial" color="#000000" size="3"><strong><br><a id="ConstraintsOnUsingCertainDistributionsNoteThatMVN">Note that multivariate normal data may now be specified with missing values.</a></strong></font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000000" size="3"><strong>Conjugate updating:</strong></font><font face="Arial" color="#000000" size="3"> Dirichlet and Wishart distributions can only be used as parents of multinomial and multivariate normal nodes respectively.<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong>Parameters you can't learn about and must specify as constants: </strong></font><font face="Arial" color="#000100" size="3">The parameters of Wishart distributions, the order (N) of the multinomial distribution and the threshold (mu) of the generalized Pareto distribution must be specified and cannot be given prior distributions.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong>Structured precision matrices for multivariate normals:</strong></font><font face="Arial" color="#000100" size="3"> these can be used in certain circumstances. If a Wishart prior is not used for the precision matrix of a multivariate normal node, then the elements of the precision matrix are updated univariately without any check of positive-definiteness. This will result in a crash </font><font face="Arial" color="#000000" size="3">unless the precision matrix is parameterised appropriately. </font><font face="Arial" color="#000000" size="3"><strong>This is the user's responsibility!</strong></font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="ConstraintsOnUsingCertainDistributionsNonIntegerData">Non-integer data for Poisson and binomial:</a></strong></font><font face="Arial" color="#000000" size="3"> Previously only integer-valued data were allowed with Poisson and binomial distributions - this restriction has now been lifted. More generally, it is now possible to specify a Poisson prior for any continuous quantity.</font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="ConstraintsOnUsingCertainDistributionsRangeConstraints">Range constraints</a> - using the I(.,.) notation - cannot be used with multivariate nodes:</strong></font><font face="Arial" color="#000000" size="3"> except for multivariate normal distributions in which case the arguments to the I(.,.) function may be specified as 'blanks' or as vector-valued bounds.<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="LogicalNodes"></font><font face="Arial" color="#000100" size="5"><strong>Logical nodes</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Logical nodes are represented by the node name followed by a left pointing arrow followed by a logical expression of its parent nodes e.g.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Logical expressions can be built using the following operators: plus, multiplication, minus, division and unitary minus. The functions in Table I below can also be used in logical expressions.<br><br>In Table I, function arguments represented by </font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3"> can be expressions, those by </font><font face="Arial" color="#000100" size="3"><em>s</em></font><font face="Arial" color="#000100" size="3"> must be scalar-valued nodes in the graph and those represented by </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3"> must be vector-valued nodes in a graph.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong>Table I: Functions</strong></font><font face="Arial" color="#000100" size="5"><strong><u><br></u></strong></font><font face="Arial" color="#000100" size="1"><strong><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></u></strong></font><font face="Arial" color="#000100" size="1"><strong><br></strong></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3">abs(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;|</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">|<br></font><font face="Arial" color="#000000" size="3">cloglog</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(-ln(1 - </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">))<br></font><font face="Arial" color="#000100" size="3">cos(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;cosine(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">)<br></font><font face="Arial" color="#000000" size="3"><a id="CutFunction">cut(e)</a></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;cuts edges in the graph - see </font><font face="Arial" color="#0000FF" size="2"><strong><a href="../Manuals/Tricks.html#UseOfTheCutFunction"></strong></font><font face="Arial" color="#0000FF" size="2"><strong><u>Use&nbsp;of&nbsp;the&nbsp;&quot;cut&quot;&nbsp;function</u></strong></font><font face="Arial" color="#0000FF" size="2"><strong></a></strong></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3">equals(e1, e2)</font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;1 if </font><font face="Arial" color="#000000" size="2"><em>e</em></font><font face="Arial" color="#000000" size="2">1 = </font><font face="Arial" color="#000000" size="2"><em>e</em></font><font face="Arial" color="#000000" size="2">2; 0 otherwise<br></font><font face="Arial" color="#000000" size="3">exp</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;exp(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">)<br></font><font face="Arial" color="#000000" size="3"><sup>inprod(v1, v2)</sup></font><font face="Arial" color="#000000" size="3"><sup>&nbsp;&nbsp;&nbsp;</sup></font><font face="Symbol" color="#000100" size="6"><sub>S</sub></font><font face="Arial" color="#000000" size="1"><sub>i</sub></font><font face="Arial" color="#000000" size="2"><em><sup>v</sup></em></font><font face="Arial" color="#000000" size="2"><sup>1</sup></font><font face="Arial" color="#000000" size="1"><sub>i</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="2"><em><sup>v</sup></em></font><font face="Arial" color="#000000" size="2"><sup>2</sup></font><font face="Arial" color="#000000" size="2"><sub>i</sub></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><a id="InterpLinFunction">interp.lin(e, v1, v2)</a></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2"> + (</font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1</sub></font><font face="Arial" color="#000000" size="2"> - </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">) * (</font><font face="Arial" color="#000000" size="2"><em>e</em></font><font face="Arial" color="#000000" size="2"> - </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">) / (</font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1</sub></font><font face="Arial" color="#000000" size="2"> - </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">)<br>&nbsp;&nbsp;&nbsp;where the elements of </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1 are in ascending order<br>&nbsp;&nbsp;&nbsp;and p is such that </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2"> &lt; </font><font face="Arial" color="#000000" size="2"><em>e</em></font><font face="Arial" color="#000000" size="2"> &lt; </font><font face="Arial" color="#000000" size="2"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1</sub></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><sup>inverse</sup></font><font face="Arial" color="#000100" size="3"><sup>(v)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="1"><sup>-1</sup></font><font face="Arial" color="#000100" size="2"> for symmetric positive-definite matrix </font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">log</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">)<br></font><font face="Arial" color="#000100" size="3">logdet(v)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(det(</font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="2">)) for symmetric positive-definite </font><font face="Arial" color="#000100" size="2"><em>v<br></em></font><font face="Arial" color="#000100" size="3">logfact(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">!)<br></font><font face="Arial" color="#000100" size="3">loggam(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(G(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">))<br></font><font face="Arial" color="#000000" size="3">logit</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ln(</font><font face="Arial" color="#000100" size="2"><em>e </em></font><font face="Arial" color="#000100" size="2">/ (1 - </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">))<br></font><font face="Arial" color="#000100" size="3">max(e1, e2)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">1 if </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">1 &gt; </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">2; </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">2 otherwise<br></font><font face="Arial" color="#000000" size="3"><sup>mean</sup></font><font face="Arial" color="#000100" size="3"><sup>(v)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;n</font><font face="Arial" color="#000100" size="1"><sup>-1</sup></font><font face="Symbol" color="#000100" size="6"><sub>S</sub></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> n = dim(</font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="2">)<br></font><font face="Arial" color="#000100" size="3">min(e1, e2)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">1 if </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">1 &lt; </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">2; </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">2 otherwise<br></font><font face="Arial" color="#000100" size="3">phi(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;standard normal cdf<br></font><font face="Arial" color="#000100" size="3"><sup>pow(e1, e2)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">1</font><font face="Arial" color="#000100" size="1"><em><sup>e</sup></em></font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">sin(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;sine(</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2">)<br></font><font face="Arial" color="#000000" size="3"><sup>sqrt</sup></font><font face="Arial" color="#000100" size="3"><sup>(e)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="1"><sup>1/2</sup></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">rank(v, s)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;number of components of </font><font face="Arial" color="#000100" size="2"><em>v </em></font><font face="Arial" color="#000100" size="2">less than or equal to </font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="1"><sub>s</sub></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><sup>ranked(v, s)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;the </font><font face="Arial" color="#000100" size="2"><em>s</em></font><font face="Arial" color="#000100" size="1"><sup>th</sup></font><font face="Arial" color="#000100" size="2"> smallest component of </font><font face="Arial" color="#000100" size="2"><em>v<br></em></font><font face="Arial" color="#000100" size="3">round(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;nearest integer to </font><font face="Arial" color="#000100" size="2"><em>e<br></em></font><font face="Arial" color="#000100" size="3">sd(v)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;standard deviation of components of </font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="2"> (n - 1 in denominator)<br></font><font face="Arial" color="#000000" size="3">step</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;1 if </font><font face="Arial" color="#000100" size="2"><em>e</em></font><font face="Arial" color="#000100" size="2"> &gt;= 0; 0 otherwise<br></font><font face="Arial" color="#000100" size="3"><sup>sum(v)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="6"><sub>S</sub></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><em>v</em></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">trunc(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;greatest integer less than or equal to </font><font face="Arial" color="#000100" size="2"><em>e<br></em></font><font face="Arial" color="#000100" size="1"><strong><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></u></strong></font><font face="Arial" color="#000100" size="2"><em></em></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">A link function can also be specified acting on the left hand side of a logical node </font><font face="Arial" color="#000100" size="3"><em>e.g.</em></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(mu[i]) &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The following functions can be used on the left hand side of logical nodes as link functions: log, logit, cloglog, and probit (where probit(x) &lt;- y is equivalent to x &lt;- phi(y)).<br><br></font><font face="Arial" color="#000100" size="3"><strong>It is important to keep in mind that logical nodes are included only for notational convenience - they cannot be given data or initial values (except when using the data transformation facility described </strong></font><font face="Arial" color="#0000FF" size="3"><a href="#DataTransformations"></font><font face="Arial" color="#0000FF" size="3"><u>below</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"><strong>).<br></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong>Deviance:</strong></font><font face="Arial" color="#000100" size="3"> A logical node called &quot;deviance&quot; is created automatically by WinBUGS: this stores -2 * log(likelihood), where 'likelihood' is the conditional probability of all data nodes given their stochastic parent nodes. This node can be monitored, and contributes to the DIC function - see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/The Inference Menu.html#DIC"></font><font face="Arial" color="#0000FF" size="3"><u>DIC...</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><a id="ArraysAndIndexing"></font><font face="Arial" color="#000100" size="5"><strong>Arrays and indexing</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Arrays are indexed by terms within square brackets. The four basic operators +, -, *, and / along with appropriate bracketing are allowed to calculate an integer function as an index, for example:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[(i + j) * k, l]<br><br>On the left-hand-side of a relation, an expression that always evaluates to a fixed value is allowed for an index, whether it is a constant or a function of data. On the right-hand-side the index can be a fixed value or a named node, which allows a straightforward formulation for mixture models in which the appropriate element of<br>an array is 'picked' according to a random quantity (see </font><font face="Arial" color="#0000FF" size="3"><a href="#NestedIndexingAndMixtures"></font><font face="Arial" color="#0000FF" size="3"><u>Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">). However, functions of unobserved nodes are not permitted to appear directly as an index term (intermediate deterministic nodes may be introduced if such functions are required).<br><br>The conventions broadly follow those of S-Plus:<br><br>&nbsp;&nbsp;&nbsp;n:m&nbsp;&nbsp;&nbsp;represents </font><font face="Arial" color="#000100" size="3"><em>n</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><em>n</em></font><font face="Arial" color="#000100" size="3"> + 1, ..., </font><font face="Arial" color="#000100" size="3"><em>m</em></font><font face="Arial" color="#000100" size="3">.<br>&nbsp;&nbsp;&nbsp;x[]&nbsp;&nbsp;&nbsp;represents all values of a vector </font><font face="Arial" color="#000100" size="3"><em>x</em></font><font face="Arial" color="#000100" size="3">.<br>&nbsp;&nbsp;&nbsp;y[,3]&nbsp;&nbsp;&nbsp;indicates all values of the third column of a two-dimensional array </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Multidimensional arrays are handled as one-dimensional arrays with a constructed index. Thus functions defined on arrays must be over equally spaced nodes within an array: for example sum(i, 1:4, k).<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000000" size="3">When dealing with unbalanced or hierarchical data a number of different approaches are possible - see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#HandlingUnbalancedDatasets"></font><font face="Arial" color="#0000FF" size="3"><u>Handling&nbsp;unbalanced&nbsp;datasets</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3">. The ideas discussed in </font><font face="Arial" color="#0000FF" size="3"><a href="#NestedIndexingAndMixtures"></font><font face="Arial" color="#0000FF" size="3"><u>Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3"> may also be helpful in this respect; the user should bear in mind, however, the 'contiguous elements' restriction described in </font><font face="Arial" color="#0000FF" size="3"><a href="#ConstraintsOnUsingCertainDistributions"></font><font face="Arial" color="#0000FF" size="3"><u>Constraints&nbsp;on&nbsp;using&nbsp;certain&nbsp;distributions</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3">.<br><br></font><font face="Arial" color="#000000" size="2"><a id="RepeatedStructures"></font><font face="Arial" color="#000000" size="5"><strong>Repeated structures</strong></font><font face="Arial" color="#000000" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#FF0000" size="5"><strong><br></strong></font><font face="Arial" color="#000000" size="3">Repeated structures are specified using a &quot;for-loop&quot;. The syntax for this is:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in a:b) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><em>list of statements to be repeated for increasing values of loop-variable </em></font><font face="Arial" color="#000000" size="3">i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Note that neither a nor b may be stochastic - see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#WhereTheSizeOfASetIsARandomQuantity"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3"> for a possible way to get round this.<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="DataTransformations"></font><font face="Arial" color="#000100" size="5"><strong>Data transformations</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Although transformations of data can always be carried out before using </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3">, it is convenient to be able<br>to try various transformations of dependent variables within a model description. For example, we may wish to try both </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>sqrt(y)</em></font><font face="Arial" color="#000100" size="3"> as dependent variables without creating a separate variable </font><font face="Arial" color="#000100" size="3"><em>z = sqrt(y)</em></font><font face="Arial" color="#000100" size="3"> in the data file.<br><br>The BUGS language therefore permits the following type of structure to occur:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z[i] &lt;- sqrt(y[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z[i] ~ dnorm(mu, tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>Strictly speaking, this goes against the declarative structure of the model specification, with the accompanying exhortation to construct a directed graph and then to make sure that each node appears once and only once on the left-hand side of a statement. However, a check has been built in so that, when finding a logical node which also features as a stochastic node (such as z above), a stochastic node is created with the calculated values as fixed data.<br><br>We emphasise that this construction is only possible when transforming observed data (not a function of data and parameters) with no missing values.<br><br>This construction is particularly useful in Cox modelling and other circumstances where fairly complex functions of data need to be used. It is preferable for clarity to place the transformation statements in a section at the beginning of the model specification, so that the essential model description can be examined separately. See the </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Leuk.html"></font><font face="Arial" color="#0000FF" size="3"><u>Leuk</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Endo.html"></font><font face="Arial" color="#0000FF" size="3"><u>Endo</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> examples.<br></font><font face="Arial" color="#000100" size="2"><br><a id="NestedIndexingAndMixtures"></font><font face="Arial" color="#000100" size="5"><strong>Nested indexing and mixtures</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Nested indexing can be very effective. For example, suppose </font><font face="Arial" color="#000100" size="3"><em>N</em></font><font face="Arial" color="#000100" size="3"> individuals can each be in one of </font><font face="Arial" color="#000100" size="3"><em>I</em></font><font face="Arial" color="#000100" size="3"> groups, and </font><font face="Arial" color="#000100" size="3"><em>g[1:N] </em></font><font face="Arial" color="#000100" size="3">is a vector which contains the group membership. Then &quot;group&quot; coefficients </font><font face="Arial" color="#000100" size="3"><em>beta[i]</em></font><font face="Arial" color="#000100" size="3"> can be fitted using </font><font face="Arial" color="#000100" size="3"><em>beta[g[j]]</em></font><font face="Arial" color="#000100" size="3"> in a regression equation.<br><br>In the </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language, nested indexing can be used for the parameters of distributions: for example, the </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Eyes.html"></font><font face="Arial" color="#0000FF" size="3"><u>Eyes</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> example concerns a normal mixture in which the </font><font face="Arial" color="#000100" size="3"><em>i </em></font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> case is in an unknown group </font><font face="Arial" color="#000100" size="3"><em>T</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> which determines the mean </font><font face="Arial" color="#000100" size="3"><em>l</em></font><font face="Arial" color="#000100" size="3"><em><sub>T</sub></em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> of the measurement </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3">. Hence the model is<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> ~ Categorical(</font><font face="Arial" color="#000100" size="3"><em>P</em></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Arial" color="#000100" size="3"><em>l</em></font><font face="Arial" color="#000100" size="3"><em><sub>T</sub></em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> , </font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> )<br><br>which may be written in the BUGS language as<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[i] ~ dcat(P[])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(lambda[T[i]], tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>However, when using Doodles the parameters of a distribution must be a node in the graph, and so an additional stage is needed to specify the mean </font><font face="Arial" color="#000100" size="3"><em>m</em></font><font face="Arial" color="#000100" size="3"><em><sub> i</sub></em></font><font face="Arial" color="#000100" size="3"> = </font><font face="Arial" color="#000100" size="3"><em>l</em></font><font face="Arial" color="#000100" size="3"><em><sub>T</sub></em></font><font face="Arial" color="#000100" size="3"><em><sub>i </sub></em></font><font face="Arial" color="#000100" size="3">, as shown in the graph below. (We emphasise the care required in establishing convergence of these notorious models.)<br><br></font><font face="Arial" color="#000100" size="2"><img src="model specification4.bmp" alt="[model specification4]"><br></font><font face="Arial" color="#000100" size="3">Vector parameters can also be identified dynamically, but currently only to a maximum of two dimensions. For example, if we wanted a two-state categorical variable x to have a vector of probabilities indexed by i and j, then we could write x ~ dcat(p[i, j, 1:2]). However, suppose we require three-level indexing, for example<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a ~ dcat(p.a[1:2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b ~ dcat(p.b[1:2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c ~ dcat(p.c[1:2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d ~ dcat(p.d[a, b, c, 1:2]<br><br>WinBUGS will not permit this, and so the index must be explicitly calculated:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d ~ dcat(p[k, 1:2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k &lt;- 8 * (a - 1) + 4 * (b - 1) + c<br><br>This 'calculated index' trick is useful in many circumstances.<br></font><font face="Arial" color="#000100" size="2"><br><a id="FormattingOfData"></font><font face="Arial" color="#000100" size="5"><strong>Formatting of data</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Data can be S-Plus format (see most of the </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volumeii.html"></font><font face="Arial" color="#0000FF" size="3"><u>examples</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">) or, for data in arrays, in rectangular format.<br><br>The whole array must be specified in the file - it is not possible just to specify selected components.<br><br>Missing values are represented as NA.<br><br>All variables in a data file must be defined in a model, even if just left unattached to the rest of the model. In Doodles such variables can be left as constants: in a model description they can be assigned vague priors or allocated to dummy variables.<br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="FormattingOfDataSPlusFormat">S-Plus format:</a></strong></font><font face="Arial" color="#000100" size="3"> This allows scalars and arrays to be named and given values in a single structure headed by key-word list. There must be no space after list.<br><br>For example, in the </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>Rats</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> example, we need to specify a scalar </font><font face="Arial" color="#000100" size="3"><em>xbar</em></font><font face="Arial" color="#000100" size="3">, dimensions </font><font face="Arial" color="#000100" size="3"><em>N</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>T</em></font><font face="Arial" color="#000100" size="3">, a vector </font><font face="Arial" color="#000100" size="3"><em>x</em></font><font face="Arial" color="#000100" size="3"> and a two-dimensional array </font><font face="Arial" color="#000100" size="3"><em>Y</em></font><font face="Arial" color="#000100" size="3"> with 30 rows and 5 columns. This is achieved using the following format:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbar = 22, N = 30, T = 5,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = c(8.0, 15.0, 22.0, 29.0, 36.0),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y = structure(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Data = c(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;151, 199, 246, 283, 320,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;145, 199, 249, 293, 354,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...................<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...................<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;137, 180, 219, 258, 291,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;153, 200, 244, 286, 324),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Dim = c(30, 5)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br><br>See the </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>examples</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for other use of this format.<br><br></font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> reads data into an array by filling the right-most index first, whereas the S-Plus program fills the left-most index first. Hence </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> reads the string of numbers c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) into a 2 * 5 dimensional matrix in the order&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;[i, j]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10<br><br>whereas S-Plus reads the same string of numbers in the order<br><br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;[i, j]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10<br><br>Hence the ordering of the array dimensions must be reversed before using the S-Plus dput command to create a data file for input into </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3">.<br><br>For example, consider the 2 * 5 dimensional matrix<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;10<br><br>This must be stored in S-Plus as a 5 * 2 dimensional matrix:<br><br>&gt; M<br>[,1] [,2]<br>[1,] 1 6<br>[2,] 2 7<br>[3,] 3 8<br>[4,] 4 9<br>[5,] 5 10<br><br>The S-Plus command<br><br>&gt; dput(list(M=M), file=&quot;matrix.dat&quot;)<br><br>will then produce the following data file<br><br>list(M = structure(.Data = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10), .Dim=c(5,2))<br><br>Edit the .Dim statement in this file from .Dim=c(5,2) to .Dim=c(2,5). The file is now in the correct format to input the required 2 * 5 dimensional matrix into </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3">.<br><br>Now consider a 3 * 2 * 4 dimensional array<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;12<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;16<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;20<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;24<br><br></font><font face="Arial" color="#000000" size="3">This must be stored in S-Plus as the 4 * 2 * 3 dimensional array:<br><br>&gt; A<br>, , 1<br>[,1] [,2]<br>[1,] 1 5<br>[2,] 2 6<br>[3,] 3 7<br>[4,] 4 8<br><br>, , 2<br>[,1] [,2]<br>[1,] 9 13<br>[2,] 10 14<br>[3,] 11 15<br>[4,] 12 16<br><br>, , 3<br>[,1] [,2]<br>[1,] 17 21<br>[2,] 18 22<br>[3,] 19 23<br>[4,] 20 24<br><br>The command<br></font><font face="Arial" color="#000100" size="3"><br>&gt; dput(list(A=A), file=&quot;array.dat&quot;)<br><br>will then produce the following data file<br><br>list(A = structure(.Data = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1</font><font face="Arial" color="#000000" size="3">6, 17, 18, 19, 20, 21, 22, 23, 24), .Dim=c(4,2,3))</font><font face="Arial" color="#000100" size="3"><br><br>Edit the .Dim </font><font face="Arial" color="#000000" size="3">statement in this file from .Dim=c(4,2,3) to .Dim=c(3,2,4). The file is now in the correct format to input the required 3 * 2 * 4 dimensional array into </font><font face="Arial" color="#000000" size="3"><em>WinBUGS </em></font><font face="Arial" color="#000000" size="3">in the order</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[i, j, k]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 2, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3, 2, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3, 2, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="FormattingOfDataRectangularFormat">Rectangular format:</a> </strong></font><font face="Arial" color="#000100" size="3">The columns for data in rectangular format need to be headed by the array name. The arrays need to be of equal size, and the array names must have explicit brackets: for example:<br><br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;age[]&nbsp;&nbsp;&nbsp;sex[]<br>&nbsp;&nbsp;&nbsp;26&nbsp;&nbsp;&nbsp;0<br>&nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;.....<br>&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;&nbsp;0<br>END<br><br><a id="FormattingOfDataENDCommand"></font><font face="Arial" color="#000000" size="3"><strong>Note that the file must end with an 'END' keyword, as shown above and below, and this must be followed by at least one blank line.</strong></font><font face="Arial" color="#000000" size="3"></a><br><br></font><font face="Arial" color="#000100" size="3">Multi-dimensional arrays can be specified by explicit indexing: for example, the </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>Ratsy</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> file begins<br><br>&nbsp;&nbsp;&nbsp;Y[,1]&nbsp;&nbsp;&nbsp;Y[,2]&nbsp;&nbsp;&nbsp;Y[,3]&nbsp;&nbsp;&nbsp;Y[,4]&nbsp;&nbsp;&nbsp;Y[,5]<br>&nbsp;&nbsp;&nbsp;151&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;246&nbsp;&nbsp;&nbsp;283&nbsp;&nbsp;&nbsp;320<br>&nbsp;&nbsp;&nbsp;145&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;249&nbsp;&nbsp;&nbsp;293&nbsp;&nbsp;&nbsp;354<br>&nbsp;&nbsp;&nbsp;147&nbsp;&nbsp;&nbsp;214&nbsp;&nbsp;&nbsp;263&nbsp;&nbsp;&nbsp;312&nbsp;&nbsp;&nbsp;328<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.......<br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;153&nbsp;&nbsp;&nbsp;200&nbsp;&nbsp;&nbsp;244&nbsp;&nbsp;&nbsp;286&nbsp;&nbsp;&nbsp;324<br>END<br><br>The first index position for any array must always be empty.<br></font><font face="Arial" color="#000100" size="3"><br>It is possible to load a mixture of rectangular and S-Plus format data files for the same model. For example, if data arrays are provided in a rectangular file, constants can be defined in a separate list statement (see also the </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>Rats</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> example with data files </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>Ratsx</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#0000FF" size="3"><a href=""></font><font face="Arial" color="#0000FF" size="3"><u>Ratsy</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">).<br><br>(See </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#HandlingUnbalancedDatasets"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for details of how to handle unbalanced data.)<br><br>Note that programs exist for conversion of data from other packages: please see the BUGS resources web-page at <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.mrc-bsu.cam.ac.uk/bugs/weblinks/webresource.shtml<br><br></font></p></body></html>
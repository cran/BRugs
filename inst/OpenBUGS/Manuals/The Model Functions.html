<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>The Model Functions</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="the model functions0.bmp" alt="[the model functions0]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;The R Model Functions</strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="Contents"></font><font face="Arial" color="#000100" size="5"><strong>Contents</strong></font><font face="Arial" color="#000100" size="2"></a><br></font><font face="Arial" color="#000100" size="4"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#GeneralProperties"></font><font face="Arial" color="#0000FF" size="4"><u>General&nbsp;properties</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#Specification"></font><font face="Arial" color="#0000FF" size="4"><u>Model&nbsp;Specification</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#Update"></font><font face="Arial" color="#0000FF" size="4"><u>Model&nbsp;Updating</u></font><font face="Arial" color="#0000FF" size="4"></a><br>&nbsp;&nbsp;&nbsp;<a href="#RandomNumber"></font><font face="Arial" color="#0000FF" size="4"><u>Random&nbsp;Number&nbsp;Generator</u></font><font face="Arial" color="#0000FF" size="4"></a></font><font face="Arial" color="#000100" size="4"><br></font><font face="Arial" color="#0000FF" size="4">&nbsp;&nbsp;&nbsp;<a href="#Options"></font><font face="Arial" color="#0000FF" size="4"><u>Options</u></font><font face="Arial" color="#0000FF" size="4"></a><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="4"><br></font><font face="Arial" color="#000100" size="2"><br><a id="GeneralProperties"></font><font face="Arial" color="#000100" size="5"><strong>General properties</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The R functions in this group apply to the whole statistical model. All the functions in this group have names starting with </font><font face="Arial" color="#000100" size="3"><em>model</em></font><font face="Arial" color="#000100" size="3">. If an attempt is made to execute one of these model functions in an inappropiate context the generic error message 'command&nbsp;is&nbsp;not&nbsp;allowed&nbsp;(greyed&nbsp;out)' is displayed. If a function with a file argument displays this error message check that the file exists.<br></font><font face="Arial" color="#000100" size="2"><br><a id="Specification"></font><font face="Arial" color="#000100" size="5"><strong>Model Specification</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.check:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.check(fileName)</em></font><font face="Arial" color="#000100" size="3"> function parses the </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language description of the statistical model contained in the file of name </font><font face="Arial" color="#000100" size="3"><em>fileName</em></font><font face="Arial" color="#000100" size="3">. If a syntax error is detected the position of the error and a description of the error is </font><font face="Arial" color="#000000" size="3">printed., otherwise the 'model&nbsp;is&nbsp;syntaxicaly&nbsp;correct' message is displayed.</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.data: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.data(fileName)</em></font><font face="Arial" color="#000100" size="3"> function loads data contained in the file of name </font><font face="Arial" color="#000100" size="3"><em>fileName</em></font><font face="Arial" color="#000100" size="3"> into the statsistical model.<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Model Specification.html#FormattingOfData"></font><font face="Arial" color="#0000FF" size="3"><u>See&nbsp;here&nbsp;for&nbsp;details&nbsp;of&nbsp;data&nbsp;formats</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>If any syntax errors or data inconsistencies are detected an error message is displayed. Corrections can be made to the data without returning to the</font><font face="Arial" color="#000100" size="3"><em> check model</em></font><font face="Arial" color="#000100" size="3"> stage. When the data have been loaded successfully the , 'data loaded' message should appear.<br><br>The </font><font face="Arial" color="#000100" size="3"><em>load.data</em></font><font face="Arial" color="#000100" size="3"> function can be executed once a model has been successfully checked, it can no longer be executed once the model has been successfully compiled.<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.compile: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.compile(numChains = 1)</em></font><font face="Arial" color="#000100" size="3"> function builds the data structures needed to carry out MCMC sampling. The model is checked for completeness and consistency with the data. Simulation is carried out for </font><font face="Arial" color="#000100" size="3"><em>numChains</em></font><font face="Arial" color="#000100" size="3"> chains. By default </font><font face="Arial" color="#000100" size="3"><em>numChains</em></font><font face="Arial" color="#000100" size="3"> is one.<br><br>A node called 'deviance' is automatically created which calculates minus twice the log-likelihood at each iteration, up to a constant. This node can be used like any other node in the graphical model.<br><br>This command becomes active once the model has been successfully checked, and when the model has been successfully compiled, 'model compiled' mesage should be printed.<br><br></font><font face="Arial" color="#000000" size="3"><strong>model.num.chains:</strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.num.chains()</em></font><font face="Arial" color="#000100" size="3"> function returns the number of chains being simulated</font><font face="Arial" color="#804000" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.inits: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.inits(fileName, chainNum)</em></font><font face="Arial" color="#000100" size="3"> function loads initial values for the MCMC simulation contained in the file of name </font><font face="Arial" color="#000100" size="3"><em>fileName</em></font><font face="Arial" color="#000100" size="3">. The initial values will be loaded for the chain number </font><font face="Arial" color="#000100" size="3"><em>chainNum</em></font><font face="Arial" color="#000100" size="3">. By default chainNum is one the first time model.inits is executed and increamented by one after each call modula the number of chains </font><font face="Arial" color="#000100" size="3"><em>numChains</em></font><font face="Arial" color="#000100" size="3"> being simulated.<br><br>This function can be executed once the model has been successfully compiled, and checks that initial values are in the form of an S-Plus object or rectangular array and that they are consistent with any previously loaded data. Any syntax errors or inconsistencies in the initial value are displayed. If some of the elements in an array are known (say because they are constraints in a parameterisation), those elements should be specified as missing (NA) in the initial values file.<br><br>If, after loading the initial values, the model is fully initialized this will be reported by displaying the message </font><font face="Arial" color="#000100" size="3"><em>'initial values loaded: model initialized'</em></font><font face="Arial" color="#000100" size="3">. Otherwise the message </font><font face="Arial" color="#000100" size="3"><em>'initial&nbsp;values&nbsp;loaded:&nbsp;model&nbsp;contains&nbsp;uninitialized&nbsp;nodes' </em></font><font face="Arial" color="#000100" size="3">will be displayed. The second message can have several meanings:<br><br>a) If only one chain is simulated it means that the chain contains some nodes that have not been initialized yet.<br>b) If several chains are to be simulated it could mean that no initial values have been loaded for one of the chains.<br><br>In either case further initial values can be loaded, or the </font><font face="Arial" color="#000100" size="3"><em>model.gen.inits</em></font><font face="Arial" color="#000100" size="3"> function can be executed to try and generate initial values for </font><font face="Arial" color="#000100" size="3"><em>all</em></font><font face="Arial" color="#000100" size="3"> the uninitialized nodes in </font><font face="Arial" color="#000100" size="3"><em>all</em></font><font face="Arial" color="#000100" size="3"> the simulated chains.<br><br>Generally it is recommended to load initial values for all fixed effect nodes (founder nodes with no parents) for all chains, initial values for random effects can be generated using the </font><font face="Arial" color="#000100" size="3"><em>model.gen.inits </em></font><font face="Arial" color="#000100" size="3">function.<br><br>This </font><font face="Arial" color="#000100" size="3"><em>load.inits</em></font><font face="Arial" color="#000100" size="3"> button can still be executed once MCMC sampling has been started. It will have the effect of starting the sampler out on a new trajectory. <br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.gen.inits: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.gen.inits</em></font><font face="Arial" color="#000100" size="3"> function attempts to generate initial values by sampling either from the prior or from an approximation to the prior. In the case of discrete variables a check is made that a configuration of zero probability is not generated. This function will generate extreme values if any of the priors are very vague. If the function is successful the message 'initial&nbsp;values&nbsp;generated:&nbsp;model&nbsp;initialized' is displayed otherwise the message </font><font face="Arial" color="#000000" size="3">'could&nbsp;not&nbsp;generate&nbsp;initial&nbsp;values' is displayed.</font><font face="Arial" color="#000100" size="3"><br><br>The </font><font face="Arial" color="#000100" size="3"><em>model.gen.inits</em></font><font face="Arial" color="#000100" size="3"> function can be executed once the model has been successfully compiled, and can no longer be executed once the model has been initialized.<br><br><a id="Update"></font><font face="Arial" color="#000100" size="5"><strong>Model Updating</strong></font><font face="Arial" color="#000100" size="3"></a> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a></font><font face="Arial" color="#000100" size="3"><br><br>These functions can be executed once the model has been compiled and initialized.<br></font><font face="Arial" color="#000100" size="3"><em><br></em></font><font face="Arial" color="#000000" size="3"><strong><em>model.update:</em></strong></font><font face="Arial" color="#000000" size="3"> The </font><font face="Arial" color="#000000" size="3"><em>model.update(numUpdates, thin = 1, overRelax = FALSE)</em></font><font face="Arial" color="#000000" size="3"> function updates the model by carrying out thin&nbsp;*&nbsp;numUpdates MCMC iterations for each chain. The </font><font face="Arial" color="#000100" size="3">samples from every </font><font face="Arial" color="#000100" size="3"><em>k</em></font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> iteration will be used for inference, where </font><font face="Arial" color="#000100" size="3"><em>k</em></font><font face="Arial" color="#000100" size="3"> is the value of </font><font face="Arial" color="#000100" size="3"><em>thin</em></font><font face="Arial" color="#000100" size="3">. Setting </font><font face="Arial" color="#000100" size="3"><em>thin </em></font><font face="Arial" color="#000100" size="3">&gt; 1 can help to reduce the autocorrelation in the sample, but there is no real advantage in thinning except to reduce storage requirements. If </font><font face="Arial" color="#000100" size="3"><em>overRelax</em></font><font face="Arial" color="#000100" size="3"> is true an over-relaxed form of MCMC (Neal, 1998) which will be executed where possible. This generates multiple samples at each iteration and then selects one that is negatively correlated with the current value. The time per iteration will be increased, but the within-chain correlations should be reduced and hence fewer iterations may be necessary. However, this method is not always effective and should be used with caution. The auto-correlation function may be used to check whether the mixing of the chain is improved.</font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000000" size="3"><strong><em>model.iteration:</em></strong></font><font face="Arial" color="#000000" size="3"> The </font><font face="Arial" color="#000000" size="3"><em>model.iteration()</em></font><font face="Arial" color="#000000" size="3"> function returns the total number of iterations carried out divided by thin.<br><br></font><font face="Arial" color="#000000" size="3"><strong><em>model.updates:</em></strong></font><font face="Arial" color="#000000" size="3"> The </font><font face="Arial" color="#000000" size="3"><em>model.updates()</em></font><font face="Arial" color="#000000" size="3"> function returns the number of MCMC iterations the last update function has carried out divided by thin.<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.adapting:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.adapting()</em></font><font face="Arial" color="#000100" size="3"> function returns true while the Metropolis or slice-sampling MCMC algorithm is in its initial tuning phase where some optimization parameters are tuned. All statistics for the model will ignore </font><font face="Arial" color="#000000" size="3">information from this adapting phase. The Metropolis and slice-sampling algorithms have adaptive phases of 4000 and 500 iterations respectively which will be discarded from all statistics. For details of how to change these default settings please see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/The Options Menu.html#UpdateOptions"></font><font face="Arial" color="#0000FF" size="3"><u>Update&nbsp;options...</u></font><font face="Arial" color="#0000FF" size="3"></a><br><br></font><font face="Arial" color="#000000" size="3"><strong><em>model.adaptivePhase:</em></strong></font><font face="Arial" color="#000000" size="3"> The </font><font face="Arial" color="#000000" size="3"><em>model.adaptivePhase()</em></font><font face="Arial" color="#000000" size="3"> returns the length of the adaptive phase of the simulation. This is only known after the simulation has finished adapting. If this function is called while the simulation is still adapting MAX(INTEGER) is returned. If the simulation does not have an adaptive phase then zero is returned.<br><br></font><font face="Arial" color="#000100" size="3"><a id="RandomNumber"></font><font face="Arial" color="#000100" size="5"><strong>Random Number Generator</strong></font><font face="Arial" color="#000100" size="3"></a> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a><br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.set.seed: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.set.seed(seed)</em></font><font face="Arial" color="#000100" size="3"> function sets the seed of the random number generator to seed (seed must be a posative, non zero integer).</font><font face="Arial" color="#008040" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.get.seed: </em></strong></font><font face="Arial" color="#000100" size="3">The </font><font face="Arial" color="#000100" size="3"><em>model.get.seed(seed)</em></font><font face="Arial" color="#000100" size="3"> function returns the seed of the random number generator.<br><br><a id="Options"></font><font face="Arial" color="#000100" size="5"><strong>Options</strong></font><font face="Arial" color="#000100" size="3"></a> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a><br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.precision:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.precision(prec)</em></font><font face="Arial" color="#000100" size="3"> sets the precision to which results are displayed to </font><font face="Arial" color="#000100" size="3"><em>prec</em></font><font face="Arial" color="#000100" size="3"> figures. It does not affect the precision of any calculations.<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">Once a model has been compiled, the various updating algorithms required in order to perform the MCMC simulation may be 'tuned' somewhat via these three functions. The first argument of each function is a string defining which particular MCMC updating algorithm is to be tuned. Technically this string is the type name of the factory object used to create the updater, for example 'UpdaterMetnormal.Factory' for the random walk metropolis sampler. The second argument of the functions is an integer giving the new value of some internal parameter.<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>model.setAP:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.setAP(factoryName, adaptivePhase)</em></font><font face="Arial" color="#000100" size="3"> function changes the length of the updaters adaptive phase to </font><font face="Arial" color="#000100" size="3"><em>adaptivePhase</em></font><font face="Arial" color="#000100" size="3"> if appropiate.</font><font face="Arial" color="#804000" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3"><strong><em>model.setIts:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.setIts(factoryName, iterations)</em></font><font face="Arial" color="#000100" size="3"> function changes the number of times an iterative algorithm is run before a failure is reported to </font><font face="Arial" color="#000100" size="3"><em>iterations</em></font><font face="Arial" color="#000100" size="3"> if appropiate.</font><font face="Arial" color="#804000" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3"><strong><em>model.setOR:</em></strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><em>model.setOR(factoryName, overRelaxation)</em></font><font face="Arial" color="#000100" size="3"> function sets the amount of over relaxation the updater uses to </font><font face="Arial" color="#000100" size="3"><em>overRelaxation</em></font><font face="Arial" color="#000100" size="3"> if appropiate.</font></p></body></html>
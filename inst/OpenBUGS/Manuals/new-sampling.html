<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>new-sampling</title></head><body><p><font face="Arial" color="#000000" size="5"><strong><img src="new-sampling0.bmp" alt="[new-sampling0]">&nbsp;&nbsp;&nbsp;New-sampling: specifying a new sampling distribution<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(illustrated with normal)<br></strong></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000000" size="3">This example includes a demonstration of how future observations can also be modelled.<br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3">model {<br>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trick using zeros<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">zeros[i] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">zeros[i] ~ dpois(phi[i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likelihood is exp(</font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3">phi[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# </font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3">log(likelihood)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">phi[i] &lt;- log(sigma[1]) + 0.5 * pow((x[i] </font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3"> mu[1]) / sigma[1], 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check using normal distribution<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;x[i] ~ dnorm(mu[2], prec)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">prec &lt;- 1 / (sigma[2] * sigma[2])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (k in 1:2) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[k] ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma[k] ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Data:<br></strong></font><font face="Arial" color="#000100" size="3">list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7))<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Initial values:<br></strong></font><font face="Arial" color="#000000" size="3">list(sigma = c(1, 1), mu = c(0, 0))<br><br>The results show a close match between the standard method and the zeros trick:<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;mu[1]&nbsp;&nbsp;&nbsp;0.3661&nbsp;&nbsp;&nbsp;0.4893&nbsp;&nbsp;&nbsp;0.00715&nbsp;&nbsp;&nbsp;-0.6296&nbsp;&nbsp;&nbsp;0.364&nbsp;&nbsp;&nbsp;1.336&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;mu[2]&nbsp;&nbsp;&nbsp;0.3668&nbsp;&nbsp;&nbsp;0.4734&nbsp;&nbsp;&nbsp;0.007003&nbsp;&nbsp;&nbsp;-0.5591&nbsp;&nbsp;&nbsp;0.3677&nbsp;&nbsp;&nbsp;1.291&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;1.191&nbsp;&nbsp;&nbsp;0.4902&nbsp;&nbsp;&nbsp;0.01456&nbsp;&nbsp;&nbsp;0.6293&nbsp;&nbsp;&nbsp;1.075&nbsp;&nbsp;&nbsp;2.476&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;1.168&nbsp;&nbsp;&nbsp;0.461&nbsp;&nbsp;&nbsp;0.009039&nbsp;&nbsp;&nbsp;0.6265&nbsp;&nbsp;&nbsp;1.062&nbsp;&nbsp;&nbsp;2.311&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br><br></font><font face="Arial" color="#000000" size="5"><strong>Modelling future observations or missing data - add a missing data point to the data-file<br></strong></font><font face="Arial" color="#000000" size="3"></font><font face="Arial" color="#FF0000" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3">model {<br>&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trick using zeros<br>&nbsp;&nbsp;&nbsp;for (i in 1:8) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] &lt;- 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] ~ dpois(phi[i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likelihood is exp(</font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3">phi[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# </font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3">log(likelihood)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i] &lt;- log(sigma[1]) + 0.5 * pow((x[i] </font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3"> mu[1]) / sigma[1], 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i] ~ dflat()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# improper uniform prior on x's<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check using normal distribution<br>&nbsp;&nbsp;&nbsp;for (i in 1:8) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.rep[i] ~ dnorm(mu[2], prec)<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;prec &lt;- 1 / (sigma[2] * sigma[2])<br>&nbsp;&nbsp;&nbsp;for (k in 1:2) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[k] ~ dunif(-10, 10)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma[k] ~ dunif(0, 10)<br>&nbsp;&nbsp;&nbsp;}<br>}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Data:<br></strong></font><font face="Arial" color="#000100" size="3">list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7, NA), x.rep=c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7, NA))<br>(Note that in this case we need to replicate the dataset in order to compare results.)<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Initial values:<br></strong></font><font face="Arial" color="#000000" size="3">list(sigma = c(1, 1), mu = c(0, 0), x = c(NA, NA, NA, NA, NA, NA, NA, 0))<br>(We need to give an initial value to the missing data, otherwise WinBUGS will try to generate one from the improper prior and crash!)<br><br>The agreement is fine but the MC error on the prediction is large and so a long run is necessary:</font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="1">mu[1]&nbsp;&nbsp;&nbsp;0.3689&nbsp;&nbsp;&nbsp;0.4948&nbsp;&nbsp;&nbsp;0.003145&nbsp;&nbsp;&nbsp;-0.6157&nbsp;&nbsp;&nbsp;0.3714&nbsp;&nbsp;&nbsp;1.351&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;mu[2]&nbsp;&nbsp;&nbsp;0.368&nbsp;&nbsp;&nbsp;0.486&nbsp;&nbsp;&nbsp;0.002319&nbsp;&nbsp;&nbsp;-0.6091&nbsp;&nbsp;&nbsp;0.3713&nbsp;&nbsp;&nbsp;1.326&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;1.194&nbsp;&nbsp;&nbsp;0.5066&nbsp;&nbsp;&nbsp;0.005429&nbsp;&nbsp;&nbsp;0.6222&nbsp;&nbsp;&nbsp;1.075&nbsp;&nbsp;&nbsp;2.46&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;1.187&nbsp;&nbsp;&nbsp;0.4989&nbsp;&nbsp;&nbsp;0.003917&nbsp;&nbsp;&nbsp;0.6224&nbsp;&nbsp;&nbsp;1.069&nbsp;&nbsp;&nbsp;2.45&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;x[8]&nbsp;&nbsp;&nbsp;0.357&nbsp;&nbsp;&nbsp;1.407&nbsp;&nbsp;&nbsp;0.01511&nbsp;&nbsp;&nbsp;-2.494&nbsp;&nbsp;&nbsp;0.3608&nbsp;&nbsp;&nbsp;3.133&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;x.rep[8]&nbsp;&nbsp;&nbsp;0.3585&nbsp;&nbsp;&nbsp;1.381&nbsp;&nbsp;&nbsp;0.006126&nbsp;&nbsp;&nbsp;-2.372&nbsp;&nbsp;&nbsp;0.3584&nbsp;&nbsp;&nbsp;3.105&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p></body></html>
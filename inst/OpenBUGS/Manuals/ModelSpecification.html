<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>ModelSpecification</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="modelspecification0.bmp" alt="[modelspecification0]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">The BUGS Model Specification<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Language</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"> </font><font face="Arial" color="#000100" size="2"><br><a id="Contents"></font><font face="Courier New" color="#000100" size="5">Contents</font><font face="Arial" color="#000100" size="2"></a><br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<a href="#GraphicalModels">Graphical&nbsp;models</a><br>&nbsp;&nbsp;&nbsp;<a href="#GraphsAsAFormalLanguage">Graphs&nbsp;as&nbsp;a&nbsp;formal&nbsp;language</a><br>&nbsp;&nbsp;&nbsp;<a href="#TheBUGSLanguageStochasticNodes">Stochastic&nbsp;nodes</a><br>&nbsp;&nbsp;&nbsp;<a href="#LogicalNodes">Logical&nbsp;nodes</a><br>&nbsp;&nbsp;&nbsp;<a href="#ArraysAndIndexing">Arrays&nbsp;and&nbsp;indexing</a><br>&nbsp;&nbsp;&nbsp;<a href="#RepeatedStructures">Repeated&nbsp;structures</a><br>&nbsp;&nbsp;&nbsp;<a href="#DataTransformations">Data&nbsp;transformations</a><br>&nbsp;&nbsp;&nbsp;<a href="#NestedIndexingAndMixtures">Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</a><br>&nbsp;&nbsp;&nbsp;<a href="#FormattingOfData">Formatting&nbsp;of&nbsp;data</a><br>&nbsp;&nbsp;&nbsp;<a href="#ContentsAI">Appendix&nbsp;I&nbsp;Distributions</a><br>&nbsp;&nbsp;&nbsp;<a href="#ContentsAII">Appendix&nbsp;II&nbsp;Functions&nbsp;and&nbsp;Functionals</a><br></font><font face="Arial" color="#0000FF" size="4">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br><a id="GraphicalModels"></font><font face="Courier New" color="#000100" size="5">Graphical models</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">We strongly recommend that the first step in any analysis should be the construction of a </font><font face="Arial" color="#000100" size="3"><em>directed graphical model</em></font><font face="Arial" color="#000100" size="3">. Briefly, this represents all quantities as nodes in a directed graph, in which arrows run to nodes from their direct influences (parents). The model represents the assumption that, given its parent nodes pa[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">], each node </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3"> is independent of all other nodes in the graph except descendants of </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">, where descendant has the obvious definition.<br><br>Nodes in the graph are of three types.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">1. </font><font face="Arial" color="#000100" size="3"><em>Constants</em></font><font face="Arial" color="#000100" size="3"> are fixed by the design of the study: they are always founder nodes (</font><font face="Arial" color="#000100" size="3"><em>i.e.</em></font><font face="Arial" color="#000100" size="3"> do not have parents), and are denoted as rectangles in the graph. <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">2. </font><font face="Arial" color="#000100" size="3"><em>Stochastic node</em></font><font face="Arial" color="#000100" size="3">s are variables that are given a distribution, and are denoted as ellipses in the graph; they may be parents or children (or both). Stochastic nodes may be observed in which case they are </font><font face="Arial" color="#000100" size="3"><em>data</em></font><font face="Arial" color="#000100" size="3">, or may be unobserved and hence be </font><font face="Arial" color="#000100" size="3"><em>parameters</em></font><font face="Arial" color="#000100" size="3">, which may be unknown quantities underlying a model, observations on an individual case that are unobserved say due to censoring, or simply missing data.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">3. </font><font face="Arial" color="#000100" size="3"><em>Deterministic nodes</em></font><font face="Arial" color="#000100" size="3"> are logical functions of other nodes.<br><br>Quantities are specified to be data by giving them values in a data declaration, in which values for constants are also given.<br><br>Directed links may be of two types: a thin solid arrow indicates a stochastic dependence while a thick hollow arrow indicates a logical function. An undirected dashed link may also be drawn to represent an upper or lower bound for a stochastic node.<br><br>Repeated parts of the graph can be represented using a 'plate', as shown below for the range</font><font face="Arial" color="#000100" size="3"><em> <br>(i in 1:N)</em></font><font face="Arial" color="#000100" size="3">.<br><center></font><font face="Arial" color="#000100" size="2"><br><img src="modelspecification1.bmp" alt="[modelspecification1]"><br><br></font><font face="Arial" color="#000100" size="3"><br>A simple graphical model, where Y[i] depends on mu[i] and tau, with mu[i]<br>being a logical function of alpha and beta.<br><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="3"><br>The conditional independence assumptions represented by the graph mean that the full joint distribution of all quantities </font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="3"> has a simple factorisation in terms of the conditional distribution p(</font><font face="Arial" color="#000100" size="3"><em>v </em></font><font face="Arial" color="#000100" size="3">| parents[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">]) of each node given its parents, so that</font><font face="Arial" color="#000100" size="2"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">p(</font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="6"><sub>P</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">p(</font><font face="Arial" color="#000100" size="3"><em>v </em></font><font face="Arial" color="#000100" size="3">| parents[</font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3">])&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v</em></font><font face="Arial" color="#000100" size="3"> in </font><font face="Arial" color="#000100" size="3"><em>V</em></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">The crucial idea is that we need only provide the parent-child distributions in order to fully specify the model, and </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS </em></font><font face="Arial" color="#000100" size="3">then sorts out the necessary sampling methods directly from the expressed graphical structure.<br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="5"><a id="GraphsAsAFormalLanguage">Graphs as a formal language</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">A special drawing tool </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/DoodleBUGS.html">DoodleBUGS</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> has been developed for specifying graphical models, which uses a hyper-diagram approach to add extra information to the graph to give a complete model specification. Each stochastic and logical node in the graph must be given a name using the conventions explained in </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/DoodleBUGS.html#CreatingANode">Creating&nbsp;a&nbsp;node</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">.<br><br><center></font><font face="Arial" color="#000100" size="2"><br>.<img src="modelspecification2.bmp" alt="[modelspecification2]"><br><br></center></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">The shaded node Y[i] is normally distributed with mean mu[i] and<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision tau.</font><font face="Arial" color="#000100" size="1"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><center></font><font face="Arial" color="#000100" size="2"><br><img src="modelspecification3.bmp" alt="[modelspecification3]"></font><font face="Arial" color="#000100" size="1"><br></center></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">The shaded node mu[i] is a logical function of alpha, beta, and the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants x. (x is not required to be shown in the graph).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The value function of a logical node contains all the necessary information to define the logical node.<br>&nbsp;&nbsp;&nbsp;<br>As an alternative to the Doodle representation, the model can be specified using the text-based </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language, headed by the model statement:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;text-based description of graph in BUGS language</em></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><a id="TheBUGSLanguageStochasticNodes"></font><font face="Courier New" color="#000100" size="5">The BUGS language: stochastic nodes</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">In the text-based model description, stochastic nodes are represented by the node name followed by a tilda symbol followed by the distribution name followed by a comma-separated list of parents enclosed in brackets </font><font face="Arial" color="#000100" size="3"><em>e.g.<br><br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x ~ dnorm(mu, tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The distributions that can be used in </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS </em></font><font face="Arial" color="#000100" size="3">are described in </font><font face="Courier New" color="#0000FF" size="3"><a href="#ContentsAI">Appendix&nbsp;I&nbsp;Distributions</a></font><font face="Arial" color="#000100" size="3">. The parameters of a distribution must be explicit nodes in the graph (scalar parameters can also be numerical constants) and so may not be expressions.<br><br></font><font face="Arial" color="#000100" size="2"><a id="ConstraintsOnUsingCertainDistributions"></font><font face="Arial" color="#000100" size="3">Multivariate nodes must form contiguous elements in an array. Since the final element in an array changes fastest, such nodes must be defined as the final part of any array. For example, to define a set containing I multivariate normal variables of dimensional K as a single multidimensional array x[i, j], we could write:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : I) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i, 1 : K] ~ dmnorm(mu[], tau[ , ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000000" size="3">Data defined by a multivariate distribution must not contain missing (unobserved) values. The only exception to this rule is the multivariate normal distribution. We realise this is an unfortunate restriction and we hope to relax it in the future. For multinomial data, it may be possible to get round this problem by re-expressing the multivariate likelihood as a sequence of conditional univariate binomial distributions or as Poisson distributions. <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Censoring is denoted using the notation C(lower, upper) </font><font face="Arial" color="#000100" size="3"><em>e.g.</em></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x ~ dnorm(mu, tau)C(lower, upper)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>would denote a quantity x from the normal distribution with parameters mu, tau, which had been observed to lie between lower and upper. Leaving either lower or upper blank corresponds to no limit, e.g. C(lower,) corresponds to an observation known to lie above lower. Whenever censoring is specified the censored node contributes a term to the full conditional distribution of its parents. This structure is only of use if x has not been observed (if x is observed then the constraints will be ignored). </font><font face="Arial" color="#000000" size="3">In general multivariate nodes can not be censored, the multivariate normal distribution is exempted from this restriction.</font><font face="Arial" color="#FF00FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>Truncation is denoted by using the notation T(lower, upper) </font><font face="Arial" color="#000100" size="3"><em>eg</em></font><font face="Arial" color="#000100" size="3">.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x ~ dnorm(mu, tau)T(lower, upper)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>would denote a quantity x from the modified normal distribution normalized by dividing by the integral of the distribution between limits lower and upper, which lies between lower and upper. Leaving either lower or upper blank corresponds to no limit, e.g. T(lower,) corresponds to an observation known to lie above lower. x can either be observed or unobseved.<br><br>It is also important to note that if x, mu, tau , lower and upper are all unobserved, then lower and upper must not be functions of mu and tau.<br><br>Nodes with a discrete distribution must in general have integer values. Observed variables having a binomial or Posson distribution are exempt from this restriction.<br><br>Certain parameters of distributions must be constants, that is they can not be learnt. These include both parameters of the Wishart distributions, the order (N) of the multinomial distribution and the threshold (mu) of the generalized Pareto distribution.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The precision matrices for multivariate normals must be positive definite. If a Wishart prior is not used for the precision matrix, then the elements of the precision matrix are updated univariately without any check of positive-definiteness. This will result in a crash </font><font face="Arial" color="#000000" size="3">unless the precision matrix is parameterised appropriately. </font><font face="Arial" color="#000000" size="3"><strong>This is the user's responsibility! </strong></font><font face="Arial" color="#000000" size="3">Forming the precision matrix from the product of cholesky factors will ensure positive definiteness.<br><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="LogicalNodes"></font><font face="Courier New" color="#000100" size="5">The BUGS language: logical nodes</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Logical nodes are represented by the node name followed by a left pointing arrow followed by a logical expression of its parent nodes e.g.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Logical expressions can be built using the following operators: plus (A + B), multiplication (A * B), minus (A - B), division (A / B) and unitary minus (-A). The scalar valued functions in </font><font face="Courier New" color="#0000FF" size="3"><a href="#ContentsAII">Appendix&nbsp;II&nbsp;Functions&nbsp;and&nbsp;Functionals</a></font><font face="Arial" color="#000100" size="3"> can also be used in logical expressions. A vector values logical function can only be used as the sole term on the right hand side of a vector valued logical relation.<br><br>A link function can also be specified acting on the left hand side of a logical node </font><font face="Arial" color="#000100" size="3"><em>e.g.</em></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;logit(mu[i]) &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]<br><br>The following functions can be used on the left hand side of logical nodes as link functions: log, logit, cloglog, and probit (where probit(x) &lt;- y is equivalent to x &lt;- phi(y)).<br><br>A special logical node called &quot;deviance&quot; is created automatically by </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3">: this calculates -2 * log(likelihood), where 'likelihood' is the conditional probability of all data nodes given their stochastic parent nodes. This node can be monitored, and is used in the DIC tool - see </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/InferenceMenu.html#DIC">DIC...</a></font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Courier New" color="#000100" size="5"><a id="ArraysAndIndexing">Arrays and indexing</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Arrays are indexed by terms within square brackets. The four basic operators +, -, *, and / along with appropriate bracketing are allowed to calculate an integer function as an index, for example:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[(i + j) * k, l]<br><br>On the left-hand-side of a relation, an expression that always evaluates to a fixed value is allowed for an index, whether it is a constant or a function of data. On the right-hand-side the index can be a fixed value or a named node, which allows a straightforward formulation for mixture models in which the appropriate element of an array is 'picked' according to a random quantity (see</font><font face="Courier New" color="#0000FF" size="3"> <a href="#NestedIndexingAndMixtures">Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</a></font><font face="Arial" color="#000100" size="3">). However, functions of unobserved nodes are not permitted to appear directly as an index term (intermediate deterministic nodes may be introduced if such functions are required).<br><br>The conventions broadly follow those of S-Plus:<br><br>&nbsp;&nbsp;&nbsp;n : m&nbsp;&nbsp;&nbsp;represents </font><font face="Arial" color="#000100" size="3"><em>n</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><em>n</em></font><font face="Arial" color="#000100" size="3"> + 1, ..., </font><font face="Arial" color="#000100" size="3"><em>m</em></font><font face="Arial" color="#000100" size="3">.<br>&nbsp;&nbsp;&nbsp;x[ ]&nbsp;&nbsp;&nbsp;represents all values of a vector </font><font face="Arial" color="#000100" size="3"><em>x</em></font><font face="Arial" color="#000100" size="3">.<br>&nbsp;&nbsp;&nbsp;y[, 3]&nbsp;&nbsp;&nbsp;indicates all values of the third column of a two-dimensional array </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Multidimensional arrays are handled as one-dimensional arrays with a constructed index. Thus functions defined on arrays must be over equally spaced nodes within an array: for example sum(y[i, 1:4, k]).<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000000" size="3">When dealing with unbalanced or hierarchical data a number of different approaches are possible - see </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#HandlingUnbalancedDatasets">Handling&nbsp;unbalanced&nbsp;datasets</a>.</font><font face="Arial" color="#000000" size="3"> The ideas discussed in</font><font face="Courier New" color="#0000FF" size="3"> <a href="#NestedIndexingAndMixtures">Nested&nbsp;indexing&nbsp;and&nbsp;mixtures</a></font><font face="Arial" color="#000000" size="3"> may also be helpful in this respect.<br><br><br></font><font face="Arial" color="#000000" size="2"><a id="RepeatedStructures"></font><font face="Courier New" color="#000100" size="5">Repeated structures</font><font face="Arial" color="#000000" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]<br></font><font face="Arial" color="#FF0000" size="5"><strong><br></strong></font><font face="Arial" color="#000000" size="3">Repeated structures are specified using a &quot;for - loop&quot;. The syntax for this is:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in a : b) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><em>list of statements to be repeated for increasing values of loop-variable </em></font><font face="Arial" color="#000000" size="3">i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Note that neither a nor b may be stochastic - see </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#WhereTheSizeOfASetIsARandomQuantity">here</a> </font><font face="Arial" color="#000000" size="3">for a possible way to get round this.<br><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="DataTransformations"></font><font face="Courier New" color="#000100" size="5">Data transformations</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Although transformations of data can always be carried out before using </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3">, it is convenient to be able to try various transformations of dependent variables within a model description. For example, we may wish to try both </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>sqrt(y)</em></font><font face="Arial" color="#000100" size="3"> as dependent variables without creating a separate variable </font><font face="Arial" color="#000100" size="3"><em>z = sqrt(y)</em></font><font face="Arial" color="#000100" size="3"> in the data file.<br><br>The BUGS language therefore permits the following type of structure to occur:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z[i] &lt;- sqrt(y[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z[i] ~ dnorm(mu, tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>Strictly speaking, this goes against the declarative structure of the model specification, with the accompanying exhortation to construct a directed graph and then to make sure that each node appears once and only once on the left-hand side of a statement. However, a check has been built in so that, when finding a logical node which also features as a stochastic node (such as z above), a stochastic node is created with the calculated values as fixed data.<br><br>We emphasise that this construction is only possible when transforming observed data (not a function of data and parameters) with no missing values.<br><br>This construction is particularly useful in Cox modelling and other circumstances where fairly complex functions of data need to be used. It is preferable for clarity to place the transformation statements in a section at the beginning of the model specification, so that the essential model description can be examined separately. See the </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Leuk.html">Leuk</a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Endo.html">Endo</a></font><font face="Arial" color="#000100" size="3"> examples.<br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="5"><a id="NestedIndexingAndMixtures">Nested indexing and mixtures</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Nested indexing can be very effective. For example, suppose </font><font face="Arial" color="#000100" size="3"><em>N</em></font><font face="Arial" color="#000100" size="3"> individuals can each be in one of </font><font face="Arial" color="#000100" size="3"><em>I</em></font><font face="Arial" color="#000100" size="3"> groups, and </font><font face="Arial" color="#000100" size="3"><em>g[1:N] </em></font><font face="Arial" color="#000100" size="3">is a vector which contains the group membership. Then &quot;group&quot; coefficients </font><font face="Arial" color="#000100" size="3"><em>beta[i]</em></font><font face="Arial" color="#000100" size="3"> can be fitted using </font><font face="Arial" color="#000100" size="3"><em>beta[g[j]]</em></font><font face="Arial" color="#000100" size="3"> in a regression equation.<br><br>In the </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language, nested indexing can be used for the parameters of distributions: for example, the</font><font face="Courier New" color="#0000FF" size="3"> <a href="../Examples/Eyes.html">Eyes</a></font><font face="Arial" color="#000100" size="3"> example concerns a normal mixture in which the </font><font face="Arial" color="#000100" size="3"><em>i </em></font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> case is in an unknown group </font><font face="Arial" color="#000100" size="3"><em>T</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> which determines the mean </font><font face="Arial" color="#000100" size="3"><em>l</em></font><font face="Arial" color="#000100" size="3"><em><sub>T</sub></em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> of the measurement </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3">. Hence the model is<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> ~ Categorical(</font><font face="Arial" color="#000100" size="3"><em>P</em></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3"><em>l</em></font><font face="Arial" color="#000100" size="3"><em><sub>T</sub></em></font><font face="Arial" color="#000100" size="3"><em><sub>i</sub></em></font><font face="Arial" color="#000100" size="3"> , </font><font face="Symbol" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> )<br><br>which may be written in the BUGS language as<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[i] ~ dcat(P[])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(lambda[T[i]], tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br>The mixture construct can also be applied to vector value parameters eg<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : ns){<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">nbiops[i] &lt;- sum(biopsies[i, ]) <br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">true[i] ~ dcat(p[])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">biopsies[i, 1 : 4] ~ dmulti(error[true[i], ], nbiops[i])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Multiple (up to four) variable indices are allowed in setting up mixture models. eg<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dyspnoea ~ dcat(p.dyspnoea[either,bronchitis,1:2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;either &lt;- max(tuberculosis,lung.cancer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bronchitis ~ dcat(p.bronchitis[smoking,1:2])<br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><a id="FormattingOfData"></font><font face="Courier New" color="#000100" size="5">Formatting of data</a> </font><font face="Arial" color="#000100" size="2"></font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Data can be in an S-Plus format (see most of the examples</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">) or, for data in arrays, in rectangular format.<br><br>Missing values are represented as NA.<br><br>The whole array must be specified in the file - it is not possible just to specify selected components. Any parts of the array you do not want to specify must be filled with NAs.<br><br>All variables in a data file must be defined in a model, even if just left unattached to the rest of the model. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="FormattingOfDataSPlusFormat">S-Plus format:</a></strong></font><font face="Arial" color="#000100" size="3"> This allows scalars and arrays to be named and given values in a single structure headed by key-word list. There must be no space after list.<br><br>For example, in the Rats example, we need to specify a scalar </font><font face="Arial" color="#000100" size="3"><em>xbar</em></font><font face="Arial" color="#000100" size="3">, dimensions </font><font face="Arial" color="#000100" size="3"><em>N</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>T</em></font><font face="Arial" color="#000100" size="3">, a vector </font><font face="Arial" color="#000100" size="3"><em>x</em></font><font face="Arial" color="#000100" size="3"> and a two-dimensional array </font><font face="Arial" color="#000100" size="3"><em>Y</em></font><font face="Arial" color="#000100" size="3"> with 30 rows and 5 columns. This is achieved using the following format:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbar = 22, N = 30, T = 5,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = c(8.0, 15.0, 22.0, 29.0, 36.0),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y = structure(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Data = c(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;151, 199, 246, 283, 320,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;145, 199, 249, 293, 354,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...................<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...................<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;137, 180, 219, 258, 291,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;153, 200, 244, 286, 324),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Dim = c(30, 5)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br><br></font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3"> reads data into an array by filling the right-most index first, whereas the S-Plus program fills the left-most index first. Hence </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3"> reads the string of numbers c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) into a 2 * 5 dimensional matrix in the order&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;[i, j]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10<br><br>whereas S-Plus reads the same string of numbers in the order<br><br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;[i, j]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10<br><br>Hence the ordering of the array dimensions must be reversed before using the S-Plus dput function to create a data file for input into </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3">.<br><br>For example, consider the 2 * 5 dimensional matrix<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;10<br><br>This must be stored in S-Plus as a 5 * 2 dimensional matrix:<br><br>&gt; M<br>[,1] [,2]<br>[1,] 1 6<br>[2,] 2 7<br>[3,] 3 8<br>[4,] 4 9<br>[5,] 5 10<br><br>The S-Plus command<br><br>&gt; dput(list(M=M), file=&quot;matrix.dat&quot;)<br><br>will then produce the following data file<br><br>list(M = structure(.Data = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10), .Dim=c(5,2))<br><br>Edit the .Dim statement in this file from .Dim=c(5,2) to .Dim=c(2,5). The file is now in the correct format to input the required 2 * 5 dimensional matrix into </font><font face="Arial" color="#000100" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000100" size="3">.<br><br>Now consider a 3 * 2 * 4 dimensional array<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;8<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;12<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;16<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;20<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;24<br><br></font><font face="Arial" color="#000000" size="3">This must be stored in S-Plus as the 4 * 2 * 3 dimensional array:<br><br>&gt; A<br>, , 1<br>[,1] [,2]<br>[1,] 1 5<br>[2,] 2 6<br>[3,] 3 7<br>[4,] 4 8<br><br>, , 2<br>[,1] [,2]<br>[1,] 9 13<br>[2,] 10 14<br>[3,] 11 15<br>[4,] 12 16<br><br>, , 3<br>[,1] [,2]<br>[1,] 17 21<br>[2,] 18 22<br>[3,] 19 23<br>[4,] 20 24<br><br>The command<br></font><font face="Arial" color="#000100" size="3"><br>&gt; dput(list(A=A), file=&quot;array.dat&quot;)<br><br>will then produce the following data file<br><br>list(A = structure(.Data = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1</font><font face="Arial" color="#000000" size="3">6, 17, 18, 19, 20, 21, 22, 23, 24), .Dim=c(4,2,3))</font><font face="Arial" color="#000100" size="3"><br><br>Edit the .Dim </font><font face="Arial" color="#000000" size="3">statement in this file from .Dim=c(4,2,3) to .Dim=c(3,2,4). The file is now in the correct format to input the required 3 * 2 * 4 dimensional array into </font><font face="Arial" color="#000000" size="3"><em>OpenBUGS </em></font><font face="Arial" color="#000000" size="3">in the order</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[i, j, k]th element of matrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 1, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1, 2, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 1, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 2, 1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2, 2, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3, 2, 3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3, 2, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="FormattingOfDataRectangularFormat">Rectangular format:</a> </strong></font><font face="Arial" color="#000100" size="3">The columns for data in rectangular format need to be headed by the array name. The arrays need to be of equal size, and the array names must have explicit brackets: for example:<br><br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;age[]&nbsp;&nbsp;&nbsp;sex[]<br>&nbsp;&nbsp;&nbsp;26&nbsp;&nbsp;&nbsp;0<br>&nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;1<br>&nbsp;&nbsp;&nbsp;.....<br>&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;&nbsp;0<br>END<br><br><a id="FormattingOfDataENDCommand"></font><font face="Arial" color="#000000" size="3"><strong>Note that the file must end with an 'END' keyword, as shown above and below, and this must be followed by at least one blank line.</strong></font><font face="Arial" color="#000000" size="3"></a><br><br></font><font face="Arial" color="#000100" size="3">Multi-dimensional arrays can be specified by explicit indexing: for example, the</font><font face="Courier New" color="#0000FF" size="3"> <a href="../Examples/Ratsy.html">Ratsy</a></font><font face="Arial" color="#000100" size="3"> file begins<br><br>&nbsp;&nbsp;&nbsp;Y[,1]&nbsp;&nbsp;&nbsp;Y[,2]&nbsp;&nbsp;&nbsp;Y[,3]&nbsp;&nbsp;&nbsp;Y[,4]&nbsp;&nbsp;&nbsp;Y[,5]<br>&nbsp;&nbsp;&nbsp;151&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;246&nbsp;&nbsp;&nbsp;283&nbsp;&nbsp;&nbsp;320<br>&nbsp;&nbsp;&nbsp;145&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;249&nbsp;&nbsp;&nbsp;293&nbsp;&nbsp;&nbsp;354<br>&nbsp;&nbsp;&nbsp;147&nbsp;&nbsp;&nbsp;214&nbsp;&nbsp;&nbsp;263&nbsp;&nbsp;&nbsp;312&nbsp;&nbsp;&nbsp;328<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.......<br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;153&nbsp;&nbsp;&nbsp;200&nbsp;&nbsp;&nbsp;244&nbsp;&nbsp;&nbsp;286&nbsp;&nbsp;&nbsp;324<br>END<br><br>The first index position for any array must always be empty.<br></font><font face="Arial" color="#000100" size="3"><br>It is possible to load a mixture of rectangular and S-Plus format data files for the same model. For example, if data arrays are provided in a rectangular file, constants can be defined in a separate list statement (see also the </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Rats.html">Rats</a> </font><font face="Arial" color="#000100" size="3">example with data files </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Ratsx.html">Ratsx</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Ratsy.html">Ratsy</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">).<br><br>(See </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#HandlingUnbalancedDatasets">here</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for details of how to handle unbalanced data.)<br><br>Note that programs exist for conversion of data from other packages: please see the BUGS resources web-page at <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.mrc-bsu.cam.ac.uk/bugs/weblinks/webresource.shtml<br><br><br><br></font><font face="Arial" color="#000100" size="2"><img src="modelspecification4.bmp" alt="[modelspecification4]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="2"><a id="ContentsAI"></font><font face="Arial" color="#000100" size="6"><strong><sup>Appendix I Distributions</sup></strong></font><font face="Arial" color="#000100" size="2"></a><br><br></font><font face="Courier New" color="#000100" size="5">Contents&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#DiscreteUnivariate">Discrete&nbsp;Univariate</a></strong></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;<br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="#Bernoulli">Bernoulli</a><br>&nbsp;&nbsp;&nbsp;<a href="#Binomial">Binomial</a><br>&nbsp;&nbsp;&nbsp;<a href="#Categorical">Categorical</a><br>&nbsp;&nbsp;&nbsp;<a href="#NegativeBinomial">Negative&nbsp;Binomial</a><br>&nbsp;&nbsp;&nbsp;<a href="#Poisson">Poisson</a><br></font><font face="Arial" color="#000100" size="4"><br></font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#ContinuousUnivariate">Continuous&nbsp;Univariate</strong></font><font face="Arial" color="#000100" size="4"></a>&nbsp;&nbsp;&nbsp;<br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="#Beta">Beta</a><br>&nbsp;&nbsp;&nbsp;<a href="#ChiSquared">Chi-squared</a><br>&nbsp;&nbsp;&nbsp;<a href="#DoubleExponential">Double&nbsp;Exponential</a><br>&nbsp;&nbsp;&nbsp;<a href="#Exponential">Exponential</a><br>&nbsp;&nbsp;&nbsp;<a href="#Flat">Flat</a><br>&nbsp;&nbsp;&nbsp;<a href="#Gamma">Gamma</a><br>&nbsp;&nbsp;&nbsp;<a href="#Generic">Generic&nbsp;distribution</a><br>&nbsp;&nbsp;&nbsp;<a href="#GeneralizedExtremeValue">Generalized&nbsp;Extreme&nbsp;Value</a><br>&nbsp;&nbsp;&nbsp;<a href="#GeneralizedGamma">Generalized&nbsp;Gamma</a><br>&nbsp;&nbsp;&nbsp;<a href="#GeneralizedPareto">Generalized&nbsp;Pareto</a><br>&nbsp;&nbsp;&nbsp;<a href="#LogNormal">Log-normal</a><br>&nbsp;&nbsp;&nbsp;<a href="#Logistic">Logisitic</a><br>&nbsp;&nbsp;&nbsp;<a href="#Normal">Normal</a><br>&nbsp;&nbsp;&nbsp;<a href="#Pareto">Pareto</a><br>&nbsp;&nbsp;&nbsp;<a href="#StudentT">Student-t</a><br>&nbsp;&nbsp;&nbsp;<a href="#Uniform">Uniform</a><br>&nbsp;&nbsp;&nbsp;<a href="#Weibull">Weibull</a><br></font><font face="Arial" color="#000100" size="4"><br></font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#DiscreteMultivariate">Discrete&nbsp;Multivariate</strong></font><font face="Arial" color="#000100" size="4"></a>&nbsp;&nbsp;&nbsp;<br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="#Multinomial">Multinomial</a></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="4"><br></font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#ContinuousMultivariate">Continuous&nbsp;Multivariate</a></strong></font><font face="Arial" color="#000100" size="4">&nbsp;&nbsp;&nbsp;<br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="#Dirichlet">Dirichlet</a><br>&nbsp;&nbsp;&nbsp;<a href="#MultivariateNormal">Multivariate&nbsp;Normal</a><br>&nbsp;&nbsp;&nbsp;<a href="#MultivariateStudentT">Multivariate&nbsp;Student-t</a><br>&nbsp;&nbsp;&nbsp;<a href="#Wishart">Wishart</a><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="DiscreteUnivariate"></strong></font><font face="Courier New" color="#000100" size="5">Discrete Univariate</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Courier New" color="#0000FF" size="3">[<a href="#ContentsAI">top appendix i</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong><a id="Bernoulli">Bernoulli</a></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><sup>r ~ </sup></font><font face="Arial" color="#000000" size="3"><sup>dbern</sup></font><font face="Arial" color="#000100" size="3"><sup>(p)</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification5.bmp" alt="[modelspecification5]"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Binomial">Binomial</a></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><sup>r ~ </sup></font><font face="Arial" color="#000000" size="3"><sup>dbin(p, n)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification6.bmp" alt="[modelspecification6]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Categorical">Categorical</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>r ~ dcat(p[])</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification7.bmp" alt="[modelspecification7]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="NegativeBinomial">Negative Binomial</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dnegbin(p, r)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification8.bmp" alt="[modelspecification8]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Poisson">Poisson</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>r ~ dpois(lambda)</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification9.bmp" alt="[modelspecification9]"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="ContinuousUnivariate"></strong></font><font face="Courier New" color="#000100" size="5">Continuous Univariate</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#ContentsAI">top appendix i</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong><a id="Beta">Beta</a></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><sup>p ~</sup></font><font face="Arial" color="#000000" size="3"><sup> dbeta(a, b)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification10.bmp" alt="[modelspecification10]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="ChiSquared">Chi-squared</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dchisqr(k)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification11.bmp" alt="[modelspecification11]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="DoubleExponential">Double Exponential</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ ddexp(mu, tau)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification12.bmp" alt="[modelspecification12]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Exponential">Exponential</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dexp(lambda)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification13.bmp" alt="[modelspecification13]"><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Flat">Flat</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dflat()&nbsp;&nbsp;&nbsp;constant value for all x; not a proper distribution</sup></font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Gamma">Gamma</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dgamma(r, mu)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification14.bmp" alt="[modelspecification14]"><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Generic">Generic</a> distribution</strong></font><font face="Arial" color="#000000" size="3"><br>x ~dgeneric(lambda)&nbsp;&nbsp;&nbsp;exp(lambda); NB does not depend on x<br><br><a id="GeneralizedExtremeValue"></font><font face="Arial" color="#000000" size="3"><strong>Generalized Extreme Value</strong></font><font face="Arial" color="#000000" size="3"></a> <br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dGEV(mu,sigma,eta) </sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification15.bmp" alt="[modelspecification15]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><a id="GeneralizedGamma"></font><font face="Arial" color="#000000" size="3"><strong>Generalized Gamma</strong></font><font face="Arial" color="#000000" size="3"></a><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ gen.gamma(r, mu, beta)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification16.bmp" alt="[modelspecification16]"><br><br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3"><a id="GeneralizedPareto"></font><font face="Arial" color="#000000" size="3"><strong>Generalized Pareto</strong></font><font face="Arial" color="#000000" size="3"></a></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3"><sup></sup></font><font face="Arial" color="#000000" size="3"><sup>x ~ dGPD(mu,sigma,eta) </sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification17.bmp" alt="[modelspecification17]"></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="LogNormal">Log-normal</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dlnorm(mu, tau)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification18.bmp" alt="[modelspecification18]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Logistic">Logistic</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dlogis(mu, tau)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification19.bmp" alt="[modelspecification19]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Normal">Normal</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dnorm(mu, tau)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification20.bmp" alt="[modelspecification20]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Pareto">Pareto</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dpar(alpha, c)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification21.bmp" alt="[modelspecification21]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="StudentT">Student-t</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dt(mu, tau, k)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification22.bmp" alt="[modelspecification22]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Uniform">Uniform</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dunif(a, b)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification23.bmp" alt="[modelspecification23]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Weibull">Weibull</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x ~ dweib(v, lambda)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification24.bmp" alt="[modelspecification24]"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="DiscreteMultivariate"></strong></font><font face="Courier New" color="#000100" size="5">Discrete Multivariate</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#ContentsAI">top appendix i</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong><a id="Multinomial">Multinomial</a></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><sup>x[] ~</sup></font><font face="Arial" color="#000000" size="3"><sup> dmulti(p[], N)</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification25.bmp" alt="[modelspecification25]"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="ContinuousMultivariate"></strong></font><font face="Courier New" color="#000100" size="5">Continuous Multivariate</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#ContentsAI">top appendix i</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><br><a id="Dirichlet">Dirichlet</a></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><sup>p[] ~</sup></font><font face="Arial" color="#000000" size="3"><sup> ddirch(alpha[])</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification26.bmp" alt="[modelspecification26]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="MultivariateNormal">Multivariate Normal</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x[] ~ dmnorm(mu[], T[,])</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification27.bmp" alt="[modelspecification27]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="MultivariateStudentT">Multivariate Student-t</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x[] ~ dmt(mu[], T[,], k)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification28.bmp" alt="[modelspecification28]"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Wishart">Wishart</a></strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><sup>x[,] ~ dwish(R[,], k)</sup></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;<img src="modelspecification29.bmp" alt="[modelspecification29]"></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br><br><br><img src="modelspecification30.bmp" alt="[modelspecification30]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="2"><a id="ContentsAII"></font><font face="Arial" color="#000100" size="6"><strong><sup>Appendix II Functions and Functionals</sup></strong></font><font face="Arial" color="#000100" size="2"></a><br></font><font face="Arial" color="#000100" size="3"><br><br>Function arguments represented by e can be expressions, those by s must be scalar-valued nodes in the graph and those represented by v must be vector-valued nodes in a graph. Some function arguments must be stochastic nodes. Functionals are described using a similar notation<br>to functions, the special notation F(x) is used to describe the function on which the functional acts. See example </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Functionals.html">Functionals</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for details. Systems of ordinary differential equations and their solution can be described in the BUGS language by using the special D(x[1 : n], t) notation.See example </font><font face="Courier New" color="#0000FF" size="3"><a href="../Examples/Sixcomp.html">ode</a> </font><font face="Arial" color="#000100" size="3">for details. <br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="5">Scalar functions </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="5"><strong><u><br></u></strong></font><font face="Arial" color="#000100" size="1"><strong><u></u></strong></font><font face="Arial" color="#000100" size="1"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">abs(e)&nbsp;&nbsp;&nbsp;absolute value of e, |e|<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arccos(e)&nbsp;&nbsp;&nbsp;inverse cosine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arccosh(e)&nbsp;&nbsp;&nbsp;inverse hyberbolic cosine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arcsin(e)&nbsp;&nbsp;&nbsp;inverse sine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arcsinh(e)&nbsp;&nbsp;&nbsp;inverse hyberbolic sine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arctan&nbsp;&nbsp;&nbsp;inverse tangent of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;arctanh&nbsp;&nbsp;&nbsp;inverse hyberbolic tangent of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">cloglog</font><font face="Arial" color="#000100" size="3">(e)&nbsp;&nbsp;&nbsp;complementary log log of e, ln(-ln(1 - </font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3">))<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;cos(e)&nbsp;&nbsp;&nbsp;cosine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;cosh(e)&nbsp;&nbsp;&nbsp;hyberbolic cosine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;culmative(s1, s2)&nbsp;&nbsp;&nbsp;tail area of distribution of s1 up to the value of s2, s1 must be <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stochastic, s1 and s2 can be the same<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><a id="CutFunction">cut(e)</a>&nbsp;&nbsp;&nbsp;cuts edges in the graph - see <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/Tricks.html#UseOfTheCutFunction">Use&nbsp;of&nbsp;the&nbsp;&quot;cut&quot;&nbsp;function</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="3"><strong><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="3">density(s1, s2)&nbsp;&nbsp;&nbsp;density of distribution of s1 at value of s2, s1 must be<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stochastic, s1 and s2 can be the same<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><br>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="3">deviance(s1, s2)&nbsp;&nbsp;&nbsp;deviance of distribution of s1 at value of s2, s1 must be<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stochastic, s1 and s2 can be the same<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">equals(e1, e2)&nbsp;&nbsp;&nbsp;1 if </font><font face="Arial" color="#000000" size="3"><em>value of e</em></font><font face="Arial" color="#000000" size="3">1 equals value of </font><font face="Arial" color="#000000" size="3"><em>e</em></font><font face="Arial" color="#000000" size="3">2; 0 otherwise<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">exp</font><font face="Arial" color="#000100" size="3">(e)&nbsp;&nbsp;&nbsp;exp(</font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;gammap(s1, s2)&nbsp;&nbsp;&nbsp;partial (imcomplete) gamma function, value of standard<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma density with parameter s1 integrated up to s2<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><sup>inprod(v1, v2)</sup></font><font face="Arial" color="#000000" size="3"><sup>&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000000" size="3"><sup>inner product of v1 and v2, </sup></font><font face="Symbol" color="#000100" size="6"><sub></sub></font><font face="Symbol" color="#000100" size="6"><sup>S</sup></font><font face="Arial" color="#000000" size="1"><sup>i </sup></font><font face="Arial" color="#000000" size="3"><sup>v</sup></font><font face="Arial" color="#000000" size="2"><sup>1</sup></font><font face="Arial" color="#000000" size="1"><sup>i</sup></font><font face="Arial" color="#000000" size="1"><sup> </sup></font><font face="Arial" color="#000000" size="3"><sup>v</sup></font><font face="Arial" color="#000000" size="2"><sup>2i</sup></font><font face="Arial" color="#000000" size="2"><sub><br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000000" size="3">integral(F(s), s1, s2, s3)&nbsp;&nbsp;&nbsp;definite integral of function F(s) between s = s1 and s = s2 to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy s3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><a id="InterpLinFunction">interp.lin(e, v1, v2)</a></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">v</font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2"> + (</font><font face="Arial" color="#000000" size="3">v</font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1</sub></font><font face="Arial" color="#000000" size="2"> - </font><font face="Arial" color="#000000" size="3">v</font><font face="Arial" color="#000000" size="2">2</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">) * (</font><font face="Arial" color="#000000" size="3">e - v</font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">) / (</font><font face="Arial" color="#000000" size="3">v</font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1</sub></font><font face="Arial" color="#000000" size="2"> - </font><font face="Arial" color="#000000" size="3">v</font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">where the elements of </font><font face="Arial" color="#000000" size="3"><em>v</em></font><font face="Arial" color="#000000" size="2">1 </font><font face="Arial" color="#000000" size="3">are in ascending order<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;and p is such that </font><font face="Arial" color="#000000" size="3"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="2"> &lt; </font><font face="Arial" color="#000000" size="3"><em>e</em></font><font face="Arial" color="#000000" size="2"> &lt; </font><font face="Arial" color="#000000" size="3"><em>v</em></font><font face="Arial" color="#000000" size="2">1</font><font face="Arial" color="#000000" size="1"><sub>p</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>+</sub></font><font face="Arial" color="#000000" size="1"><sub> </sub></font><font face="Arial" color="#000000" size="1"><sub>1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">log</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">natural logarithm of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;logdet(v)&nbsp;&nbsp;&nbsp;log of determinant of v for symmetric positive-definite </font><font face="Arial" color="#000100" size="3"><em>v<br>&nbsp;&nbsp;&nbsp;<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;logfact(e)&nbsp;&nbsp;&nbsp;ln(</font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3">!)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;loggam(e)&nbsp;&nbsp;&nbsp;logarithm of gamma function of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">logit</font><font face="Arial" color="#000100" size="3">(e)&nbsp;&nbsp;&nbsp;ln(</font><font face="Arial" color="#000100" size="3"><em>e </em></font><font face="Arial" color="#000100" size="3">/ (1 - </font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3">))<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;max(e1, e2)&nbsp;&nbsp;&nbsp;e1 if e1 &gt; e2; e2 otherwise<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><sup>mean</sup></font><font face="Arial" color="#000100" size="3"><sup>(v)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="6"><sub>S</sub></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3">v</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> / </font><font face="Arial" color="#000100" size="3">n</font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">n = dim(v)</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">min(e1, e2)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">e1 if e1 &lt; e2; e2 otherwise<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;phi(e)&nbsp;&nbsp;&nbsp;standard normal cdf<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1"><sup>&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3"><sup>post.p.value(s)&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3">s must be a stochastic node, returns one if a sample from <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the prior is less than the value of s.<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><sup>pow(e1, e2)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="2">1</font><font face="Arial" color="#000100" size="1"><em><sup>e</sup></em></font><font face="Arial" color="#000100" size="1"><sup>2<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3"><sup>prior.p.value(s)&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3">s must be a stochastic node, returns one if a sample from <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the prior after resampling its stochastic parents is less than<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value of s.<br></font><font face="Arial" color="#000100" size="1"><sup>&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">rank(v, s)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">number of components of v</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">less than or equal to s</font><font face="Arial" color="#000100" size="1"><sub><br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><sup>ranked(v, s)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">the </font><font face="Arial" color="#000100" size="3"><em>s</em></font><font face="Arial" color="#000100" size="1"><sup>th</sup></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">smallest component of v</font><font face="Arial" color="#000100" size="3"><em><br></em></font><font face="Arial" color="#000100" size="1"><sup>&nbsp;&nbsp;&nbsp;<br></sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;replicate.post(s)&nbsp;&nbsp;&nbsp;replicate from distribution of s, s must be stochastic node&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;replicate.prior(s)&nbsp;&nbsp;&nbsp;replicate from distribution of s after replicating from it patents if<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;they are stochastic, s must be stochastic node&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="2"><em><br></em></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">round(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">nearest integer to e</font><font face="Arial" color="#000100" size="3"><em><br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;sin(e)&nbsp;&nbsp;&nbsp;sine of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;sinh(e)&nbsp;&nbsp;&nbsp;hyberbolic sine of e<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000000" size="2"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000000" size="3">solve(F(s), s1, s2, s3)&nbsp;&nbsp;&nbsp;a solution of equation F(s) = 0 lying between s = s1 and s = s2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to accuracy s3, s1 and s2 must braket a solution<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><sup>sqrt</sup></font><font face="Arial" color="#000100" size="3"><sup>(e)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">e</font><font face="Arial" color="#000100" size="1"><sup>1/2<br></sup></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;<br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sd(v)&nbsp;&nbsp;&nbsp;standard deviation of components of </font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="3"> (n - 1 in denominator)<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">step</font><font face="Arial" color="#000100" size="3">(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1 if </font><font face="Arial" color="#000100" size="3"><em>e</em></font><font face="Arial" color="#000100" size="3"> &gt;= 0; 0 otherwise<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><sup>sum(v)</sup></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="6"><sub>S</sub></font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><em>v</em></font><font face="Arial" color="#000100" size="1"><sub>i<br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">tan(e)&nbsp;&nbsp;&nbsp;tangent of e<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;tanh(e)&nbsp;&nbsp;&nbsp;hyberbolic tangent of e<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">trunc(e)</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">greatest integer less than or equal to e</font><font face="Arial" color="#000100" size="2"><em><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="1"><strong><u><br></u></strong></font><font face="Courier New" color="#000100" size="5">Vector functions</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;inverse(v)&nbsp;&nbsp;&nbsp;inverse of matrix v for symetric posative-definite v<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;eigen.vals(v)&nbsp;&nbsp;&nbsp;eigen values of matrix v<br></font><font face="Arial" color="#000100" size="3"><sup>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;ode(v1, v2, D(v3, s1), s2, s3) &nbsp;&nbsp;&nbsp;solution of system of ordinary differential equations at grid <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of points v2 given initial values v1 at time s2 solved<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to acccuracy s3. v3 is a vector of components of the system<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of ode and s1 is the time variable.</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><sup>p.valueM(v)&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3">v must be a multivariate stochastic node, returns a vector of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ones and zeros depending on if a sample from the prior is less<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than value of the corresponding component of v<br><br>&nbsp;&nbsp;&nbsp;replicate.postM(v)&nbsp;&nbsp;&nbsp;replicate from multivatiate distribution of v, v must be stcohastic<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and multivariate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><sup><br>&nbsp;&nbsp;&nbsp;sort(v)&nbsp;&nbsp;&nbsp;vector v sorted in asscending order<br></sup></font></p></body></html>
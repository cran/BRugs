<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Tutorial</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="tutorial0.bmp" alt="[tutorial0]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;Tutorial</strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="Contents"></font><font face="Arial" color="#000100" size="5"><strong>Contents</strong></font><font face="Arial" color="#000100" size="2"></a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#Introduction"></font><font face="Arial" color="#0000FF" size="4"><u>Introduction</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#SpecifyingAModelInTheBUGSLanguage"></font><font face="Arial" color="#0000FF" size="4"><u>Specifying&nbsp;a&nbsp;model&nbsp;in&nbsp;the&nbsp;BUGS&nbsp;language</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#RunningAModelInWinBUGS"></font><font face="Arial" color="#0000FF" size="4"><u>Running&nbsp;a&nbsp;model&nbsp;in&nbsp;WinBUGS</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#MonitoringParameterValues"></font><font face="Arial" color="#0000FF" size="4"><u>Monitoring&nbsp;parameter&nbsp;values</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#CheckingConvergence"></font><font face="Arial" color="#0000FF" size="4"><u>Checking&nbsp;convergence</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#HowManyIterationsAfterConvergence?"></font><font face="Arial" color="#0000FF" size="4"><u>How&nbsp;many&nbsp;iterations&nbsp;after&nbsp;convergence?</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#ObtainingSummariesOfThePosteriorDistribution"></font><font face="Arial" color="#0000FF" size="4"><u>Obtaining&nbsp;summaries&nbsp;of&nbsp;the&nbsp;posterior&nbsp;distribution</u></font><font face="Arial" color="#0000FF" size="4"></a><br><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Introduction">Introduction</a></strong></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">This tutorial is designed to provide new users with a step-by-step guide to running an analysis in WinBUGS. It is not intended to be prescriptive, but rather to introduce you to the main tools needed to run an MCMC simulation in WinBUGS, and give some guidance on appropriate usage of the software.<br><br>The </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Seeds.html">Seeds</a></font><font face="Arial" color="#000100" size="3"> example from Volume I of the WinBUGS examples will be used throughout this tutorial. This example is taken from Table 3 of Crowder (1978) and concerns the proportion of seeds that germinated on each of 21 plates arranged according to a 2 by 2 factorial layout by seed and type of root extract. The data are shown below, where r</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> are the number of germinated and the total number of seeds on the i</font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> plate, i = 1, ..., N. These data are also analysed by, for example, Breslow and Clayton (1993).<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><em>&nbsp;&nbsp;&nbsp;seed O. aegyptiaco 75&nbsp;&nbsp;&nbsp;seed O. aegyptiaco 73</em></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;Bean&nbsp;&nbsp;&nbsp;Cucumber&nbsp;&nbsp;&nbsp;Bean&nbsp;&nbsp;&nbsp;Cucumber<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;r/n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;r/n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;r/n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;r/n<br>&nbsp;&nbsp;&nbsp;_____________________________________________________________________<br><br>&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;39&nbsp;&nbsp;&nbsp;0.26&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;0.83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;0.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;0.25<br>&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;62&nbsp;&nbsp;&nbsp;0.37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;53&nbsp;&nbsp;&nbsp;74&nbsp;&nbsp;&nbsp;0.72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;0.33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;41&nbsp;&nbsp;&nbsp;0.54&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;81&nbsp;&nbsp;&nbsp;0.28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;55&nbsp;&nbsp;&nbsp;72&nbsp;&nbsp;&nbsp;0.76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;0.29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;0.50<br>&nbsp;&nbsp;&nbsp;26&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;0.51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;0.63&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;45&nbsp;&nbsp;&nbsp;0.51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;0.63<br>&nbsp;&nbsp;&nbsp;17&nbsp;&nbsp;&nbsp;39&nbsp;&nbsp;&nbsp;0.44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp;&nbsp;79&nbsp;&nbsp;&nbsp;0.58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;0.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;0.43<br></font><font face="Arial" color="#000100" size="2"><sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="2"><sup>&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;0.77</sup></font><font face="Arial" color="#000100" size="2"><sup>&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#0000FF" size="2"><strong><sup><br></sup></strong></font><font face="Arial" color="#0000FF" size="2"><strong></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The model is essentially a random effects logistic regression, allowing for over-dispersion. If p</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the probability of germination on the i</font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> plate, we assume<br><br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = a</font><font face="Arial" color="#000100" size="3"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + a</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> + a</font><font face="Arial" color="#000100" size="3"><sub>2</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> + a</font><font face="Arial" color="#000100" size="3"><sub>12</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> + b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0, t)<br>&nbsp;&nbsp;&nbsp;<br>where x</font><font face="Arial" color="#000100" size="3"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> and x</font><font face="Arial" color="#000100" size="3"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> are the seed type and root extract of the i</font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> plate, and an interaction term a</font><font face="Arial" color="#000100" size="3"><sub>12</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="3"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> is included.</font><font face="Arial" color="#000100" size="2"><br><br><a id="SpecifyingAModelInTheBUGSLanguage"></font><font face="Arial" color="#000100" size="5"><strong>Specifying a model in the BUGS language</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The BUGS language allows a concise expression of the model, using the 'twiddles' symbol ~ to denote stochastic (probabilistic) relationships, and the left arrow ('&lt;' sign followed by '-' sign) to denote deterministic (logical) relationships. The stochastic parameters a</font><font face="Arial" color="#000100" size="3"><sub>0</sub></font><font face="Arial" color="#000100" size="3">, a</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, a</font><font face="Arial" color="#000100" size="3"><sub>2</sub></font><font face="Arial" color="#000100" size="3">, a</font><font face="Arial" color="#000100" size="3"><sub>12</sub></font><font face="Arial" color="#000100" size="3">, and t are given proper but minimally informative prior distributions, while the logical expression for sigma allows the standard deviation (of the random effects distribution) to be estimated.</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r[i] ~ dbin(p[i], n[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0, tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p[i]) &lt;- alpha0 + alpha1 * x1[i] + alpha2 * x2[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ alpha12 * x1[i] * x2[i] + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha1 ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha2 ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha12 ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}<br><br>More detailed descriptions of the BUGS language along with lists of the available logical functions and stochastic distributions can be found in </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Model Specification.html"></font><font face="Arial" color="#0000FF" size="3"><u>Model&nbsp;Specification</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Distributions.html"></font><font face="Arial" color="#0000FF" size="3"><u>Distributions</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">. See also the on-line examples: </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volumei.html"></font><font face="Arial" color="#0000FF" size="3"><u>Volume&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volumeii.html"></font><font face="Arial" color="#0000FF" size="3"><u>Volume&nbsp;2</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volumeiii.html"></font><font face="Arial" color="#0000FF" size="3"><u>Volume&nbsp;3</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">. An alternative way of specifying a model in WinBUGS is to use the graphical interface known as </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/DoodleBUGS Manual.html"></font><font face="Arial" color="#0000FF" size="3"><u>DoodleBUGS</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><a id="RunningAModelInWinBUGS"></font><font face="Arial" color="#000100" size="5"><strong>Running a model in WinBUGS</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The WinBUGS software uses </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Compound Documents.html"></font><font face="Arial" color="#0000FF" size="3"><u>compound&nbsp;documents</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">, which comprise various different types of information (formatted text, tables, formulae, plots, graphs, etc.) displayed in a single window and stored in a single file. This means that it is possible to run the model for the &quot;seeds&quot; example directly from this tutorial document, since the model code can be made 'live' just by highlighting it. However, it is more usual when creating your own models to have the model code and data etc. in separate files. We have therefore created a separate file with the model code in it for this tutorial - you will find the file in </font><font face="Arial" color="#000000" size="3">Docu/seeds_model (or click </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/seeds_model.html"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3">).</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong>Step 1<br></strong></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3">Open the seeds_model file as follows:<br><br>* Point to </font><font face="Arial" color="#FF0000" size="3"><u>F</u></font><font face="Arial" color="#FF0000" size="3">ile</font><font face="Arial" color="#000100" size="3"> on the tool bar and click once with the left mouse button (LMB).<br>* Highlight the </font><font face="Arial" color="#FF0000" size="3"><u>O</u></font><font face="Arial" color="#FF0000" size="3">pen...</font><font face="Arial" color="#000100" size="3"> option and click once with LMB.<br>* Select the appropriate directory and double-click on the file to open.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><strong></strong></font><font face="Arial" color="#000100" size="3"><strong>Step 2</strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3">To run the model, we first need to check that the model description does fully define a probability model:<br><br>* Point to </font><font face="Arial" color="#FF0000" size="3"><u>M</u></font><font face="Arial" color="#FF0000" size="3">odel</font><font face="Arial" color="#000100" size="3"> on the tool bar and click once with LMB.<br>* Highlight the </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">pecification...</font><font face="Arial" color="#000100" size="3"> option and click once with LMB.<br>* Focus the window containing the model code by clicking the LMB once anywhere in the window - the top panel of the window should then become highlighted in blue (usually) to indicate that the window is currently in focus.<br>* Highlight the word </font><font face="Arial" color="#FF00FF" size="3">model</font><font face="Arial" color="#000100" size="3"> at the beginning of the code by dragging the mouse over the word whilst holding down the LMB.<br>* Check the model syntax by clicking once with LMB on the </font><font face="Arial" color="#FF0000" size="3">check model</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;model is syntactically correct&quot; should appear in the bottom left of the WinBUGS program window.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong>Step 3</strong></font><font face="Arial" color="#000100" size="3"><br>We next need to load in the data. The data can be represented using </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Model Specification.html#FormattingOfDataSPlusFormat"></font><font face="Arial" color="#0000FF" size="3"><u>S-Plus&nbsp;object&nbsp;notation</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> (file </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/seeds_S_data.html">Docu/seeds_S_data</a></font><font face="Arial" color="#000100" size="3">), or as a combination of an S-Plus object and a </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Model Specification.html#FormattingOfDataRectangularFormat"></font><font face="Arial" color="#0000FF" size="3"><u>rectangular&nbsp;array</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> with labels at the head of each column (file </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/seeds_mix_data.html">Docu/seeds_mix_data</a></font><font face="Arial" color="#000100" size="3">).</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3">*</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Arial" color="#000000" size="3">Open one o</font><font face="Arial" color="#000100" size="3">f the data files now.<br>* To load the data in file </font><font face="Arial" color="#FF0000" size="3">Manuals/seeds_S_data</font><font face="Arial" color="#000100" size="3">:<br>- Highlight the word </font><font face="Arial" color="#FF00FF" size="3">list</font><font face="Arial" color="#000100" size="3"> at the beginning of the data file.<br>- Click once with the LMB on the </font><font face="Arial" color="#FF0000" size="3">load data</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;data loaded&quot; should appear in the bottom left of the WinBUGS program window.<br>* To load the data in file </font><font face="Arial" color="#FF0000" size="3">Manualsl/seeds_mix_data</font><font face="Arial" color="#000100" size="3">:<br>- Highlight the word </font><font face="Arial" color="#FF00FF" size="3">list</font><font face="Arial" color="#000100" size="3"> at the beginning of the data file.<br>- Click once with the LMB on the </font><font face="Arial" color="#FF0000" size="3">load data</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;data loaded&quot; should appear in the bottom left of the WinBUGS program window.<br>- Next highlight the whole of the header line (i.e. column labels) of the rectangular array data.&nbsp;&nbsp;&nbsp;- Click once with the LMB on the </font><font face="Arial" color="#FF0000" size="3">load data</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;data loaded&quot; should appear in the bottom left of the WinBUGS program window.<br><br></font><font face="Arial" color="#000100" size="3"><strong>Step 4<br></strong></font><font face="Arial" color="#000100" size="3">Now we need to select the number of chains (i.e. sets of samples to simulate). The default is 1, but we will use 2 chains for this tutorial, since running multiple chains is one way to </font><font face="Arial" color="#0000FF" size="3"><a href="#CheckingConvergence"></font><font face="Arial" color="#0000FF" size="3"><u>check&nbsp;the&nbsp;convergence</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> of your MCMC simulations.<br><br>* Type the number 2 in the white box labelled </font><font face="Arial" color="#FF0000" size="3">num of chains</font><font face="Arial" color="#000100" size="3"> in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. In practice, if you have a fairly complex model, you may wish to do a pilot run using a single chain to check that the model compiles and runs and obtain an estimate of the time taken per iteration. Once you are happy with the model, re-run it using multiple chains (say 2-5 chains) to obtain a final set of posterior estimates.<br><br></font><font face="Arial" color="#000100" size="3"><strong>Step 5<br></strong></font><font face="Arial" color="#000100" size="3">Next compile the model by clicking once with the LMB on the </font><font face="Arial" color="#FF0000" size="3">compile</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;model compiled&quot; should appear in the bottom left of the WinBUGS program window. This sets up the internal data structures and chooses the specific </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/Introduction.html#IntroductionMCMCMethods"></font><font face="Arial" color="#0000FF" size="3"><u>MCMC&nbsp;updating&nbsp;algorithms</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> to be used by WinBUGS for your particular model.<br><br></font><font face="Arial" color="#000100" size="3"><strong>Step 6<br></strong></font><font face="Arial" color="#000100" size="3">Finally the MCMC sampler must be given some initial values for each stochastic node. These can be arbitrary values, although in practice, convergence can be poor if wildly inappropriate values are chosen. You will need a different set of initial values for each chain, i.e. two sets are needed for this tutorial since we have specified two chains - these are stored in file </font><font face="Arial" color="#FF0000" size="3">Manuals/seeds_inits.</font><font face="Arial" color="#000100" size="3"><br><br>* Open this file now.<br>* To load the initial values:<br>- Highlight the word </font><font face="Arial" color="#FF00FF" size="3">list</font><font face="Arial" color="#000100" size="3"> at the beginning of the first set of initial values.<br>- Click once with the LMB on the </font><font face="Arial" color="#FF0000" size="3">load inits</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. A message saying &quot;initial values loaded: model contains uninitialized nodes (try running gen inits or loading more files)&quot; should appear in the bottom left of the WinBUGS program window.&nbsp;&nbsp;&nbsp;- Repeat this process for the second initial values file. A message saying &quot;initial values loaded: model initialized&quot; should now appear in the bottom left of the WinBUGS program window.<br><br></font><font face="Arial" color="#000100" size="3"><strong></strong></font><font face="Arial" color="#000100" size="3">Note that you do not need to provide a list of initial values for every parameter in your model. You can get WinBUGS to generate initial values for any stochastic parameter not already initialized by clicking with the LMB on the </font><font face="Arial" color="#FF0000" size="3">gen inits</font><font face="Arial" color="#000100" size="3"> button in the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. WinBUGS generates initial values by forward sampling from the prior distribution for each parameter. Therefore, you are advised to </font><font face="Arial" color="#000100" size="3"><strong>provide your own initial values for parameters with vague prior distributions</strong></font><font face="Arial" color="#000100" size="3"> to avoid wildly inappropriate values.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>Step 7</strong></font><font face="Arial" color="#000100" size="3"><br>Close the </font><font face="Arial" color="#FF0000" size="3">Specification Tool</font><font face="Arial" color="#000100" size="3"> window. You are now ready to start running the simulation. However, before doing so, you will probably want to set some monitors to store the sampled values for selected parameters. For the seeds example, set monitors for the parameters </font><font face="Arial" color="#000000" size="3">alpha0</font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000000" size="3">alpha1</font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000000" size="3">alpha2</font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000000" size="3">alpha12</font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000000" size="3">sigma</font><font face="Arial" color="#000100" size="3"> - see </font><font face="Arial" color="#0000FF" size="3"><a href="#MonitoringParameterValues"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">for details on how to do this.<br><br>To run the simulation:<br><br>* Select the </font><font face="Arial" color="#FF0000" size="3"><u>U</u></font><font face="Arial" color="#FF0000" size="3">pdate...</font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#FF0000" size="3"><u>M</u></font><font face="Arial" color="#FF0000" size="3">odel</font><font face="Arial" color="#000100" size="3"> menu.<br>* Type the number of updates (iterations of the simulation) you require in the appropriate white box (labelled </font><font face="Arial" color="#FF0000" size="3">updates</font><font face="Arial" color="#000100" size="3">) - the default value is 1000.<br>* Click once on the </font><font face="Arial" color="#FF0000" size="3">update</font><font face="Arial" color="#000100" size="3"> button: the program will now start simulating values for each parameter in the model. This may take a few seconds - the box marked </font><font face="Arial" color="#FF0000" size="3">iteration</font><font face="Arial" color="#000100" size="3"> will tell you how many updates have currently been completed. The number of times this value is revised depends on the value you have set for the </font><font face="Arial" color="#FF0000" size="3">refresh</font><font face="Arial" color="#000100" size="3"> option in the white box above the </font><font face="Arial" color="#FF0000" size="3">iteration</font><font face="Arial" color="#000100" size="3"> box. The default is every 100 iterations, but you can ask the program to report more frequently by changing </font><font face="Arial" color="#FF0000" size="3">refresh</font><font face="Arial" color="#000100" size="3"> to, say, 10 or 1. A sensible choice will depend on how quickly the program runs. For the seeds example, experiment with changing the refresh option from 100 to 10 and then 1.<br>* When the updates are finished, the message &quot;updates took *** s&quot; will appear in the bottom left of the WinBUGS program window (where *** is the number of seconds taken to complete the simulation).<br>* If you previously set monitors for any parameters you can now check convergence and view graphical and numerical summaries of the samples. Do this now for the parameters you monitored in the seeds example - see </font><font face="Arial" color="#0000FF" size="3"><a href="#CheckingConvergence"></font><font face="Arial" color="#0000FF" size="3"><u>Checking&nbsp;convergence</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">for tips on how to do this (for the seeds example, you should find that at least 2000 iterations are required for convergence).<br>* Once you're happy tha</font><font face="Arial" color="#000000" size="3">t your simulation has converged, you will need to run some further updates to obtain a sample from the posterior distribution. The section </font><font face="Arial" color="#0000FF" size="3"><a href="#HowManyIterationsAfterConvergence?"></font><font face="Arial" color="#0000FF" size="3"><u>How&nbsp;many&nbsp;iterations&nbsp;after&nbsp;convergence?</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> provides tips on deciding how many more updates you should run. For the seeds example, try running a further 10000 updates.<br>* Once you have run enough updates to obtain an appropriate sample from the posterior distribution, you may summarise these samples numerically and graphically (see section </font><font face="Arial" color="#0000FF" size="3"><a href="#ObtainingSummariesOfThePosteriorDistribution"></font><font face="Arial" color="#0000FF" size="3"><u>Obtaining&nbsp;summaries&nbsp;of&nbsp;the&nbsp;posterior&nbsp;distribution</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for details on how to do this). For the seeds example, summary statistics for the monitored parameters are shown below:<br><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;alpha0&nbsp;&nbsp;&nbsp;-0.5553&nbsp;&nbsp;&nbsp;0.1904&nbsp;&nbsp;&nbsp;0.003374&nbsp;&nbsp;&nbsp;-0.9365&nbsp;&nbsp;&nbsp;-0.5563&nbsp;&nbsp;&nbsp;-0.1763&nbsp;&nbsp;&nbsp;2001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha1&nbsp;&nbsp;&nbsp;0.08693&nbsp;&nbsp;&nbsp;0.3123&nbsp;&nbsp;&nbsp;0.006873&nbsp;&nbsp;&nbsp;-0.5502&nbsp;&nbsp;&nbsp;0.09157&nbsp;&nbsp;&nbsp;0.6964&nbsp;&nbsp;&nbsp;2001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha12&nbsp;&nbsp;&nbsp;-0.8358&nbsp;&nbsp;&nbsp;0.4388&nbsp;&nbsp;&nbsp;0.01105&nbsp;&nbsp;&nbsp;-1.731&nbsp;&nbsp;&nbsp;-0.8253&nbsp;&nbsp;&nbsp;-0.002591&nbsp;&nbsp;&nbsp;2001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha2&nbsp;&nbsp;&nbsp;1.359&nbsp;&nbsp;&nbsp;0.2744&nbsp;&nbsp;&nbsp;0.005812&nbsp;&nbsp;&nbsp;0.8204&nbsp;&nbsp;&nbsp;1.354&nbsp;&nbsp;&nbsp;1.923&nbsp;&nbsp;&nbsp;2001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;0.2855&nbsp;&nbsp;&nbsp;0.146&nbsp;&nbsp;&nbsp;0.005461&nbsp;&nbsp;&nbsp;0.04489&nbsp;&nbsp;&nbsp;0.2752&nbsp;&nbsp;&nbsp;0.6132&nbsp;&nbsp;&nbsp;2001&nbsp;&nbsp;&nbsp;20000</font><font face="Arial" color="#000100" size="3"><br><br>* To save any files created during your WinBUGS run, focus the window containing the information you want to save, and select the </font><font face="Arial" color="#FF0000" size="3">Save </font><font face="Arial" color="#FF0000" size="3"><u>A</u></font><font face="Arial" color="#FF0000" size="3">s...</font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#FF0000" size="3"><u>F</u></font><font face="Arial" color="#FF0000" size="3">ile</font><font face="Arial" color="#000100" size="3"> menu.<br>* To quit WinBUGS, select the </font><font face="Arial" color="#FF0000" size="3">E</font><font face="Arial" color="#FF0000" size="3"><u>x</u></font><font face="Arial" color="#FF0000" size="3">it</font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#FF0000" size="3"><u>F</u></font><font face="Arial" color="#FF0000" size="3">ile</font><font face="Arial" color="#000100" size="3"> menu.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="2"><a id="MonitoringParameterValues"></font><font face="Arial" color="#000100" size="5"><strong>Monitoring parameter values</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">In order to check convergence and obtain posterior summaries of the model parameters, you first need to set </font><font face="Arial" color="#000100" size="3"><strong>monitors</strong></font><font face="Arial" color="#000100" size="3"> for each parameter of interest. This tells WinBUGS to store the values sampled for those parameters; otherwise, WinBUGS automatically discards the simulated values.<br><br>There are two types of monitor in WinBUGS:<br><br><a id="SamplesMonitors"></font><font face="Arial" color="#000100" size="3"><strong>Samples monitors:</strong></font><font face="Arial" color="#000100" size="3"></a> Setting a samples monitor tells WinBUGS to store</font><font face="Arial" color="#000100" size="3"><em> every</em></font><font face="Arial" color="#000100" size="3"> value it simulates for that parameter. You will need to set a samples monitor if you want to view trace plots of the samples to check convergence (see </font><font face="Arial" color="#0000FF" size="3"><a href="#CheckingConvergence"></font><font face="Arial" color="#0000FF" size="3"><u>Checking&nbsp;convergence</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">) or if you want to obtain 'exact' posterior quantiles, for example, the posterior 95% Bayesian credible interval for that parameter. (Note that you can also obtain </font><font face="Arial" color="#000100" size="3"><em>approximate</em></font><font face="Arial" color="#000100" size="3"> 2.5%, 50% and 97.5% quantiles of the posterior distribution for each parameter using </font><font face="Arial" color="#0000FF" size="3"><a href="#SummaryMonitors"></font><font face="Arial" color="#0000FF" size="3"><u>summary&nbsp;monitors</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3">.</font><font face="Arial" color="#000100" size="3">)<br><br>To set a samples monitor:<br><br>* Select </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">amples...</font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference</font><font face="Arial" color="#000100" size="3"> menu;<br>* Type the name of the parameter to be monitored in the white box marked </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3">;<br>* Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">set</font><font face="Arial" color="#000100" size="3">;<br>* Repeat for each parameter to be monitored.<br><br><a id="SummaryMonitors"></font><font face="Arial" color="#000100" size="3"><strong>Summary monitors:</strong></font><font face="Arial" color="#000100" size="3"></a> Setting a summary monitor tells WinBUGS to store the running mean and standard deviation for the parameter, plus approximate running quantiles (2.5%, 50% and 97.5%). The values saved contain less information than saving each individual sample in the simulation, but require much less storage. This is an important consideration when running long simulations (e.g. 1000's of iterations) and storing values for many variables.<br><br>We recommend setting summary monitors on long vectors of parameters such as random effects in order to store posterior summaries, and then also setting full </font><font face="Arial" color="#0000FF" size="3"><a href="#SamplesMonitors"></font><font face="Arial" color="#0000FF" size="3"><u>samples&nbsp;monitors</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> on a small subset of the random effects, plus other relevant parameters (e.g. means and variances), to check convergence.<br><br>To set a summary monitor:<br><br>* Select </font><font face="Arial" color="#FF0000" size="3">S</font><font face="Arial" color="#FF0000" size="3"><u>u</u></font><font face="Arial" color="#FF0000" size="3">mmary...</font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference</font><font face="Arial" color="#000100" size="3"> menu;<br>* Type the name of the parameter to be monitored in the white box marked </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3">;<br>* Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">set</font><font face="Arial" color="#000100" size="3">;<br>* Repeat for each parameter to be monitored.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>Note: you should not set a summary monitor until you are happy that convergence has been reached (see </strong></font><font face="Arial" color="#0000FF" size="3"><a href="#CheckingConvergence"></font><font face="Arial" color="#0000FF" size="3"><u>Checking&nbsp;convergence</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000000" size="3"><strong>), since it is not possible to discard any of the pre-convergence ('burn-in') values from the summary once it is set, ot</strong></font><font face="Arial" color="#000100" size="3"><strong>her than to clear the monitor and re-set it.<br></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><a id="CheckingConvergence"></font><font face="Arial" color="#000100" size="5"><strong>Checking convergence</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Checking convergence requires considerable care. </font><font face="Arial" color="#000100" size="3"><strong>It is very difficult to say conclusively that a chain (simulation) has converged, only to diagnose when it definitely hasn't!</strong></font><font face="Arial" color="#000100" size="3"><br><br>The following are practical guidelines for assessing convergence:<br><br>* For models with many parameters, it is impractical to check convergence for every parameter, so just choose a random selection of relevant parameters to monitor. For example, rather than checking convergence for every element of a vector of random effects, just choose a random subset (say, the first 5 or 10).<br>* Examine trace plots of the sample values versus iteration to look for evidence of when the simulation appears to have stabilised:<br><br>To obtain 'live' trace plots for a parameter:<br><br>- Select </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">amples...</font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference </font><font face="Arial" color="#000100" size="3">menu.<br>- Type the name of the parameter in the white box marked </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3">.<br>- Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">trace</font><font face="Arial" color="#000100" size="3">: an empty graphics window will appear on screen.<br>- Repeat for each parameter of interest.<br>- Once you start running the simulations (using the </font><font face="Arial" color="#FF0000" size="3"><u>U</u></font><font face="Arial" color="#FF0000" size="3">pdate...</font><font face="Arial" color="#000100" size="3"> tool from the </font><font face="Arial" color="#FF0000" size="3"><u>M</u></font><font face="Arial" color="#FF0000" size="3">odel</font><font face="Arial" color="#000100" size="3"> menu), trace plots for these parameters will appear 'live' in the graphics windows.<br><br>To obtain a trace plot showing the full history of the samples </font><font face="Arial" color="#000100" size="3"><em>for any parameter for which you have previously set a samples monitor and carried out some updates</em></font><font face="Arial" color="#000100" size="3">:<br><br>- Select </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">amples...</font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference </font><font face="Arial" color="#000100" size="3">menu.<br>- Type the name of the parameter in the white box marked </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3"> (or select the name from the pull down list of currently monitored nodes - click once with the LMB on the downward-facing arrowhead to the immediate right of the </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3"> field).<br>- Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">history</font><font face="Arial" color="#000100" size="3">: a graphics window showing the sample trace will appear.<br>- Repeat for each parameter of interest.<br><br>The following plots are examples of: (i) chains for which convergence (in the pragmatic sense) looks reasonable (left-hand-side); and (ii) chains which have clearly not reached convergence (right-hand-side).</font><font face="Arial" color="#000100" size="2"><br><br><br><br></font><font face="Arial" color="#000100" size="3">If you are running more than one chain simultaneously, the trace and history plots will show each chain in a different colour. In this case, we can be reasonably confident that convergence has been achieved if all the chains appear to be overlapping one another.<br><br>The following plots are examples of: (i) multiple chains for which convergence looks reasonable (top); and (ii) multiple chains which have clearly not reached convergence (bottom).<br></font><font face="Arial" color="#000100" size="2"><br><br><img src="tutorial2.bmp" alt="[tutorial2]"></font><font face="Arial" color="#FF00FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br><img src="tutorial3.bmp" alt="[tutorial3]"><br><br></font><font face="Arial" color="#000100" size="3">For a more formal approach to convergence diagnosis the software also provides an implementation (see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/The Inference Menu.html#SamplesDialogBGRDiag"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">) of the techniques described in <a href="../Manuals/References.html#BGRDiagPaper"></font><font face="Arial" color="#0000FF" size="3"><u>Brooks&nbsp;&amp;&nbsp;Gelman&nbsp;(1998)</u></font><font face="Arial" color="#000100" size="3"></a>, and a facility for outputting monitored samples in a format that is compatible with the </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/References.html#CODARef"></font><font face="Arial" color="#0000FF" size="3"><em><u>CODA</u></em></font><font face="Arial" color="#0000FF" size="3"><u>&nbsp;software</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> - see </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/The Inference Menu.html#SamplesDialogCODA"></font><font face="Arial" color="#0000FF" size="3"><u>here</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="2"><br><a id="HowManyIterationsAfterConvergence?"></font><font face="Arial" color="#000100" size="5"><strong>How many iterations after convergence?</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Once you are happy that convergence has been achieved, you will need to run the simulation for a further number of iterations to obtain samples that can be used for posterior inference. The more samples you save, the more accurate will be your posterior estimates.<br><br>One way to assess the accuracy of the posterior estimates is by calculating the Monte Carlo error for each parameter. This is an estimate of the difference between the mean of the sampled values (which we are using as our estimate of the posterior mean for each parameter) and the true posterior mean.<br><br>As a rule of thumb, the simulation should be run until the Monte Carlo error for each parameter of interest is less than about 5% of the sample standard deviation. The Monte Carlo error (MC error) and sample standard deviation (SD) are reported in the summary statistics table (see section </font><font face="Arial" color="#0000FF" size="3"><a href="#ObtainingSummariesOfThePosteriorDistribution"></font><font face="Arial" color="#0000FF" size="3"><u>Obtaining&nbsp;summaries&nbsp;of&nbsp;the&nbsp;posterior&nbsp;distribution</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">).<br><br></font><font face="Arial" color="#000100" size="2"><a id="ObtainingSummariesOfThePosteriorDistribution"></font><font face="Arial" color="#000100" size="5"><strong>Obtaining summaries of the posterior distribution</strong></font><font face="Arial" color="#000100" size="2"></a> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">The posterior samples may be summarised either graphically, e.g. by kernel density plots, or numerically, by calculating summary statistics such as the mean, variance and quantiles of the sample.<br><br>To obtain summaries of the monitored samples, to be used for posterior inference:<br><br>* Select </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">amples...</font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference </font><font face="Arial" color="#000100" size="3">menu.<br>* Type the name of the parameter in the white box marked </font><font face="Arial" color="#FF0000" size="3">node</font><font face="Arial" color="#000100" size="3"> (or select the name from the pull down list, or ty</font><font face="Arial" color="#000000" size="3">pe &quot;*&quot; (star) to </font><font face="Arial" color="#000100" size="3">select all monitored parameters).&nbsp;&nbsp;&nbsp;* Type the iteration number that you want to start your summary from in the white box marked </font><font face="Arial" color="#FF0000" size="3">beg</font><font face="Arial" color="#000100" size="3">: this allows the pre-convergence 'burn-in' samples to be discarded.<br>* Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">stats</font><font face="Arial" color="#000100" size="3">: a table reporting various summary statistics based on the sampled values of the selected parameter will appear.<br>* Click once with the LMB on the button marked </font><font face="Arial" color="#FF0000" size="3">density</font><font face="Arial" color="#000100" size="3">: a window showing kernel density plots based on the sampled values of the selected parameter will appear.<br><br>Please see the manual entry </font><font face="Arial" color="#0000FF" size="3"><a href="../Manuals/The Inference Menu.html#Samples"></font><font face="Arial" color="#0000FF" size="3"><u>Samples...</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3"> for a detailed description of the </font><font face="Arial" color="#FF0000" size="3">Sample Monitor Tool</font><font face="Arial" color="#000100" size="3"> dialog box (i.e. that which appears when </font><font face="Arial" color="#FF0000" size="3"><u>S</u></font><font face="Arial" color="#FF0000" size="3">amples...</font><font face="Arial" color="#000100" size="3"> is selected from the </font><font face="Arial" color="#FF0000" size="3">I</font><font face="Arial" color="#FF0000" size="3"><u>n</u></font><font face="Arial" color="#FF0000" size="3">ference</font><font face="Arial" color="#000100" size="3"> menu).<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font></p></body></html>
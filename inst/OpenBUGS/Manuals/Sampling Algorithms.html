<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Sampling Algorithms</title></head><body><p><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="2"><img src="sampling algorithms0.bmp" alt="[sampling algorithms0]">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="6"><strong><sup>Sampling Algorithms</sup></strong></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="4">Version 2.10, April 2005</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;Andrew Thomas</font><font face="Arial" color="#000100" size="1"><sup>1</sup></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>1 </sup></font><font face="Arial" color="#000100" size="3">Dept of Mathematics &amp; Statistics,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;University of Helsinki<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Helsinki<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finland</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;e-mail: ant@rni.helsinki.fi&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="2"><a id="Contents"></font><font face="Arial" color="#000100" size="5"><strong>Contents</strong></font><font face="Arial" color="#000100" size="2"></a><br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#Choice"></font><font face="Arial" color="#0000FF" size="4"><u>Choice&nbsp;of&nbsp;Sampling&nbsp;Algorithms</u></font><font face="Arial" color="#0000FF" size="4"></a><br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="4"><a href="#Description"></font><font face="Arial" color="#0000FF" size="4"><u>Description&nbsp;of&nbsp;Sampling&nbsp;Algorithms</u></font><font face="Arial" color="#0000FF" size="4"></a><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><a id="Choice"></font><font face="Arial" color="#000000" size="4"><strong>Choice of Sampling Algorithm</strong></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a><br></font><font face="Arial" color="#000100" size="3"><br>When OpenBUGS starts up a file called </font><font face="Arial" color="#0000FF" size="3"><a href="../Updater/Rsrc/Methods.txt"></font><font face="Arial" color="#0000FF" size="3"><u>methods.txt</u></font><font face="Arial" color="#0000FF" size="3"></a> </font><font face="Arial" color="#000100" size="3">in /Updater/Rsrc is read. The modules implementing the sampling methods listed in this file are then loaded dynamically. Factory objects to create updater objects which use these methods are stored in an array (in the same order as in the file). The first factory object in this array is used to create updaters for all the stochastic nodes in the model that need updating and for which the associated sampling method is valid and wishes to create updaters. If there are any nodes which do not have updater objects created by this first factory the second factory is tried and so on. In this way only a single updater object is created for each node that needs sampling. If non of the factories are able to create an updater object for a node in the model that needs sampling an error is reported. It is the function of the factory to decide if its associate sampling method is valid for a particular node in the model. Factory objects associated with sampling algorithms listed at the start of the methods file can impose strict conditions on the node for which they are able to create an updater object. In general algorithms at the start of the methods file do block updating of nodes. Users can develope special purpose sampling algorithms and place them at the start of the methods file. Algorithms towards the end of the method file tend to be general purpose (and somewhat less efficient) than earlier algorithms.<br><br>The methods file can contain comments. If the algorithm occurs after a comment symbol (the #) it is not loaded or used. An algorithm might be commented out because it is less efficient than a competing algorithm, because it performs badly in some test situations, because it causes less efficient algorithms to be chosen for other nodes or because it has not been tested enough. Users are enouraged to try some of the commented out algorithms and to report their good and bad experiences.<br><br>The module UpdaterKrigparam is given as an example of special purpose updater that will only be used for sampling the parameters of a kriging prior. The actual sampling algorithm used is the general purpose delayed single component adaptive metropolis but the factory object only returns an updater object if the likelihood is a kriging prior.<br><br></font><font face="Arial" color="#0000FF" size="3"><a id="Description"></font><font face="Arial" color="#000000" size="4"><strong>Description of Sampling Algorithms</strong></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#0000FF" size="3"><a href="#Contents">[top]</a><br></font><font face="Arial" color="#000100" size="3"><br>Here is an alphabetical list of install procedures for updaters that can be used followed by a brief note on how the algorithm works and what type of situation it is appropiate to. <br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMblock.InstallGLM</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater with delayed rejection and continously adapted multivariate normal proposal distribution. For a fixed effect block of nodes all of which have a a logistic or log-linear conditional distribution. Non markov algorithm. Not currently used.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMblock.InstallHetro</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater with delayed rejection and continously adapted multivariate normal proposal distribution. For a fixed effect block of nodes the first element of which has a generic conditional distribution. Non markov algorithm. Not currently used.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMblock.InstallHomo</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater with delayed rejection and continously adapted multivariate normal proposal distribution. For a fixed effect block of nodes all of which have a generic conditional distribution. Non markov algorithm. Not currently used.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMblock.InstallRE</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater with delayed rejection and continously adapted multivariate normal proposal distribution. For a random effect block of nodes all of which have a logit or log-linear conditional distribution. Non markov algorithm. Not currently used.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMNLLS.InstallMarginal&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;Continously adaptive block metropolis algorithm for non-linear least squares problem with the measurement error precision integrated out.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterAMNLLS.InstallCond&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;Continously adaptive block metropolis algorithm for non-linear least squares problem.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterBeta.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for beta conditional distribution.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterCatagorical.Install</strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for univariate node which takes descrete values with a upper bound. Works by enumeration. Slow if many catagories.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterChain.Install</strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Updater for a node with chain graph prior. Works as a sequence of univariate updaters but can inpose a constraint such as the sum to zero constariant for CAR priors.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterDescreteSlice.Install&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Slice type sampler for descrete variable. Competes with UpdaterCatagorical if descrete varaible has upper bound and with UpdaterMetbinomial if no upper bound.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterDFreeHybrid.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Metropolis type of updater for a block of nodes which has a generic conditional distribution with unbounded support. Proposal distribution is based on integration of Hamiltons equations of classical mechanics. Derivatives of log likelihood are calculated numericaly. Not currently used. There are three broad classes of updater: those that do Gibbs sampling, those that do Metropolis Hastings sampling and those that do slice sampling.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterDirichlet.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for a conditional distribution that is dirichlet.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterDirichletprior.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Slice sampler type of updater for a conditional distribution that has a dirichlet prior but non conjugate likelihood.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterForward.Install&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for univariate node which does not have any likelihood.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterGamma.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for gamma conditional distribution.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterGLM.InstallGLM</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Metropolis Hastings type updater for a block of nodes which have either a log-linear or logistic conditional distribution with unbounded support.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterGLM.InstallNormal</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for multivariate conditional distribution where the prior is a set of univariate normal nodes. Not currently used.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterGriddy.Install</strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>Independene Metropolis Hastings type updater for generic univariate distribution.&nbsp;&nbsp;&nbsp;Distribution must have bounded support. Builds a trapizoidal approximation to the conditional to use as the proposal. Slow algorithm. Not currently used, slice sampling is prefered but see note below about multimodality.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterHybridglm.Install<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Updater for random effect block of nodes with normal prior and loit, log-linear.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterHybridglm.InstallChain<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Updater for chain graph prior and loit, log-linear or normal likelihood.<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterHybridglm.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Metropolis type of updater for a block of nodes which has a normal, log-linear or logistic conditional distribution with unbounded support. Proposal distribution is based on integration of Hamiltons equations of classical mechanics. Used for random effects. Not currently used.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMetbinomial.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for univariate node which takes descrete values with no upper bound.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMetnormal.InstallDelayed</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for generic univariate distribution with unbounded support. Uses a normal proposal distribution that is adapted during a tunning phase. Uses delayed rejection if first proposal is rejected.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMetnormal.InstallStd</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for generic univariate distribution with unbounded support. Uses a normal proposal distribution that is adapted during a tunning phase. <br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMultinomial.Install&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Independence Metropolis utype of updater for a conditional distribution that has a multinomial prior.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMVNLinear.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;As for UpdaterMVNormal.Install but the likelihood can have terms that are multivariate normal of a different dimension to the prior and the link function does not have to be the identity but can have a linear form.<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterMVNormal.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for multivariate normal conditional distribution where each term in the likelihood is either normal, log normal or multivariate normal of same dimension as the prior with a unit link function.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterNormal.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for univariate normal conditional distribution.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterPareto.Install</strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for pareto conditional distribution.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterPoisson.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for poisson prior with single binomial likelihood term having order equal to the prior.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterRejection.Install</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for univariate node with log-linear or logistic distribution and unbounded support.<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterSCAM.InstallDelayed</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for generic univariate distribution with unbounded support. Uses a continously adapted normal proposal distribution. Non markov algorithm.&nbsp;&nbsp;&nbsp;Not currently used. Uses delayed rejection if first proposal rejected. <br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterSCAM.InstallDelayedB</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for generic univariate distribution with bounded support. Uses a continously adapted normal proposal distribution. Non markov algorithm. Not currently used. Uses delayed rejection if first proposal rejected. <br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterSCAM.InstallStd</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Current point Metropolis type updater for generic univariate distribution with unbounded support. Uses a continously adapted normal proposal distribution. Non markov algorithm. Not currently used.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterSlice.Install</strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>Slice type of updater for generic univariate distribution. Uses steping out search procedure to find the slice. Step length of search procedure adapted during tunning phase. Can miss modes for multimodal conditional distribution if the support is not bounded.<br><br></font><font face="Arial" color="#000100" size="3"><strong>UpdaterWishart.Install&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;Gibbs type of updater for conditional distributions that is a wishart.<br></font></p></body></html>
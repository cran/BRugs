<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>GeoBUGS Manual</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="geobugs manual0.bmp" alt="[geobugs manual0]">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="6"><strong><sup>GeoBUGS User Manual</sup></strong></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Version 1.2, August 2004</font><font face="Arial" color="#000100" size="2"><br><br><br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Andrew Thomas</font><font face="Arial" color="#000100" size="1"><sup>1&nbsp;&nbsp;&nbsp;</sup></font><font face="Arial" color="#000100" size="3">Nicky Best</font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Dave Lunn</font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;Richard Arnold</font><font face="Arial" color="#000100" size="1"><sup>3 </sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;David Spiegelhalter</font><font face="Arial" color="#000100" size="1"><sup>4</sup></font><font face="Arial" color="#000100" size="2"> <br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="1"><sup>&nbsp;&nbsp;&nbsp;1 </sup></font><font face="Arial" color="#000100" size="3">Rolf Nevanlinna Institute<br>&nbsp;&nbsp;&nbsp;P.O. Box 4 (Yliopistonkatu 5)<br>&nbsp;&nbsp;&nbsp;FIN-00014 University of Helsinki<br>&nbsp;&nbsp;&nbsp;Finland</font><font face="Arial" color="#000100" size="1"><sup><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;2 </sup></font><font face="Arial" color="#000100" size="3">Department of Epidemiology &amp; Public Health,<br>&nbsp;&nbsp;&nbsp;Imperial College School of Medicine,<br>&nbsp;&nbsp;&nbsp;Norfolk Place,<br>&nbsp;&nbsp;&nbsp;London W2 1PG, UK</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>3 </sup></font><font face="Arial" color="#000100" size="3">School of Mathematical and Computing Sciences <br>&nbsp;&nbsp;&nbsp;Victoria University, <br>&nbsp;&nbsp;&nbsp;P. O. Box 600, Wellington, <br>&nbsp;&nbsp;&nbsp;New Zealand</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;4</font><font face="Arial" color="#000100" size="1"><sup> </sup></font><font face="Arial" color="#000100" size="3">MRC Biostatistics Unit,<br>&nbsp;&nbsp;&nbsp;Institute of Public Health,<br>&nbsp;&nbsp;&nbsp;Robinson Way,<br>&nbsp;&nbsp;&nbsp;Cambridge CB2 2SR, UK<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;e-mail:</font><font face="Courier" color="#000100" size="3">&nbsp;&nbsp;&nbsp;bugs@mrc-bsu.cam.ac.uk&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">[general]</font><font face="Courier" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ant@rni.helsinki.fi</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;[technical]<br><br>&nbsp;&nbsp;&nbsp;internet:&nbsp;&nbsp;&nbsp;http://www.mrc-bsu.cam.ac.uk/bugs<br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Top"></a>Contents</strong></font><font face="Arial" color="#000100" size="2"></a></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Intro">Introduction</a><br><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Changes">Changes&nbsp;from&nbsp;GeoBUGS&nbsp;1.1Beta </a><br></u></strong></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Import">Importing&nbsp;map&nbsp;polygon&nbsp;files</a> </u></strong></font><font face="Arial" color="#0000FF" size="3"><u><br><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#Splus">Splus&nbsp;format</a><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcInfo">ArcInfo&nbsp;format</a><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#Epimap">Epimap&nbsp;format</a><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcView">ArcView&nbsp;format</a><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#Load">Loading&nbsp;a&nbsp;polygon&nbsp;file&nbsp;into&nbsp;GeoBUGS</a><br></u></font><font face="Arial" color="#000100" size="3"><strong><u><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Export">Exporting&nbsp;maps&nbsp;from&nbsp;GeoBUGS&nbsp;into&nbsp;Splus&nbsp;format</a><br><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Adj">Producing&nbsp;adjacency&nbsp;matrices</a><br><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Edit">Editing&nbsp;adjacency&nbsp;matrices</a></u></strong></font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Maps">Producing&nbsp;maps</a></u></strong></font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Cuts">User-specified&nbsp;cut-points&nbsp;and&nbsp;shading</a><br></u></strong></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Identify">Identifying&nbsp;individual&nbsp;areas&nbsp;on&nbsp;a&nbsp;map</a><br><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Save">Copying&nbsp;and&nbsp;saving&nbsp;maps</a></u></strong></font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Spatial">Spatial&nbsp;distributions</a></u></strong></font><font face="Arial" color="#0000FF" size="3"><u><br><br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#car.normal">car.normal&nbsp;and&nbsp;car.l1</a><br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#car.proper">car.proper</a> <br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#spatial.exp">spatial.exp&nbsp;and&nbsp;spatial.disc</a><br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#spatial.exp.pred">spatial.pred&nbsp;and&nbsp;spatial.unipred</a><br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#pois.conv">pois.conv</a><br></u></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#mv.car">mv.car</a><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><strong><u><br></u></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Temporal">Temporal&nbsp;distributions</a></u></strong></font><font face="Arial" color="#0000FF" size="3"><u><br><br></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="#rw">Using&nbsp;car.normal&nbsp;as&nbsp;a&nbsp;random&nbsp;walk&nbsp;prior&nbsp;for&nbsp;temporal&nbsp;smoothing</a><br></u></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="#Examples">Examples</a></u></strong></font><font face="Arial" color="#0000FF" size="3"><u><br></u></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#Lips"></font><font face="Arial" color="#0000FF" size="3"><u>1.Conditional&nbsp;Autoregressive&nbsp;(CAR)&nbsp;models&nbsp;for&nbsp;disease&nbsp;mapping:&nbsp;</u></font><font face="Arial" color="#0000FF" size="3"></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u>Lip&nbsp;cancer&nbsp;in&nbsp;Scotland</u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#HA"></font><font face="Arial" color="#0000FF" size="3"><u>2.&nbsp;Convolution</u></font><font face="Arial" color="#0000FF" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u>priors:&nbsp;Lung&nbsp;cancer&nbsp;in&nbsp;a&nbsp;London&nbsp;Health&nbsp;Authority</u></font><font face="Arial" color="#0000FF" size="3"></a><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#Lips2"></font><font face="Arial" color="#0000FF" size="3"><u>3.&nbsp;Proper&nbsp;CAR&nbsp;model:&nbsp;Lip&nbsp;cancer&nbsp;revisited</u></font><font face="Arial" color="#0000FF" size="3"></a><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#Kriging"></font><font face="Arial" color="#0000FF" size="3"><u>4.Bayesian&nbsp;kriging&nbsp;and&nbsp;spatial&nbsp;prediction:&nbsp;Surface&nbsp;elevation</u></font><font face="Arial" color="#0000FF" size="3"></a><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#forest"></font><font face="Arial" color="#0000FF" size="3"><u>5.&nbsp;Poisson</u></font><font face="Arial" color="#0000FF" size="3">-</font><font face="Arial" color="#0000FF" size="3"><u>gamma&nbsp;spatial&nbsp;moving&nbsp;average&nbsp;(convolution)&nbsp;model:</u></font><font face="Arial" color="#0000FF" size="3">&nbsp;</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u>Distribution&nbsp;of&nbsp;hickory&nbsp;trees&nbsp;in&nbsp;Duke&nbsp;forest</u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#saviah"></font><font face="Arial" color="#0000FF" size="3"><u>6.&nbsp;Poisson</u></font><font face="Arial" color="#0000FF" size="3">-</font><font face="Arial" color="#0000FF" size="3"><u>gamma&nbsp;spatial&nbsp;moving&nbsp;average&nbsp;(convolution)&nbsp;model:</u></font><font face="Arial" color="#0000FF" size="3"></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u>Ecological&nbsp;regression&nbsp;of&nbsp;air&nbsp;pollution&nbsp;and&nbsp;respiratory&nbsp;illness&nbsp;in&nbsp;children</u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#mvcar.example"></font><font face="Arial" color="#0000FF" size="3"><u>7.&nbsp;Intrinsic&nbsp;multivariate&nbsp;CAR&nbsp;prior&nbsp;for&nbsp;mapping&nbsp;multiple&nbsp;diseases:</u></font><font face="Arial" color="#0000FF" size="3"></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u>Oral&nbsp;cavity&nbsp;cancer&nbsp;and&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;West&nbsp;Yorkshire&nbsp;(UK)</u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#shared.example"></font><font face="Arial" color="#0000FF" size="3"><u>8.&nbsp;Shared&nbsp;component&nbsp;for&nbsp;mapping&nbsp;multiple&nbsp;diseases:</u></font><font face="Arial" color="#0000FF" size="3"></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u>Oral&nbsp;cavity&nbsp;cancer&nbsp;and&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;West&nbsp;Yorkshire&nbsp;(UK)</u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#air.pollution"></font><font face="Arial" color="#0000FF" size="3"><u>9.&nbsp;Random&nbsp;walk&nbsp;priors&nbsp;for&nbsp;temporal&nbsp;smoothing&nbsp;of&nbsp;daily&nbsp;air&nbsp;pollution&nbsp;estimates</u></font><font face="Arial" color="#0000FF" size="3"></a><br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><a href="#Appendix"></strong></font><font face="Arial" color="#0000FF" size="3"><strong><u>Appendix&nbsp;1:&nbsp;Technical&nbsp;details&nbsp;of&nbsp;Structured&nbsp;Multivariate&nbsp;Gaussian&nbsp;and</u></strong></font><font face="Arial" color="#0000FF" size="3"><strong></a><br></strong></font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong></strong></font><font face="Arial" color="#0000FF" size="3"><strong><u>Conditional&nbsp;Autoregressive&nbsp;(CAR)&nbsp;models&nbsp;and&nbsp;hyperprior&nbsp;specification</u></strong></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><em><a href="#Joint"></em></font><font face="Arial" color="#0000FF" size="3"><em><u>Joint&nbsp;specification</u></em></font><font face="Arial" color="#0000FF" size="3"><em></a><br></em></font><font face="Arial" color="#000100" size="3"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#0000FF" size="3"><em><a href="#Conditional"></em></font><font face="Arial" color="#0000FF" size="3"><em><u>Conditional&nbsp;specification</u></em></font><font face="Arial" color="#0000FF" size="3"><em></a> </em></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3"><em><u>Intrinsic&nbsp;CAR&nbsp;model</u></em></font><font face="Arial" color="#0000FF" size="3"><em></a><br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><em><u>Proper&nbsp;CAR&nbsp;model</u></em></font><font face="Arial" color="#0000FF" size="3"><em></a><br></em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#MV"></font><font face="Arial" color="#0000FF" size="3"><em><u>Intrinsic&nbsp;Multivariate&nbsp;CAR&nbsp;model</u></em></font><font face="Arial" color="#0000FF" size="3"><em></a></em></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><a href="#Appendix 2"></strong></font><font face="Arial" color="#0000FF" size="3"><strong><u>Appendix&nbsp;2:&nbsp;Technical&nbsp;details&nbsp;of&nbsp;the&nbsp;Poisson-gamma&nbsp;Spatial&nbsp;Moving&nbsp;Average</u></strong></font><font face="Arial" color="#0000FF" size="3"><strong></a><br></strong></font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong></strong></font><font face="Arial" color="#0000FF" size="3"><strong><u>convolution&nbsp;model</u></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><strong><a href="#Refs"></strong></font><font face="Arial" color="#0000FF" size="3"><strong><u>References</u></strong></font><font face="Arial" color="#0000FF" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="3"><strong><sub><br><br><br></sub></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Intro">Introduction</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS is an add-on module to WinBUGS which provides an interface for: <br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#Maps"></font><font face="Arial" color="#0000FF" size="3"><u>producing&nbsp;maps</u></font><font face="Arial" color="#000100" size="3"></a> of the output from disease mapping and other spatial models<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><u>creating</u></font><font face="Arial" color="#000100" size="3"></a> and <a href="#Edit"></font><font face="Arial" color="#0000FF" size="3"><u>manipulating</u></font><font face="Arial" color="#000100" size="3"></a> adjacency matrices that are required as input for the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#car.normal"></font><font face="Arial" color="#0000FF" size="3"><u>conditional autoregressive models</u></font><font face="Arial" color="#000100" size="3"></a> available in WinBUGS 1.4 for carrying out<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spatial smoothing. <br><br>Version 1.2 of GeoBUGS contains map files for<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Districts in Scotland (called </font><font face="Arial" color="#000100" size="3"><strong><em>Scotland</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Wards in a London Health Authority (called </font><font face="Arial" color="#000100" size="3"><strong><em>London_HA</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Counties in Great Britain (called </font><font face="Arial" color="#000100" size="3"><strong><em>GB_Counties</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Departements in France (called </font><font face="Arial" color="#000100" size="3"><strong><em>France</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Nomoi in Greece (called </font><font face="Arial" color="#000100" size="3"><strong><em>Greecenomoi</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Districts in Belgium (called </font><font face="Arial" color="#000100" size="3"><strong><em>Belgium</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Communes in Sardinia (called </font><font face="Arial" color="#000100" size="3"><strong><em>Sardinia</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Subquarters in Munich (called </font><font face="Arial" color="#000100" size="3"><strong><em>Munich</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A 15 x 15 regular grid (called </font><font face="Arial" color="#000100" size="3"><strong><em>Elevation</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Wards in West Yorkshire (UK) (called </font><font face="Arial" color="#000100" size="3"><strong><em>WestYorkshire</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A 4 x 4 regular grid (called </font><font face="Arial" color="#000100" size="3"><strong><em>Forest</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A grid of 750 m</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> grid cells covering the town of Huddersfield and surroundings in <br>&nbsp;&nbsp;&nbsp;northern England (called </font><font face="Arial" color="#000100" size="3"><strong><em>Huddersfield_750m_grid)</em></strong></font><font face="Arial" color="#000100" size="3"><br><br>A list of the area IDs for each map and the order in which the areas are stored in the map file can be obtained using the <a href="#Export"></font><font face="Arial" color="#0000FF" size="3"><u>export&nbsp;Splus</u></font><font face="Arial" color="#000100" size="3"></a> command. <br><br>GeoBUGS 1.2 also has facilities for importing user-defined maps reading polygon formats from </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Splus">Splus</a></u></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcInfo">ArcInfo</a></u></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Epimap">Epimap</a></u></font><font face="Arial" color="#000100" size="3">, plus a link to a program written by Yue Cui for importing </font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcView">ArcView</a></u></font><font face="Arial" color="#000100" size="3"> shape files. <br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Changes">Changes from GeoBUGS 1.1Beta</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> New distributions: <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;- spatial.disc<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;- pois.conv<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;- mv.car<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> New examples: <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">- spatial moving average model applied to forest biodiversity and disease mapping<br>&nbsp;&nbsp;&nbsp;examples <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">- multivariate spatial modelling using multivariate intrinsic CAR and shared component<br>&nbsp;&nbsp;&nbsp;models for mapping multiple diseases <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">- temporal smoothing of daily air pollution measurements using a random walk prior<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Problems and bugs fixed:<br>&nbsp;&nbsp;&nbsp;- no restriction on dimension of vector that can be fitted using the spatial.exp distribution <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when used in conjunction with spatial.exp.pred.uni (previously vector was restricted to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have length &lt; 100)<br>&nbsp;&nbsp;&nbsp;- maps can now be selected (using Ctrl-Space) from the map window and copied into other Windows documents (previously maps could only be copied from log window)</font><font face="Arial" color="#FF00FF" size="3"> </font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;- sum-to-zero constraint in car.normal and car.l1 distributions fixed (previous method for<br>&nbsp;&nbsp;&nbsp;imposing the constraint did not always give a mean of exactly zero) </font><font face="Arial" color="#FF00FF" size="3"></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Import">Importing map polygon files</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Polygon files can be imported into GeoBUGS from a variety of other packages:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Splus">Splus</a></u></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcInfo">ArcInfo</a></u></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Epimap">Epimap</a></u></font><font face="Symbol" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u><a href="#ArcView">ArcView</a></u></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Import files are text files containing:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Number of regions in the map<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> List of labels for each region, with corresponding ID number<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> List of x and y co-ordinates for each polygon, plus the polygon label</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3">The different GeoBUGS import formats are designed to follow as closely as possible the format in which Splus, ArcInfo and EpiMap export polygons, respectively. However, some manual editing of the polygon files exported from these various packages is also necessary before they can be read into GeoBUGS. <br><br>The following simple map is used to illustrate the different import formats. The map contains 3 areas (labelled area 1, area 2 and area 3); area 1 consists of 2 separate polygons, while areas 2 and 3 consist of one polygon each.<br><br></font><font face="Arial" color="#FF0000" size="2"><br><img src="geobugs manual1.bmp" alt="[geobugs manual1]"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Splus">Splus format</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map:3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">xScale: 1000<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">yScale: 1000</font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 area3<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 0 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 1 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 0 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 4 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 4 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 2 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 3 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 3 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">The Splus import file is in three parts:<br><br>The first line contains the key word 'map' (lower case) followed by a colon and an integer, N, where N is the number of distinct areas in the map (note that one area can consist of more than one polygon). <a id="xscale">The 2nd and 3rd lines are </font><font face="Arial" color="#000100" size="3"><em>optional</em></font><font face="Arial" color="#000100" size="3">, and can be used to specify the units for the map scale. By default, GeoBUGS assumes that the polygon coordinates are measured in metres. If the coordinates are measured in kilometres, say, then specify xScale and yScale to be 1000. GeoBUGS will then multiply all polygon co-ordinates by xScale and yScale as appropriate before storing the map file. If xScale and yScale are not specified, then the default units (metres) are assumed.</a><br><br>The next part of the import file is a 2 column list giving:<br><br>(column 1) the numeric ID of the area - this must be a unique integer between 1 and N; the areas should be labelled in the same order as the corresponding data for that area appears in the model.<br>(column 2) the area label - this must start with a character, and can be a maximum of 79 alphanumeric characters (no spaces allowed)<br><br>The final part of the import file is a 3 column list giving the co-ordinates of the polygons. The format is:<br><br>(col 1) the label of the area to which the polygon belongs<br>(col 2) x-coordinate<br>(col 3) y-xoordinate<br><br>The polygon coordinates can be listed either clockwise or anticlockwise. Polygons should be separated by a row of NA's<br><br>The import file should end with the key word: END<br><br>Note: Brad Carlin has a link on his web page to an Splus program called poly.S to extract polygons for any state in the United States in the appropriate format for loading into GeoBUGS (http://www.biostat.umn.edu/~brad/software.html)<br></font><font face="Arial" color="#000100" size="3"><strong><br><br><a id="ArcInfo">ArcInfo format</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map:3<br></font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xScale: 1000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yScale: 1000<br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 area3<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;210 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;211 area3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;210 0 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;211 0 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">The ArcInfo import file is in four parts:<br><br>The first 2 parts are the same as the Splus format. <br><br>The third part begins with a line containing the key word 'regions' (lower case). Below this is a 2 column list giving:<br><br>(column 1) an integer label corresponding to the integer label for one of the polygons listed in the final part of the import file. Each polygon should have a unique integer label, but this can be arbitrary (i.e. labels don't need to start at 1 or be consecutive). If using the ArcInfo command UNGENERATE to export a set of polygons, this is the integer label that ArcInfo automatically attaches to each polygon.<br>(column 2) the area label to which the polygon with that integer ID belongs. Note, if an area contains more than one polygon, then each polygon ID should be listed on a separate line and given the same area label (e.g., area1 in the above example).<br><br>There should be as many rows in this part of the file as there are polygons. This will be equal to or greater than the number of distinct areas in the map.<br><br>The final part of the import file gives the co-ordinates of the polygons. The format for each polygon is:<br><br>(row 1, column 1) the integer ID for the polygon (this should correspond to one of the integer IDs listed in the previous part of the import file).<br>(row 1, columns 2 and 3) if the polygon file has been exported directly from ArcInfo, these 2 numbers usually give the centroid of the polygon. However, they are not used by GeoBUGS, so can be arbitrary.<br>Subsequent rows contain a 2-column list of numbers giving the x- and y-coordinates of the poly. The polygon coordinates can be listed either clockwise or anticlockwise. <br><br>Polygons should be separated by a line containing the key word END.<br><br>The final row of the import file should also contain the key word END</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Epimap">Epimap format</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">map:3<br></font><font face="Arial" color="#FF0000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">xScale: 1000<br></font><font face="Arial" color="#FF0000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">yScale: 1000<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1 area1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2 area2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3 area3<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area1, 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1, 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area1, 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">4, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">4, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area2, 4 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area3, 4 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">END<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">The Epimap import file is in three parts:<br><br>The first 2 parts are the same as the Splus format. <br><br>The third gives the polygon co-ordinates. The format for each polygon is:<br><br>(row 1, column 1) the label of the area to which the polygon belongs.<br>(row 1, column 2) the number of vertices in the polygon (note the comma separator)<br>Subsequent rows contain a 2-column list of numbers giving the x- and y-coordinates of the poly, separated by a comma. The polygon coordinates can be listed either clockwise or anticlockwise. <br><br>The final row of the import file should contain the key word END<br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="ArcView">ArcView format</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS does not have an option for loading ArcView shape files directly. However, Ms Yue Cui at the University of Minnesota has written programs in Splus and R for converting shape files into the GeoBUGS Splus format so that they can be loaded in GeoBUGS (http://www.biostat.umn.edu/~yuecui/). </font><font face="Arial" color="#0000FF" size="3"><br><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Load">Loading a polygon file into GeoBUGS</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Open the polygon file as a separate text file in OpenBUGS and select the appropriate import option from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. (To try loading the example map files above, first copy them to a separate file, and focus the window containing this file). If the map has been loaded correctly, a </font><font face="Arial" color="#000100" size="3"><strong><em>Save As</em></strong></font><font face="Arial" color="#000100" size="3"> dialog box will appear, prompting you to enter a name for the map file. By default, the map file will be saved in the </font><font face="Courier" color="#000100" size="3">Maps/Rsrc</font><font face="Arial" color="#000100" size="3"> subdirectory of your OpenBUGS program, with a </font><font face="Courier" color="#000100" size="3">.map</font><font face="Arial" color="#000100" size="3"> extension. You can view this map by selecting </font><font face="Arial" color="#000100" size="3"><strong><em>Open</em></strong></font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#000100" size="3"><strong><em>File</em></strong></font><font face="Arial" color="#000100" size="3"> menu (go to the </font><font face="Courier" color="#000100" size="3">Maps/Rsrc</font><font face="Arial" color="#000100" size="3"> subdirectory and select file type: </font><font face="Courier" color="#000100" size="3">map file (*.map)</font><font face="Arial" color="#000100" size="3">. You will need to exit OpenBUGS and re-start before the new map will appear on the pull-down list of avaialble maps in the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> of the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. </font><font face="Arial" color="#0000FF" size="3"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Export">Exporting maps from GeoBUGS into Splus format</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Focus the window containing the map in GeoBUGS and select </font><font face="Arial" color="#000100" size="3"><strong><em>Export Splus</em></strong></font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. This will write the map in Splus format to a new window. This command can be used to obtain the list of area IDs and the order in which they are specified in the GeoBUGS map (see top part of export file).<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Adj">Producing adjacency matrices</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS includes an option to produce a data file containing the adjacency matrix for any map loaded on the system. This file is in a format required by the <a href="#car.normal"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>car.normal</u></em></strong></font><font face="Arial" color="#000100" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3">, <a href="#car.normal"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>car.l1</u></em></strong></font><font face="Arial" color="#000100" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3"> and <a href="#mv.car"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>mv.car</u></em></strong></font><font face="Arial" color="#000100" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3"> conditional autoregressive distributions available in the OpenBUGS program.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> option from the</font><font face="Arial" color="#000100" size="3"><strong><em> Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu.<br><br></font><font face="Arial" color="#000100" size="2"><img src="geobugs manual2.bmp" alt="[geobugs manual2]"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the name of the map you wish to draw from the pull-down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> and<br>&nbsp;&nbsp;&nbsp;click on </font><font face="Arial" color="#000100" size="3"><strong><em>adj map</em></strong></font><font face="Arial" color="#000100" size="3">. The selected map will then appear in a window.<br><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Typing the ID number of a region in the bottom white box and clicking </font><font face="Arial" color="#000100" size="3"><strong><em>shw region</em></strong></font><font face="Arial" color="#000100" size="3"> will<br>&nbsp;&nbsp;&nbsp;cause the specified region to be highlighted in red on the map; its neighbours (defined to<br>&nbsp;&nbsp;&nbsp;be any region adjacent to the red region) are highlighted in green. <a id="highlight">A region and its<br>&nbsp;&nbsp;&nbsp;neighbours can also be highlighted by positioning the mouse cursor over the required<br>&nbsp;&nbsp;&nbsp;region on the map and clicking with the left button.</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a text file containing the adjacency matrix in a<br>&nbsp;&nbsp;&nbsp;form suitable for loading as data into OpenBUGS for use with the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">and<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distributions. (See </font><font face="Arial" color="#0000FF" size="3"><a href="#Appendix">appendix 1</a></font><font face="Arial" color="#000100" size="3"> for further details about these three<br>&nbsp;&nbsp;&nbsp;distributions).<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Note: when calculating which areas are adjacent to which others, GeoBUGS includes a<br>&nbsp;&nbsp;&nbsp;'tolerance' zone of 0.1 metres. This tolerance zone should not lead to spurious neighbours<br>&nbsp;&nbsp;&nbsp;unless you forget to appropriately scale your distance units in the polygon file using the<br>&nbsp;&nbsp;&nbsp;<a href="#xscale"></font><font face="Arial" color="#0000FF" size="3"><u>xScale</u></font><font face="Arial" color="#000100" size="3"></a> and <a href="#xscale"></font><font face="Arial" color="#0000FF" size="3"><u>yScale</u></font><font face="Arial" color="#000100" size="3"></a> options, or your map covers a tiny geographic region (in<br>&nbsp;&nbsp;&nbsp;which case, artificially re-scaling the distance units for your map should overcome any<br>&nbsp;&nbsp;&nbsp;problems). <br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Edit">Editing adjacency matrices</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3">To remove a region from the set of neighbours for a specific area:<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#highlight"></font><font face="Arial" color="#0000FF" size="3"><u>Highlight</u></font><font face="Arial" color="#000100" size="3"></a> the specific area in red on the map;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Place the mouse cursor over the region to be removed from the set of neighbours for the<br>&nbsp;&nbsp;&nbsp;red area;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Hold down the Ctrl key while clicking with the left mouse button. The removed area will no<br>&nbsp;&nbsp;&nbsp;longer be highlighted in green.<br><br></font><font face="Arial" color="#0000FF" size="3">To add a region to the set of neighbours for a specific area:</font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#highlight"></font><font face="Arial" color="#0000FF" size="3"><u>Highlight</u></font><font face="Arial" color="#000100" size="3"></a> the specific area in red on the map;<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Place the mouse cursor over the region to be added to the set of neighbours for the <br>&nbsp;&nbsp;&nbsp;red area</font><font face="Symbol" color="#000100" size="2"><strong><br></strong></font><font face="Symbol" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Hold down the Ctrl key while clicking with the left mouse button. The additional area will<br>&nbsp;&nbsp;&nbsp;then become highlighted in green.<br><br>Once you have finished editing the set of neighbours for each region on your map, <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><u>create&nbsp;the&nbsp;new&nbsp;adjacency&nbsp;matrix</u></font><font face="Arial" color="#000100" size="3"></a> by clicking on the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> button.<br><br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="5"><strong><a id="Maps">Producing maps</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Note: in order to produce a map of the mean or other summary statistic of the posterior distribution of a stochastic variable, you must have already set a samples or summary monitor for that parameter and have carried out some updates.<br><br></font><font face="Arial" color="#0000FF" size="3">To produce a map:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>Mapping Tool</em></strong></font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu.<br><br><br></font><font face="Arial" color="#000100" size="2"><img src="geobugs manual3.bmp" alt="[geobugs manual3]"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the name of the map you wish to draw from the pull-down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Type the name of the variable to be mapped in the white box labelled</font><font face="Arial" color="#000100" size="3"><strong><em> Variable</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> If the variable is </font><font face="Arial" color="#000100" size="3"><em>data</em></font><font face="Arial" color="#000100" size="3"> (e.g. the raw SMR, expected counts E, or a covariate) pick the<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>value</em></strong></font><font face="Arial" color="#000100" size="3"> option in the pull down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Quantity</em></strong></font><font face="Arial" color="#000100" size="3"> and then click the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button: a map<br>&nbsp;&nbsp;&nbsp;shaded according to the values of the variable will now appear.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> If the variable is a</font><font face="Arial" color="#000100" size="3"><em> stochastic</em></font><font face="Arial" color="#000100" size="3"> quantity (e.g. the relative risks) there are various options<br>&nbsp;&nbsp;&nbsp;which you can select from the </font><font face="Arial" color="#000100" size="3"><strong><em>Quantity</em></strong></font><font face="Arial" color="#000100" size="3"> menu:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> if you have monitored the variable by setting a</font><font face="Arial" color="#000100" size="3"><em> summary monitor</em></font><font face="Arial" color="#000100" size="3">, then you must select<br>&nbsp;&nbsp;&nbsp;the </font><font face="Arial" color="#000100" size="3"><strong><em>mean(summary) </em></strong></font><font face="Arial" color="#000100" size="3">option from this menu, as only the posterior means are stored by the<br>&nbsp;&nbsp;&nbsp;summary monitor;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> if you have monitored the variable by setting a </font><font face="Arial" color="#000100" size="3"><em>samples monitor</em></font><font face="Arial" color="#000100" size="3"> (which stores the full<br>&nbsp;&nbsp;&nbsp;posterior sample), you can select any of the remaining options from the Quantity menu:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>mean(sample)</em></strong></font><font face="Arial" color="#000100" size="3"> will map the posterior means of the variable;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>percentile</em></strong></font><font face="Arial" color="#000100" size="3"> will plot posterior quantiles of the variable - if you select this option, you must<br>&nbsp;&nbsp;&nbsp;then type the required percentile in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>quantile</em></strong></font><font face="Arial" color="#000100" size="3">; <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>prob greater </em></strong></font><font face="Arial" color="#000100" size="3">will map the posterior probability that the value of the variable is greater than<br>&nbsp;&nbsp;&nbsp;or equal to the specified threshold, which you must type in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>threshold</em></strong></font><font face="Arial" color="#000100" size="3">;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>prob less</em></strong></font><font face="Arial" color="#000100" size="3"> will map the posterior probability that the value of the variable is less than or<br>&nbsp;&nbsp;&nbsp;equal to the specified threshold, which you must type in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>threshold</em></strong></font><font face="Arial" color="#000100" size="3">;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">When you have selected the quantity you want to map, click the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to display the<br>&nbsp;&nbsp;&nbsp;map. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The numbers in brackets shown on the map legend give the number of areas classified in<br>&nbsp;&nbsp;&nbsp;each category on the map.<br><br>Fig 1. GeoBUGS map of SMRs for Scottish Lip Cancer data (see <a href="#Lips"></font><font face="Arial" color="#0000FF" size="3"><u>Examples</u></font><font face="Arial" color="#000100" size="3"></a> section for further details)<br><br><br></font><font face="Arial" color="#000100" size="2"><img src="geobugs manual4.bmp" alt="[geobugs manual4]"><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Cuts">User-specified cut-points and shading</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS can work with two kinds of cut-points: absolute value cut-points and percentile cut-points. For absolute cut-points, GeoBUGS chooses a default set of breaks based on the absolute value of the variable to be mapped: these are chosen to give equally spaced intervals. For percentile cutpoints, GeoBUGS chooses the 10th, 50th and 90th percentiles of the empirical distribution of the variable to be mapped. The default shading is blue-scale. <br><br></font><font face="Arial" color="#0000FF" size="3">To edit the colours for shading the map:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>custom</em></strong></font><font face="Arial" color="#000100" size="3"> option from the</font><font face="Arial" color="#000100" size="3"><strong><em> Palette</em></strong></font><font face="Arial" color="#000100" size="3"> menu in the top right of the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Clicking with the left mouse button on the arrow by each colour will bring up a menu of<br>&nbsp;&nbsp;&nbsp;alternative colours that can be selected.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> After you have selected the new colour scheme, click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button to &quot;refresh&quot;<br>&nbsp;&nbsp;&nbsp;the currently selected map or click on the</font><font face="Arial" color="#000100" size="3"><strong><em> plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a new map.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> To reset the colour scheme to blue shades, select </font><font face="Arial" color="#000100" size="3"><strong><em>blues</em></strong></font><font face="Arial" color="#000100" size="3"> from the Palette menu and click<br>&nbsp;&nbsp;&nbsp;on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts </em></strong></font><font face="Arial" color="#000100" size="3">button again. <br><br></font><font face="Arial" color="#0000FF" size="3">To edit the absolute value cutpoints:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the required number of cutpoints (a maximum of 6 cutpoints is currently allowed)<br>&nbsp;&nbsp;&nbsp;from the menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>num cuts</em></strong></font><font face="Arial" color="#000100" size="3"> under the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts</em></strong></font><font face="Arial" color="#000100" size="3"> menu. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Type the required values of the cutpoints in the appropriate boxes labelled cut 1, cut 2<br>&nbsp;&nbsp;&nbsp;etc.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button to &quot;refresh&quot; the currently selected map or click on the </font><font face="Arial" color="#000100" size="3"><strong><em>plot<br>&nbsp;&nbsp;&nbsp;</em></strong></font><font face="Arial" color="#000100" size="3">button to produce a new map.<br><br></font><font face="Arial" color="#0000FF" size="3">To produce maps using cutpoints based on percentiles:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>percentile</em></strong></font><font face="Arial" color="#000100" size="3"> option rather than </font><font face="Arial" color="#000100" size="3"><strong><em>abs value</em></strong></font><font face="Arial" color="#000100" size="3"> option for the cutpoints on the left of<br>&nbsp;&nbsp;&nbsp;the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a new map. The default is to set the cutpoints to the<br>&nbsp;&nbsp;&nbsp;10th, 50th and 90th percentiles of the empirical distribution of values to be mapped.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> To display the absolute values corresponding to these percentiles on the map legend:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> reselect the </font><font face="Arial" color="#000100" size="3"><strong><em>abs value</em></strong></font><font face="Arial" color="#000100" size="3"> option for cutpoints;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> click on the </font><font face="Arial" color="#000100" size="3"><strong><em>get cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the absolute values corresponding to the percentiles should<br>&nbsp;&nbsp;&nbsp;now be displayed in the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts</em></strong></font><font face="Arial" color="#000100" size="3"> boxes on the right of the</font><font face="Arial" color="#000100" size="3"><strong><em> Map Tool</em></strong></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the legend labels on the map should now display the<br>&nbsp;&nbsp;&nbsp;absolute values of the cutpoints.<br><br></font><font face="Arial" color="#0000FF" size="3">To use the same set of cutpoints for multiple maps:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the window with the map containing the cutpoints you wish to use.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the</font><font face="Arial" color="#000100" size="3"><strong><em> get cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the cutpoints used for the selected map should now be<br>&nbsp;&nbsp;&nbsp;displayed in the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts </em></strong></font><font face="Arial" color="#000100" size="3">boxes on the right of the</font><font face="Arial" color="#000100" size="3"><strong><em> Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the window with the map whose cutpoints you wish to change.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the map should now be updated using the new cutpoints.<br><br></font><font face="Arial" color="#FF0000" size="3">Some current limitations:</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> It is not possible to save user-defined colour schemes once you quit GeoBUGS.<br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Identify">Identifying individual areas on a map</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>The index, label and value of an individual area on the map can be found by placing the cursor over the area of interest on the map and clicking with the left mouse button. The index (i.e. ID number i of the area, where i=1,...,Number of areas), area label (given in the polygon file) and value of variable currently being mapped for the selected area will be shown in left of the grey bar at the bottom of the WinBUGS program window.<br><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Save">Copying and saving maps</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Maps produced using the GeoBUGS map tool can be copied and pasted into other Microsoft Windows software such as Word and PowerPoint. To select the map, click anywhere on the map window to focus it, </font><font face="Arial" color="#FF00FF" size="3">then press the Ctrl and Space keys simultaneouly (CHECK WITH ANDREW) </font><font face="Arial" color="#000100" size="3">(a blue border should then appear around the figure); then select 'Copy' from the 'Edit' menu (or Crtl-C). Then paste into the appropriate Word or PowerPoint file etc. To save the map as a postscript file, you will need to install a postscript print driver on your PC, then select 'Print' from the 'File' menu, check the 'print to file' box, and then select 'Print'. You can also save the maps as OpenBUGS .odc documents; this will allow you to re-open the map within OpenBUGS and re-edit the cutpoints and colours if you wish.<br><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Spatial">Spatial distributions</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>See <a href="#Appendix"></font><font face="Arial" color="#0000FF" size="3">appendices</a></font><font face="Arial" color="#000100" size="3"> for further tecnhical details about the various spatial distributions implemented in GeoBUGS 1.2.</font><font face="Arial" color="#000100" size="3"><strong><br><br>&nbsp;&nbsp;&nbsp;<a id="car.normal"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"><strong> and </strong></font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="3"><br><br>The intrinsic Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random varables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> ). </sub></font><font face="Arial" color="#000100" size="3">A robust version of this model is available, which assumes a double exponential (Laplace) rather than Gaussian distribution: this is called</font><font face="Arial" color="#000100" size="3"><strong><em> car.l1</em></strong></font><font face="Arial" color="#000100" size="3">. The syntax for these distributions is as follows:<br><br>S[1:N] ~ car.normal(adj[], weights[], num[], tau)<br>S[1:N] ~ car.l1(adj[], weights[], num[], tau)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas. For the CAR model described above, taking C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 (equivalently W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/ n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ) if areas i and j are neighbours and 0 otherwise, gives a vector of 1's for </font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar argument representing the precision (inverse variance) parameter of the Gaussian CAR prior, or the inverse scale parameter of the Laplace prior (for the latter model, the variance = 2 / tau</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">).<br><br>The first 3 arguments must be entered as data (it is currently not possible to allow the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> to be unknown); the final variable </font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> is usually treated as unknown and so is assigned a prior distribution. The data variables </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><u>above</u></font><font face="Arial" color="#000100" size="3"></a>. The variable</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> must be created by the user, and must be a vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">. A common choice is to set all the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">equal to 1 since this gives the standard Besag, York and Mollie (1991) CAR model (see section on <a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3"><u>intrinsic&nbsp;CAR&nbsp;models</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1 for further discussion of weights). The easiest way to do this is to create a loop in your </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> model code:<br><br>for(j in 1:sumNumNneigh) { weights[j] &lt;- 1}<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>sumNumNneigh</em></strong></font><font face="Arial" color="#000100" size="3"> is the length of </font><font face="Arial" color="#000100" size="3"><strong><em>adj </em></strong></font><font face="Arial" color="#000100" size="3">and is also output by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS </em></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> .<br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">The</font><font face="Arial" color="#000100" size="3"><strong><em> car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions use </font><font face="Arial" color="#FF0000" size="3">unnormalised</font><font face="Arial" color="#000100" size="3"> weights (see section on<br>&nbsp;&nbsp;&nbsp;<a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3"><u>intrinsic&nbsp;CAR&nbsp;models</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1).<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the<br>&nbsp;&nbsp;&nbsp;area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The weights must be </font><font face="Arial" color="#FF0000" size="3">symmetric</font><font face="Arial" color="#000100" size="3"> ( W</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="3"><sub>ji </sub></font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a check for this<br>&nbsp;&nbsp;&nbsp;and returns an error message if non-symmetric weights are detected.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on tau, and be prepared to carry out sensitivity analysis to this<br>&nbsp;&nbsp;&nbsp;choice.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The car.normal and car.l1 distributions are parameterised to include a </font><font face="Arial" color="#FF0000" size="3">sum-to-zero<br>&nbsp;&nbsp;&nbsp;constraint</font><font face="Arial" color="#000100" size="3"> on the random effects. This means that you must also include a </font><font face="Arial" color="#FF0000" size="3">separate<br>&nbsp;&nbsp;&nbsp;intercept </font><font face="Arial" color="#000100" size="3">term in your model, which MUST be assigned an improper uniform prior using the<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> distribution.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Because the car.normal and car.l1 distributions are improper, they can only be used as<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">prior</font><font face="Arial" color="#000100" size="3"> distributions, and not as a likelihood.<br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="car.proper"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>car.proper</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="3"><br><br>The proper Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random variables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> ). </sub></font><font face="Arial" color="#000100" size="3">The syntax for this distributions is as follows:<br><br>S[1:N] ~ car.proper(mu[], C[], adj[], num[], M[], tau, gamma)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector giving the mean for each area (this can either be entered as data, assigned a prior distribution, or specified deterministically within the model code).<br></font><font face="Arial" color="#000100" size="3"><strong><em>C[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>normalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas (see sections on <a href="#Conditional"></font><font face="Arial" color="#0000FF" size="3"><u>conditional&nbsp;specification</u></font><font face="Arial" color="#000100" size="3"></a> and <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><u>proper&nbsp;CAR&nbsp;priors</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1). Note that this differs from the intrinsic </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions, where unnormalised weights should be specified. <br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>M[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N giving the diagonal elements M</font><font face="Arial" color="#000100" size="3"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> of the conditional variance matrix (see sections on <a href="#Conditional"></font><font face="Arial" color="#0000FF" size="3"><u>conditional&nbsp;specification</u></font><font face="Arial" color="#000100" size="3"></a> and <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><u>proper&nbsp;CAR&nbsp;priors</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1)<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall precision (inverse variance) parameter.<br></font><font face="Arial" color="#000100" size="3"><strong><em>gamma</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall degree of spatial dependence. This parameter is constrained to lie between bounds given by the inverse of the minimum and maximum eigenvalues of the matrix </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"><sup>-</sup></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(see <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><u>appendix</a>&nbsp;1</u></font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS 1.2</em></font><font face="Arial" color="#000100" size="3"> contains two deterministic functions for calculating these bounds (or they can be calculated externally to </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> and input by the user):<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">min.bound(C[], adj[], num[], M[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">max.bound(C[], adj[], num[], M[])<br><br>where the arguments are the same as the corresponding vectors used as arguments to the </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper</em></strong></font><font face="Arial" color="#000100" size="3"> distribution. <br><br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper </em></strong></font><font face="Arial" color="#000100" size="3">distribution:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>M</em></strong></font><font face="Arial" color="#000100" size="3"> must be entered as data (it is currently not possible to allow </font><font face="Arial" color="#000100" size="3"><strong><em>C </em></strong></font><font face="Arial" color="#000100" size="3">to be<br>&nbsp;&nbsp;&nbsp;unknown); </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><u>above</u></font><font face="Arial" color="#000100" size="3"></a>. The <a href="#Lips"></font><font face="Arial" color="#0000FF" size="3"><u>Lips example</u></font><font face="Arial" color="#000100" size="3"></a> shows a (slightly<br>&nbsp;&nbsp;&nbsp;clumsy) way of creating the </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>M</em></strong></font><font face="Arial" color="#000100" size="3"> vectors within the WinBUGS model code;<br>&nbsp;&nbsp;&nbsp;alternatively, these can be created externally to </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> and read in as data.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The</font><font face="Arial" color="#000100" size="3"><strong><em> car.proper </em></strong></font><font face="Arial" color="#000100" size="3">distribution uses </font><font face="Arial" color="#FF0000" size="3">normalised</font><font face="Arial" color="#000100" size="3"> weights </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3"> (see section on<br>&nbsp;&nbsp;&nbsp;<a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><u>proper&nbsp;CAR&nbsp;priors</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1).<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the<br>&nbsp;&nbsp;&nbsp;area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#FF0000" size="3">symmetry constraint</font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="3"><sub>jj</sub></font><font face="Arial" color="#000100" size="3"> = C</font><font face="Arial" color="#000100" size="3"><sub>ji </sub></font><font face="Arial" color="#000100" size="3">M</font><font face="Arial" color="#000100" size="3"><sub>ii </sub></font><font face="Arial" color="#000100" size="3">must be satisfied. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a<br>&nbsp;&nbsp;&nbsp;check for this and returns an error message if lack of symmetry is detected.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on tau, and be prepared to carry out sensitivity analysis to this<br>&nbsp;&nbsp;&nbsp;choice.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on gamma: you must ensure that the prior is constrained between<br>&nbsp;&nbsp;&nbsp;the appropriate bounds. Besag, York and Mollie (1991) suggest that gamma needs to be<br>&nbsp;&nbsp;&nbsp;close to its upper bound before it reflects reasonable spatial dependence, so you may<br>&nbsp;&nbsp;&nbsp;want to try informative priors to represent this, and be prepared to carry out sensitivity<br>&nbsp;&nbsp;&nbsp;analysis.<br></font><font face="Arial" color="#000100" size="2"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="spatial.exp"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp </em></strong></font><font face="Arial" color="#000100" size="3"><strong>and </strong></font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Bayesian Gaussian kriging models (multivariate Gaussian distribution with covariance matrix expressed as a parametric function of distance between pairs of points - e.g. see Diggle, Tawn and Moyeed, 1998 and <a href="#Appendix"></font><font face="Arial" color="#0000FF" size="3"><u>Appendix</u></font><font face="Arial" color="#000100" size="3"></a></font><font face="Arial" color="#0000FF" size="3"><u>&nbsp;1</u></font><font face="Arial" color="#000100" size="3">) can be specified using the distributions </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp </em></strong></font><font face="Arial" color="#000100" size="3">or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random variables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">).</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">The syntax for this distributions is as follows: <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi, kappa)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S[1:N] ~ spatial.disc(mu[], x[], y[], tau, alpha)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector giving the mean for each area (this can either be entered as data, assigned a prior distribution, or specified deterministically within the model code).<br></font><font face="Arial" color="#000100" size="3"><strong><em>x[] </em></strong></font><font face="Arial" color="#000100" size="3">and </font><font face="Arial" color="#000100" size="3"><strong><em>y[] </em></strong></font><font face="Arial" color="#000100" size="3">: Vectors of length N giving the x and y coordinates of the location of each point, or the centroid of each area<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall precision (inverse variance) parameter.<br><br>Two options are available for specifying the form of the covariance matrix: the powered exponential function and the 'disc' function (see section on </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Joint">Joint&nbsp;Specification</a></u></font><font face="Arial" color="#000100" size="3"> in Appendix 1). <br><br>The </font><font face="Arial" color="#000100" size="3"><strong><em>powered exponential function</em></strong></font><font face="Arial" color="#000100" size="3"> is implemented using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> distribution and has 2 parameters:<br></font><font face="Arial" color="#000100" size="3"><strong><em>phi</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the rate of decline of correlation with distance between points. </font><font face="Arial" color="#000100" size="3"><em>Note that the magnitude of this parameter will depend on the units in which the x and y coordinates of each location are measured (e.g. metres, km etc.). </em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><em>kappa</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter controlling the amount of spatial smoothing. This is constrained to lie in the interval [0, 2). <br><br>The </font><font face="Arial" color="#000100" size="3"><strong><em>disc function</em></strong></font><font face="Arial" color="#000100" size="3"> is implemented using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> distribution and has 1 parameter:<br></font><font face="Arial" color="#000100" size="3"><strong><em>alpha</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the radius of the 'disc' centred at each (x, y) location. </font><font face="Arial" color="#000100" size="3"><em>Note that the magnitude of this parameter will depend on the units in which the x and y coordinates of each location are measured (e.g. metres, km etc.). </em></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><strong>Warning:</strong></font><font face="Arial" color="#000100" size="3"> These models can be very </font><font face="Arial" color="#FF0000" size="3"><em>slow</em></font><font face="Arial" color="#000100" size="3"> for even moderate sized datasets (the algorithm is of order N</font><font face="Arial" color="#000100" size="2"><sup>3</sup></font><font face="Arial" color="#000100" size="3">)! Experience to date also suggests that it may be better to </font><font face="Arial" color="#FF0000" size="3"><em>hierarchically centre</em></font><font face="Arial" color="#000100" size="3"> this model. For example, consider the following two alternative parameterisations of the same model:</font><font face="Courier New" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>Non-hierarchically centred<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dnorm(S[i], gamma) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i] &lt;- alpha+beta*z[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi,1)</font><font face="Arial" color="#000100" size="3"><br><br>Hierarchically centred <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dnorm(S[i], gamma) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[i] &lt;- alpha+beta*z[i] + W[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i]&lt;-0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">W[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi,1)</font><font face="Arial" color="#000100" size="3"><br><br>In some simulated examples, the non-hierarchically centred parameterisation has produced incorrect results, while the hierarchically centred parameterisation gives sensible answers. This may be a feature of the single-site updating schemes used in WinBUGS, so interpret your results with care!<br>(Thanks to Alan Gelfand, Shanshan Wu and Alex Schmidt for noting this problem).<br><br>Experience also suggests that there is often very little information in the data about the values of the parameters of the powered exponential (i.e. phi and kappa) or disc (i.e. alpha) functions. We therefore recommend that reasonably informative priors are used, or that the values are fixed a priori, based on either substantive knowledge or exploratory analysis using e.g. variograms. <br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="spatial.exp.pred"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>spatial.pred </em></strong></font><font face="Arial" color="#000100" size="3"><strong>and</strong></font><font face="Arial" color="#000100" size="3"><strong><em> spatial.unipred</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Spatial interpolation or prediction at arbitrary locations can be carried out using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.pred</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.unipred</em></strong></font><font face="Arial" color="#000100" size="3"> functions, in conjunction with fitting either the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> model to a set of observed data. </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.pred</em></strong></font><font face="Arial" color="#000100" size="3"> carries out joint or simultaneous prediction at a set of target locations, whereas </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.unipred</em></strong></font><font face="Arial" color="#000100" size="3"> carries out single site prediction. The difference is that the single site prediction yields marginal prediction intervals (i.e. ignoring correlation between prediction locations) whereas joint prediction yields simultaneous prediction intervals for the set of target locations (which will tend to be narrower than the marginal prediction intervals). The predicted means should be the same under joint or single site prediction. The disadvantage of joint prediction is that it is very slow (the computational time is of order P</font><font face="Arial" color="#000100" size="2"><sup>3</sup></font><font face="Arial" color="#000100" size="3">, where P is the number of prediction sites). The syntax for these predictive distributions is:<br><br>Joint prediction:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">T[1:P] ~ spatial.pred(mu.T[], x.T[], y.T[], S[])<br><br>Single site prediction:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:P) {<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">T[j] ~ spatial.unipred(mu.T[j], x.T[j], y.T[j], S[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>P</em></strong></font><font face="Arial" color="#000100" size="3"> : Scalar giving the number of prediction locations<br></font><font face="Arial" color="#000100" size="3"><strong><em>mu.T[]</em></strong></font><font face="Arial" color="#000100" size="3"> : vector of length P (or scalar for single site version) specifying the mean for each prediction location (this should be specified in the same way as the mean for the observed data S).<br></font><font face="Arial" color="#000100" size="3"><strong><em>x.T[] </em></strong></font><font face="Arial" color="#000100" size="3">and </font><font face="Arial" color="#000100" size="3"><strong><em>y.T[] </em></strong></font><font face="Arial" color="#000100" size="3">: Vectors of length P (or scalars for single site version) giving the x and y coordinates of the location of each prediction point<br></font><font face="Arial" color="#000100" size="3"><strong><em>S</em></strong></font><font face="Arial" color="#000100" size="3"> : The vector of observations to which either the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> model has been fitted.<br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="pois.conv"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>pois.conv</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A conjugate Poisson-gamma spatial moving average distribution can be specified for non-negative counts defined on a spatial lattice (i.e. discrete geographical partition), using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>pois.conv</em></strong></font><font face="Arial" color="#000100" size="3">. This is a discrete version of the Poisson-gamma random field model of Wolpert and Ickstadt (1998) and Best et al (2000a). The basic syntax for this distribution is as follows: </font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S ~ dpois.conv(mu[])&nbsp;&nbsp;&nbsp;<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>S</em></strong></font><font face="Arial" color="#000100" size="3"> is a non-negative </font><font face="Arial" color="#000100" size="3"><em>scalar</em></font><font face="Arial" color="#000100" size="3"> parameter defined at some (usually spatial) location, and </font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> is a </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of length J representing the influence of a set of gamma distributed latent parameters at each of J different locations on the value of S. Hence </font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> must be defined as a convolution of gamma random variables:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (j in 1 : J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[j] &lt;- gamma[j] * k[j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">gamma[j] </font><font face="Arial" color="#000100" size="3">~ dgamma(a, b)</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="3"><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>k[j]</em></strong></font><font face="Arial" color="#000100" size="3"> is a spatial kernel or spatial 'weight' depending on some measure of distance or spatial proximity between the jth latent location and the location of S, and </font><font face="Arial" color="#000100" size="3"><strong><em>a</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>b</em></strong></font><font face="Arial" color="#000100" size="3"> are hyperparameters to be specified (see </font><font face="Arial" color="#000100" size="3"><a href="#Appendix 2"></font><font face="Arial" color="#0000FF" size="3"><u>Appendix&nbsp;2</u></font><font face="Arial" color="#000100" size="3"></a> for further discussion of this distribution, including suitable kernel functions). Usually, </font><font face="Arial" color="#000100" size="3"><strong><em>k[]</em></strong></font><font face="Arial" color="#000100" size="3"> is calculated externally and read into WinBUGS as data; alternatively, if k[] depends on unknown parameters, it may be defined as part of the BUGS code and re-computed at each MCMC iteration. However, this is likely to slow down the sampling within WinBUGS by many orders of magnitude, so is not recommended for models with large numbers of latent parameters (i.e. J large).<br><br>More typically, the distribution will be used for each element of a </font><font face="Arial" color="#000100" size="3"><em>vector</em></font><font face="Arial" color="#000100" size="3"> of counts defined on a spatial lattice of N regions, using the following syntax:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[i] ~ dpois.conv(mu[i, ])&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (j in 1 : J) { </font><font face="Arial" color="#00FF00" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu[i, j] &lt;- gamma[j] * k[i, j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>where the latent gamma[j] parameters are defined as above, and k[,] is now an N x J matrix with elements k[i,j] representing the 'weight' or contribution of the latent gamma random variable at location j to the expected value of S at location i. <br><br>Conditional on mu, the S[i] have independent Poisson distributions with mean = </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="3"><sub>j </sub></font><font face="Arial" color="#000100" size="3">mu[i, j]. <br><br>Note that the model may be extended to include observed covariates as well as latent variables in the Poisson mean - see <a href="#saviah"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;6</u></font><font face="Arial" color="#000100" size="3"></a>.<br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="mv.car"></strong></font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>The multivariate intrinsic Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> for the p x N </font><font face="Arial" color="#000100" size="3"><em>matrix </em></font><font face="Arial" color="#000100" size="3">of random varables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> , where columns of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> represent the spatial units (areas) and rows represent the variables (it is important to ensure the dimensions of S are specified the correct way round). The syntax for this distribution is as follows:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[1:p, 1:N] ~ mv.car(adj[], weights[], num[], omega[ , ])<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas. For the CAR model described above, taking C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 (equivalently W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/ n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ) if areas i and j are neighbours and 0 otherwise, gives a vector of 1's for </font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>omega[ , ]</em></strong></font><font face="Arial" color="#000100" size="3"> : A p x p matrix representing the precision (inverse variance) matrix of the multivariate intrinsic Gaussian CAR prior.<br><br>The first 3 arguments must be entered as data (it is currently not possible to allow the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> to be unknown); the final variable </font><font face="Arial" color="#000100" size="3"><strong><em>omega</em></strong></font><font face="Arial" color="#000100" size="3"> is usually treated as unknown and so is assigned a prior distribution (which must be a Wishart distribution). The data variables </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><u>above</u></font><font face="Arial" color="#000100" size="3"></a>. The variable</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> must be created by the user, and must be a vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">. A common choice is to set all the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">equal to 1 since this gives the multivariate equivalent of the standard Besag, York and Mollie (1991) CAR model (see sections on <a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3"><u>intrinsic&nbsp;CAR&nbsp;models</u></font><font face="Arial" color="#000100" size="3"></a> and <a href="#MV"></font><font face="Arial" color="#0000FF" size="3"><u>multivariate&nbsp;intrinsic&nbsp;CAR&nbsp;models</u></font><font face="Arial" color="#000100" size="3"></a> in Appendix 1 for further discussion of weights). The easiest way to do this is to create a loop in your </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> model code:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:sumNumNneigh) { weights[j] &lt;- 1}<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>sumNumNneigh</em></strong></font><font face="Arial" color="#000100" size="3"> is the length of </font><font face="Arial" color="#000100" size="3"><strong><em>adj </em></strong></font><font face="Arial" color="#000100" size="3">and is also output by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS </em></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> .<br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution:<br><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The</font><font face="Arial" color="#000100" size="3"><strong><em> mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution uses </font><font face="Arial" color="#FF0000" size="3">unnormalised</font><font face="Arial" color="#000100" size="3"> weights, as for the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> distribtion.<br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The weights must be </font><font face="Arial" color="#FF0000" size="3">symmetric</font><font face="Arial" color="#000100" size="3"> ( W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>ji</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a check for this and returns an error message if non-symmetric weights are detected.<br></font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on </font><font face="Arial" color="#000100" size="3"><strong><em>omega</em></strong></font><font face="Arial" color="#000100" size="3">, and be prepared to carry out sensitivity analysis to this choice.<br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution is parameterised to include a </font><font face="Arial" color="#FF0000" size="3">sum-to-zero constraint</font><font face="Arial" color="#000100" size="3"> on the random effects. This means that you must also include </font><font face="Arial" color="#FF0000" size="3">separate intercept </font><font face="Arial" color="#000100" size="3">terms in your model for each of the p variables, which MUST be assigned improper uniform priors using the </font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> distribution. </font><font face="Arial" color="#000100" size="3"><em>Note: the mechanism for implementing the sum-to-zero constraint for mv.car in WinBUGS has been tested and appears to be robust; however, we recommend that you nevertheless include a check in your model code to ensure that the constraint has been implemented correctly (e.g. by including a line in your code to calculate the mean across areas of each variable for which the mv.car prior has been assumed). Please report any problems to n.best@imperial.ac.uk. </em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> An alternative </font><font face="Arial" color="#FF0000" size="3">unconstrained</font><font face="Arial" color="#000100" size="3"> version of the multivariate CAR prior is available in WinBUGS 1.4, called </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car.uncon</em></strong></font><font face="Arial" color="#000100" size="3">. The syntax is the same as for mv.car. <br></font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Because the </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> (and </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car.uncon</em></strong></font><font face="Arial" color="#000100" size="3">) distribution is improper, it can only be used as a </font><font face="Arial" color="#FF0000" size="3">prior</font><font face="Arial" color="#000100" size="3"> distribution, and not as a likelihood. <br><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Temporal">Temporal distributions</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="rw"></strong></font><font face="Arial" color="#FF0000" size="3"><strong><em>&nbsp;&nbsp;&nbsp;</em></strong></font><font face="Arial" color="#000100" size="3"><strong><em>Using car.normal as a random walk prior for temporal smoothing</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>In one dimension, the intrinsic Gaussian CAR distribution reduces to a Gaussian random walk (see e.g.Fahrmeir and Lang, 2001). Assume we have a set of temporally correlated random effects </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">, t=1,..., T (where T is the number of equally-spaced time points). In the simplest case of a random walk of order 1, RW(1), we may write<br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/2, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 2 ) for t = 2, ...., T-1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>where </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denotes all elements of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">except the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">. This is equivalent to specifying <br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( S</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Symbol" color="#000100" size="3"> q</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3">) for t = 1, ..., T<br><br>where C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> / W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">, W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> and W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 1 if k = (t-1) or (t+1) and 0 otherwise; M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3"> = 1/W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">. Hence the RW(1) prior may be fitted using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution in WinBUGS, with appropriate specification of the weight and adjacency matrices, and num vector (see <a href="#air.pollution"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;9</u></font><font face="Arial" color="#000100" size="3"></a>) </font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3"><br>A second order random walk prior is defined as<br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">(2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">)/5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = 2 <br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">)/6, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 6 ) for t = 3, ...., T-2<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ 4q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = T-1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( -q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>Again this is equivalent to specifying <br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( S</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Symbol" color="#000100" size="3"> q</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3">) for t = 1, ..., T<br><br>where C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> is defined as above, but this time with W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">1 if k = (t-2) or (t+2), W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 4 if k = (t-1) or (t+1) and t in (3, T-2), W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 2 if k = (t-1) or (t+1) and t = 2 or T-1, W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise; M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3"> = 1/W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">. <br><br>Note that if the observed time points are not equally spaced, it is necessary to include missing values (NA) for the intermediate time points (see <a href="#air.pollution"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;9</u></font><font face="Arial" color="#000100" size="3"></a>). <br><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Examples">Examples</a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#0000FF" size="3">]</font><font face="Arial" color="#000100" size="5"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3"><strong><a id="Lips">1. Conditional Autoregressive (CAR) models for disease mapping: Lip cancer in Scotland</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="2">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="2"><u>top</a></u></font><font face="Arial" color="#000100" size="2">]</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">The rates of lip cancer in 56 counties in Scotland have been analysed by Clayton and Kaldor (1987) and Breslow and Clayton (1993). The form of the data includes the observed and expected cases (expected numbers based on the population and its age and sex distribution in the county), a covariate measuring the percentage of the population engaged in agriculture, fishing, or forestry, and the &quot;position'' of each county expressed as a list of adjacent counties.<br><br><img src="geobugs manual5.bmp" alt="[geobugs manual5]">We note that the extreme SMRs (Standardised Mortality Ratios) are based on very few cases.<br><br>We may smooth the raw SMRs by fitting a random-effects Poisson model allowing for spatial correlation, using the intrinsic conditional autoregressive (CAR) prior proposed by Besag, York and Mollie (1991). For the lip cancer example, the model may be written as:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">O</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">=&nbsp;&nbsp;&nbsp;og E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> / 10 + </font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3"><br>where </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> is an intercept term representing the baseline (log) relative risk of disease across the study region, x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the covariate &quot;percentage of the population engaged in agriculture, fishing, or forestry&quot; in district i, with associated regression coefficient </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is an area-specific random effect capturing the residual or unexplained (log) relative risk of disease in area i. We often think of b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> as representing the effect of latent (unobserved) risk factors. <br><br>To allow for spatial dependence between the random effects b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> in nearby areas, we may assume a CAR prior for these terms. Technical details, including parameterisation and a discussion of suitable hyperpriors for the parameters of this model, are given in </font><font face="Arial" color="#0000FF" size="3"><a href="#Appendix"></font><font face="Arial" color="#0000FF" size="3"><u>appendix&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">. The </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#car.normal"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>car.normal</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000100" size="3"> distribution may be used to fit this model. The code for the lip cancer data is given below:<br><br></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">O[i] ~ dpois(mu[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">log(mu[i]) &lt;- log(E[i]) + alpha0 + alpha1 * X[i]/10 + b[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Area-specific relative risk (for maps)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">RR[i] &lt;- exp(alpha0 + alpha1 * X[i]/10 + b[i]) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># CAR prior distribution for random effects: </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">b[1:N] ~ car.normal(adj[], weights[], num[], tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(k in 1:sumNumNeigh) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;weights[k] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors:</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha0 ~ dflat() <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha1 ~ dnorm(0.0, 1.0E-5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.5, 0.0005) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior on precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- sqrt(1 / tau)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# standard deviation<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#0000FF" size="3">Data </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ScotlandData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000000" size="3"><br>Note that the data for the adjacency matrix (variables </font><font face="Arial" color="#000000" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000000" size="3">, </font><font face="Arial" color="#000000" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000000" size="3"> and </font><font face="Arial" color="#000000" size="3"><strong><em>SumNumNeigh</em></strong></font><font face="Arial" color="#000000" size="3">) have been generated using the <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>adj&nbsp;matrix</u></em></strong></font><font face="Arial" color="#000000" size="3"></a> option of the </font><font face="Arial" color="#000000" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000000" size="3"> menu in </font><font face="Arial" color="#000000" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000000" size="3">. By default, this treats islands as having no neighbours, and so the three areas representing the Orkneys, Shetland and the Outer Hebrides islands in Scotland have zero neighbours. You can <a href="#Edit"></font><font face="Arial" color="#0000FF" size="3"><u>edit</u></font><font face="Arial" color="#000000" size="3"></a> the adjacency map of Scotland to include these areas as neighbours if you wish. The </font><font face="Arial" color="#000000" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000000" size="3"> distribution sets the value of b</font><font face="Arial" color="#000000" size="3"><sub>i</sub></font><font face="Arial" color="#000000" size="3"> equal to zero for areas i that are islands. Hence the posterior relative risks for the Orkneys, Shetland and the Outer Hebrides in the present example will just depend on the overall baseline rate </font><font face="Arial" color="#000100" size="3"></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> and the covariate x</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. Alternatively, you could specify a </font><font face="Arial" color="#000100" size="3"><em>convolution</em></font><font face="Arial" color="#000100" size="3"> prior for the area-specific random effects (Besag, York and Mollie 1991) which partitions the overall random effect for each area into the sum of a spatial component plus a non-spatial component. In this model, the islands will just have a non-spatial term for the random effect. See </font><font face="Arial" color="#000000" size="3"><a href="#HA"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;on&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;a&nbsp;London Health&nbsp;Authority</u></font><font face="Arial" color="#000100" size="3"></a> for details of this model.</font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits</font><font face="Arial" color="#000000" size="3"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ScotlandInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000100" size="3"><br><br>Note that the initial values for elements 6, 8 and 11 of the vector </font><font face="Arial" color="#000100" size="3"><strong>b</strong></font><font face="Arial" color="#000100" size="3"> are set to NA since these correspond to the three islands (</font><font face="Arial" color="#000000" size="3">Orkneys, Shetland and the Outer Hebrides). The values of </font><font face="Arial" color="#000000" size="3"><strong>b</strong></font><font face="Arial" color="#000000" size="3"> are set to zero by the </font><font face="Arial" color="#000000" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000000" size="3">prior for these 3 areas, and so they are not stochastic nodes.<br><br></font><font face="Arial" color="#FF0000" size="3"><strong>(*&nbsp;&nbsp;&nbsp;should not be values ploted in map but means&nbsp;&nbsp;&nbsp;*)</strong></font><font face="Arial" color="#000000" size="3"><br><br><img src="geobugs manual6.bmp" alt="[geobugs manual6]"></font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="HA">2. Convolution priors: Lung cancer in a London Health Authority</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">This example has been modified from a London Health Authority annual report. The theme of the report was inequality in health and the aim was to investiagte links between poverty and ill health. To investigate this issue, the Health Authority carried out a series of disease mapping studies at census ward level. There are 44 wards in the Health Authority in this example. The data are simulated observed and exepected counts of lung cancer incidence in males aged 65 and over living in the Health Authority region; a ward level index of socio-economic devprivation is also available.<br><br>We fit the following model, allowing a convolution prior for the random effects:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;O</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= log E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="3">depriv</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">h</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br><br></sub></font><font face="Arial" color="#000100" size="3">where depriv</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the devprivation covariate, b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> are spatial random effects assigned a CAR prior, and we introduce a second set of random effects h</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for which we assume an exchangeable Normal prior. The random effect for each area is thus the sum of a spatially structured component b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and an unstructured component</font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">h</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> . This is termed a convolution prior (Besag, York and Mollie 1991; Mollie 1996). Besag, York and Mollie argue that this model is more flexible than assume only CAR random effects, since it allows the data to decide how much of the residual disease risk is due to spatially structured variation, and how much is unstructured over-dispersion. <br><br>The code for this model is given below.<br><br></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O[i] ~ dpois(mu[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i]) &lt;- log(E[i]) + alpha + beta * depriv[i] + b[i] + h[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Area-specific relative risk (for maps)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR[i] &lt;- exp(alpha + beta * depriv[i] + b[i] + h[i]) <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Exchangeable prior on unstructured random effects</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h[i] ~ dnorm(0, tau.h) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># CAR prior distribution for spatial random effects: </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[1 : N] ~ car.normal(adj[], weights[], num[], tau.b)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(k in 1:sumNumNeigh) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[k] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors:</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha ~ dflat() <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0.0, 1.0E-5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.b ~ dgamma(0.5, 0.0005) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma.b &lt;- sqrt(1 / tau.b) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.h ~ dgamma(0.5, 0.0005) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma.h &lt;- sqrt(1 / tau.h) <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Data</font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/LHAData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a><br></u></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Inits</font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/LHAInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a><br></u></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><img src="geobugs manual7.bmp" alt="[geobugs manual7]"><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Lips2">3. Proper CAR model: Lip cancer revisited</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000000" size="3">This example illustrates the use of the proper CAR distribution (</font><font face="Arial" color="#000100" size="3"><strong><em><a href="#car.proper"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>car.proper</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3">) rather than the intrinsic CAR distribution for the area-specific random effects in the Lip cancer example (9.1). We use the definition of the </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000000" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000000" size="3"> matrices proposed by Cressie and colleagues (see section on <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3"><u>proper&nbsp;CAR&nbsp;models</u></font><font face="Arial" color="#000000" size="3"></a> in Appendix 1).</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Set up 'data' to define spatial dependence structure<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># =====================================</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in 1 : N) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m[i] &lt;- 1/E[i] # scaling factor for variance in each cell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The vector </font><font face="Courier New" color="#000100" size="3">C[] </font><font face="Arial" color="#000100" size="3">required as input into the car.proper distribution is a vector<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# respresention of the weight matrix with elements Cij. The first J1 elements of the </font><font face="Courier New" color="#000100" size="3">C[]<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# vector contain the weights for the J1 neighbours of area i=1; the (J1+1) to J2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# elements of the </font><font face="Courier New" color="#000100" size="3">C[]</font><font face="Arial" color="#000100" size="3"> vector contain the weights for the J2 neighbours of area i=2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# etc. To set up this vector, we need to define a variable </font><font face="Courier New" color="#000100" size="3">cumsum</font><font face="Arial" color="#000100" size="3">, which gives the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# values of J1, J2, etc.; we then set up an index matrix </font><font face="Courier New" color="#000100" size="3">pick[,]</font><font face="Arial" color="#000100" size="3"> with N columns<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# corresponding to the i=1,...,N areas, and with the same number of rows as there are<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# elements in the </font><font face="Courier New" color="#000100" size="3">C[]</font><font face="Arial" color="#000100" size="3"> vector (i.e. </font><font face="Courier New" color="#000100" size="3">sumNumNeigh</font><font face="Arial" color="#000100" size="3">). The elements </font><font face="Courier New" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="3">#C[ (cumsum[i]+1):cumsum[i+1] ] </font><font face="Arial" color="#000100" size="3">correspond to <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the set of weights Cij associated with area i, and so we set up ith column of the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# matrix </font><font face="Courier New" color="#000100" size="3">pick[,]</font><font face="Arial" color="#000100" size="3">to have a 1 in all the rows k for which </font><font face="Courier New" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</font><font face="Courier New" color="#000100" size="3">cumsum[i] &lt; k &lt;= cumsum[i+1]</font><font face="Arial" color="#000100" size="3">, and 0's elsewhere. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For example, let </font><font face="Courier New" color="#000100" size="3">N</font><font face="Arial" color="#000100" size="3">=4 and </font><font face="Courier New" color="#000100" size="3">cumsum</font><font face="Arial" color="#000100" size="3">=c(0,3,5,6,8), so area i=1 has 3 neighbours, area<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# i=2 has 2 neighbours, area i=3 has 1 neighbour and area i=4 has 2 neighbours. The<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the matrix </font><font face="Courier New" color="#000100" size="3">pick[,]</font><font face="Arial" color="#000100" size="3"> is:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# </font><font face="Courier New" color="#000100" size="3">pick </font><font face="Arial" color="#000100" size="3"></font><font face="Courier New" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 1, 0, 0, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 1, 0, 0, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 1, 0, 0, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0, 1, 0, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0, 1, 0, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0, 0, 1, 0, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0, 0, 0, 1, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0, 0, 0, 1, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We can then use the inner product (</font><font face="Courier New" color="#000100" size="3">inprod(,)</font><font face="Arial" color="#000100" size="3">) function in WinBUGS and the kth<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# row of </font><font face="Courier New" color="#000100" size="3">pick</font><font face="Arial" color="#000100" size="3"> to select which area corresponds to the kth element in the vector </font><font face="Courier New" color="#000100" size="3">C[]</font><font face="Arial" color="#000100" size="3">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likewise, we can use </font><font face="Courier New" color="#000100" size="3">inprod(,)</font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;# and the ith column of </font><font face="Courier New" color="#000100" size="3">pick</font><font face="Arial" color="#000100" size="3"> to select the elements of </font><font face="Courier New" color="#000100" size="3">C[]</font><font face="Arial" color="#000100" size="3"> which correspond to area i.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note: this way of setting up the C vector is somewhat convoluted!!!! In future<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# versions, we hope the GeoBUGS adjacency matrix tool will be able to dump out the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# relevant vectors required. Alternatively, the C vector could be created using another<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# package (e.g. Splus) and read into WinBUGS as data.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;cumsum[1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for(i in 2:(N+1)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cumsum[i] &lt;- sum(num[1:(i-1)])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(k in 1 : sumNumNeigh) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pick[k,i] &lt;- step(k - cumsum[i] - epsilon) * step(cumsum[i+1] - k) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pick[k,i] = 1 if cumsum[i] &lt; k &lt;= cumsum[i=1]; otherwise, pick[k,i] = 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C[k] &lt;- sqrt(E[adj[k]] / inprod(E[], pick[k,])) # weight for each pair of neighbours<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;epsilon &lt;- 0.0001<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># =====</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O[i] ~ dpois(mu[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i]) &lt;- log(E[i]) + S[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Area-specific relative risk </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR[i] &lt;- exp(S[i])</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[i] &lt;- alpha</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Proper CAR prior distribution for spatial random effects: </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;S[1:N] ~ car.proper(theta[], </font><font face="Arial" color="#000100" size="3">C[], adj[], num[], m[], </font><font face="Arial" color="#000100" size="3">prec, gamma)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors:</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0, 0.0001) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior on precision</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;prec ~ dgamma(0.5, 0.0005)</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;v &lt;- 1/prec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# variance<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(1 / prec)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# standard deviation<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;gamma.min &lt;- min.bound(C</font><font face="Arial" color="#000100" size="3">[], adj[], num[], m[]</font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;gamma.max &lt;- max.bound(C</font><font face="Arial" color="#000100" size="3">[], adj[], num[], m[]</font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;gamma ~ dunif(gamma.min, gamma.max)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#0000FF" size="3">Data</font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/Scotland1Data.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Inits</font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#000000" size="2"></font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/Scotland1Inits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><strong><br><a id="Kriging">4. Bayesian kriging and spatial prediction: Surface elevation</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3"><br>The data for this example are taken from Diggle and Riberio (2000) (and came originally from Davis (1973)). The data file contains the variables height, x and y, giving surface elevation at each of 52 locations (x, y) within a 310-foot square. The unit of distance is 50 feet, whereas one unit of height represents 10 feet of elevation. A Gaussian kriging model can be fitted to these data in WinBUGS 1.4 using either the </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#spatial.exp"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.exp</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#spatial.exp"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.disc</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#spatial.disc"></em></strong></font><font face="Arial" color="#000000" size="3"> distributions. The data file also contains a set of locations x.pred and y.pred representing a 15 x 15 grid of points at which we wish to predict surface elevation. Predictions can be obtained using either the </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#spatial.exp.pred"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.pred</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#spatial.exp.pred"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.unipred</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> predictive distributions in WinBUGS 1.4<br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Spatially structured multivariate normal likelihood <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># exponential correlation function<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi, kappa)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# disc correlation function <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;height[1:N] ~ spatial.disc(mu[], x[], y[], tau, alpha)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;mu[i] &lt;- beta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Priors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta ~ dflat()<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.001, 0.001) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma2 &lt;- 1/tau<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># priors for spatial.exp parameters<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior range for correlation at min distance (0.2 x 50 ft) is 0.02 to 0.99<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;phi ~ dunif(0.05, 20)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior range for correlation at max distance (8.3 x 50 ft) is 0 to 0.66<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;kappa ~ dunif(0.05,1.95)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># priors for spatial.disc parameter<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior range for correlation at min distance (0.2 x 50 ft) is 0.07 to 0.96<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;alpha ~ dunif(0.25, 48)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior range for correlation at max distance (8.3 x 50 ft) is 0 to 0.63<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Spatial prediction<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Single site prediction<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:M) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height.pred[j] ~ spatial.unipred(beta, x.pred[j], y.pred[j], height[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Only use joint prediction for small subset of points, due to length of time it takes to run<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:10) { mu.pred[j] &lt;- beta }<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height.pred.multi[1:10] ~ spatial.pred(mu.pred[], x.pred[1:10], y.pred[1:10], height[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#0000FF" size="3">Data</font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ElevationData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#0000FF" size="3">Initial values<br></font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ElevationExpInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values&nbsp;for&nbsp;exponential&nbsp;model</a></u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ElevationDiscInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values&nbsp;for&nbsp;disc&nbsp;model</a><br></u></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br><img src="geobugs manual8.bmp" alt="[geobugs manual8]"><br><br><br>The GeoBUGS map tool can be used to produce an approximate map of the posterior mean predicted surface elevation. It is not possible to map point locations using GeoBUGS. However, a map file called </font><font face="Arial" color="#000100" size="3"><strong><em>elevation</em></strong></font><font face="Arial" color="#000100" size="3"> is already loaded in the GeoBUGS Map Tool --- this is a 15 x 15 grid with the centroids of the grid cell corresponding to the locations of each of the prediction points. You can use this to produce a map of the posterior mean (or other posterior summaries) of the vector of predicted values </font><font face="Arial" color="#000100" size="3"><strong><em>height.pred</em></strong></font><font face="Arial" color="#000100" size="3">. <br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="forest">5. Poisson-gamma spatial moving average (convolution) model:&nbsp;Distribution of hickory trees in Duke forest</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Ickstadt and Wolpert (1998) and Wolpert and Ickstadt (1998) analyse the spatial distribution of hickory trees (a subdominant species) in a 140 metre x 140 metre research plot in Duke Forest, North Carolina, USA, with the aim of investigating the regularity of the distribution of trees: spatial clustering would reveal that the subdominant species is receding from, or encroaching into, a stand recovering from a disturbance, while regularity would suggest a more stable and undisturbed recent history.<br><br>The data comprise counts of trees, Y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, in each of i=1,...,16 30m x 30m quadrats (each having area A</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 900 m</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) on a 4x4 grid covering the research plot (excluding a 10m boundary region to minimise edge effects), together with the x and y co-ordinates of the centroid of each plot (relative to the south-west corner of the research plot). Ickstadt and Wolpert (1998) fit a Poisson-gamma spatial moving average model as follows:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson( </font><font face="Symbol" color="#000100" size="3">m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) i = 1,...,16<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= A</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> * </font><font face="Symbol" color="#000100" size="3">l </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3"><sub>j<br></sub></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">where</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j </sub></font><font face="Arial" color="#000100" size="3">can be thought of as latent unobserved risk factors associated with locations or sub-regions of the study region indexed by j, and k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is a kernel matrix of 'weights' which depend on the distance or proximity between latent location j and quadrat i of the study region (see </font><font face="Arial" color="#000000" size="3"><a href="#Appendix 2"></font><font face="Arial" color="#0000FF" size="3"><u>Appendix&nbsp;2</u></font><font face="Arial" color="#000100" size="3"></a> for further details of this convolution model). Ickstadt and Wolpert (1998) take the locations of the latent</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">to be the same as the partition of the study region used for the observed data i.e. j = 1,....16 with latent sub-region j being the same as quadrat i of the study region. Note that it is not necessary for the latent partition to be the same as the observed partition - see </font><font face="Arial" color="#000000" size="3"><a href="#saviah"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;6</u></font><font face="Arial" color="#000100" size="3"></a>. The </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> are assigned independent gamma prior distributions<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Gamma(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">) j = 1,....,16.&nbsp;<br><br>Ickstadt and Wolpert (1998) consider two alternative kernel functions: an adjacency-based kernel and a distance-based kernel. The adjacency based kernel is defined as:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 if i = j<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = exp(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">)/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> if j is a nearest neighbour of i (only north-south and east-west<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neighbours considered) and n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the number of neighbours of area i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise<br><br>The distance based kernel is defined as:<br><br>k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = exp(</font><font face="Symbol" color="#000100" size="3">- </font><font face="Arial" color="#000100" size="3">[d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/ exp(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">)]</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) where d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is the distance between the centroid of areas i and j<br><br>For both kernels, the parameter exp(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">) reflects the degree of spatial dependence or clustering in the data, with large values of </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">suggesting spatial correlation and irregular distribution of hickory trees.<br><br>Ickstadt and Wolpert (1998) elicit expert prior opinion concerning the unknown hyperparameters </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= log(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"><sub>1 </sub></font><font face="Symbol" color="#000100" size="3">= -</font><font face="Arial" color="#000100" size="3">log(</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">) and </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> and translate this information into Normal prior distributions for </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">.<br><br>This model may be implemented in WinBUGS 1.4 using the </font><font face="Arial" color="#000000" size="3"><a href="#pois.conv"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>pois.conv</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000100" size="3"> distribution. The code is given below. <br></font><font face="Arial" color="#0000FF" size="3"><br>Model</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ dpois.conv(mu[i,])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:J) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i, j] &lt;- A[i] * lambda[i, j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lambda[i, j] &lt;- k[i, j] * gamma[j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># priors</font><font face="Arial" color="#000100" size="3"> (see Ickstadt and Wolpert (1998) for details of prior elicitation)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1:J) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma[j] ~ dgamma(alpha, beta)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alpha &lt;- exp(theta0)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta &lt;- exp(-theta1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta0 ~ dnorm(-0.383, 1) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta1 ~ dnorm(-5.190, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta2 ~ dnorm(-1.775, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior on theta2 for adjacency-based kernel<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;theta2 ~ dnorm(1.280, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior on theta2 for distance-based kernel<br><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># compute adjacency-based kernel<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Note N = J in this example (necessary for adjacency-based kernel)</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[i, i] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:J) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># distance between areas i and j<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[i, j] &lt;- sqrt((x[i] - x[j])*(x[i] - x[j]) + (y[i] - y[j])*(y[i] - y[j]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># (only needed to help compute nearest neighbour weights;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># alternatively, read matrix w from file)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w[i, j] &lt;- step(30.1 - d[i, j])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# nearest neighbour weights:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># areas are 30 sq m, so any pair of areas with centroids &gt; 30m apart are not <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# nearest neighbours (0.1 added to account for numeric imprecision in d)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in (i+1):J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[i, j] &lt;- w[i, j] * exp(theta2) / (sum(w[i,]) - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[j, i] &lt;- w[j, i] * exp(theta2) / (sum(w[j,]) - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># alternatively, compute distance-based kernel<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for (i in 1:N) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[i, i] &lt;- 1 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:J) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># distance between areas i and j<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[i, j] &lt;- sqrt((x[i] - x[j])*(x[i] - x[j]) + (y[i] - y[j])*(y[i] - y[j]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in (i+1):J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[i, j] &lt;- exp(-pow(d[i, j]/exp(theta2), 2))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k[j, i] &lt;- exp(-pow(d[j, i]/exp(theta2), 2))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># summary quantities for posterior inference </font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># smoothed density of hickory trees (per sq metre) in area i<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;density[i] &lt;- sum(lambda[i, ])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># observed density of hickory trees (per sq metre) in area i<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obs.density[i] &lt;- Y[i]/A[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># large values indicate strong spatial dependence;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># spatial.effect -&gt; 0 indicates spatial independence<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;spatial.effect &lt;- exp(theta2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#0000FF" size="3">Data</font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ForestData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits</font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/ForestInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Results<br><br></font><font face="Arial" color="#000000" size="3">Assuming adjacency-based kernel (equivalent to Ickstadt and Wolpert's model M</font><font face="Arial" color="#000000" size="3"><sub>S</sub></font><font face="Arial" color="#000000" size="3">):</font><font face="Arial" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;spatial.effect&nbsp;&nbsp;&nbsp;0.2856&nbsp;&nbsp;&nbsp;0.1793&nbsp;&nbsp;&nbsp;0.009916&nbsp;&nbsp;&nbsp;0.04003&nbsp;&nbsp;&nbsp;0.2588&nbsp;&nbsp;&nbsp;0.7088&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;theta0&nbsp;&nbsp;&nbsp;-0.6121&nbsp;&nbsp;&nbsp;0.4562&nbsp;&nbsp;&nbsp;0.02313&nbsp;&nbsp;&nbsp;-1.519&nbsp;&nbsp;&nbsp;-0.6084&nbsp;&nbsp;&nbsp;0.228&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;theta1&nbsp;&nbsp;&nbsp;-5.111&nbsp;&nbsp;&nbsp;0.5088&nbsp;&nbsp;&nbsp;0.0179&nbsp;&nbsp;&nbsp;-6.046&nbsp;&nbsp;&nbsp;-5.133&nbsp;&nbsp;&nbsp;-4.05&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;theta2&nbsp;&nbsp;&nbsp;-1.487&nbsp;&nbsp;&nbsp;0.7497&nbsp;&nbsp;&nbsp;0.04143&nbsp;&nbsp;&nbsp;-3.218&nbsp;&nbsp;&nbsp;-1.352&nbsp;&nbsp;&nbsp;-0.3441&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;10000<br><br>Ickstadt and Wolpert report a posterior mean (sd) of 0.281 (0.156) for the spatial effect, exp(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">), from their analysis using a 4x4 partition of the study region (Table 1.3).<br><br><br></font><font face="Arial" color="#000000" size="3">Assuming distance-based kernel (equivalent to Ickstadt and Wolpert's model M</font><font face="Arial" color="#000000" size="3"><sub>D</sub></font><font face="Arial" color="#000000" size="3">):</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;spatial.effect&nbsp;&nbsp;&nbsp;8.042&nbsp;&nbsp;&nbsp;7.474&nbsp;&nbsp;&nbsp;0.5676&nbsp;&nbsp;&nbsp;0.5371&nbsp;&nbsp;&nbsp;4.684&nbsp;&nbsp;&nbsp;23.9&nbsp;&nbsp;&nbsp;20001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;theta0&nbsp;&nbsp;&nbsp;-0.297&nbsp;&nbsp;&nbsp;0.5198&nbsp;&nbsp;&nbsp;0.02996&nbsp;&nbsp;&nbsp;-1.533&nbsp;&nbsp;&nbsp;-0.2463&nbsp;&nbsp;&nbsp;0.5766&nbsp;&nbsp;&nbsp;20001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;theta1&nbsp;&nbsp;&nbsp;-5.276&nbsp;&nbsp;&nbsp;0.522&nbsp;&nbsp;&nbsp;0.01989&nbsp;&nbsp;&nbsp;-6.197&nbsp;&nbsp;&nbsp;-5.308&nbsp;&nbsp;&nbsp;-4.157&nbsp;&nbsp;&nbsp;20001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;theta2&nbsp;&nbsp;&nbsp;1.563&nbsp;&nbsp;&nbsp;1.108&nbsp;&nbsp;&nbsp;0.06682&nbsp;&nbsp;&nbsp;-0.6216&nbsp;&nbsp;&nbsp;1.544&nbsp;&nbsp;&nbsp;3.174&nbsp;&nbsp;&nbsp;20001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;<br>Ickstadt and Wolpert report a posterior mean (sd) of 7.449 (6.764) for the spatial effect, exp(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">), from their analysis using a 4x4 partition of the study region (Table 1.3), and posterior means of -0.02, -5.28 and 1.54 respectively for theta0, theta1 and theta2. Ickstadt and Wolpert noted that the posterior for the spatial effect was multi-modal, as seen in the density plot below:<br><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF8040" size="3"><strong>MISSING FIGURE<br>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000100" size="3"><br>Note however that convergence of this distance-based model is not very good, and the results reported above are not particularly stable (the adjacency-based model appears to converge much better). This may be partly due to the rather strong prior information about theta2 for the distance-based model which, as noted by Ickstadt and Wolpert, appears to conflict with the data. <br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="saviah">6. Poisson-gamma spatial moving average (convolution) model:&nbsp;Ecological regression of air pollution and respiratory illness in children</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Best et al (2000b) applied the Poisson-gamma convolution model to a small-area ecological regression analysis of traffic-related air pollution and respiratory illness in children living in the Huddersfield region of northern England. They carried out two analyses, one using a partition of the study region into 427 administrative enumeration districts, and the other partitioning the region into 605 regular 750m</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> grid cells. Here we consider the latter partition of the study region. The following data were available:<br><br>Y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = number of cases of self-reported frequent cough amongst children aged 7-9 in each of the i=1,..., 605 areas (750 m</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> grid cells)<br>pop</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = (estimated) population of 7-9 year old children in each area, based on pro-rated 1991 enumeration district census counts. (Note that this leads to &lt;1 child per area in some areas, due to the pro-rata split; counts are also divided by 100, to give rates per 100 children).<br>NO2</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Arial" color="#000000" size="3">average annual nitrogen dioxide concentration in each area, measured in </font><font face="Symbol" color="#000000" size="3">m</font><font face="Arial" color="#000000" size="3">g m</font><font face="Arial" color="#000000" size="2"><sup>-3</sup></font><font face="Arial" color="#000000" size="3"> above the baseline concentration for the study region of approximately 20</font><font face="Symbol" color="#000000" size="3">m</font><font face="Arial" color="#000000" size="3">g m</font><font face="Arial" color="#000000" size="2"><sup>-3</sup></font><font face="Arial" color="#000000" size="3"><sup><br></sup></font><font face="Arial" color="#000100" size="3"><br>Best et al (2000b) fitted an indentity-link spatial moving average Poisson regression model:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson( </font><font face="Symbol" color="#000100" size="3">m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= pop</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> * </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> NO2</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">where</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j </sub></font><font face="Arial" color="#000100" size="3">can be thought of as latent unobserved risk factors associated with locations or sub-regions of the study region indexed by j. These locations or sub-regions are typically defined by the user, and are chosen to represent a partition of the region that is appropriate for capturing unmeasured spatial variation in the disease rate. Best et al (2000b) define the latent</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j </sub></font><font face="Arial" color="#000100" size="3">parameters on a 12 x 8 grid of approx 3km</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> quadrats covering the Huddersfield study region. k</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> are then the elements of a 605 x 96 Gaussian kernel matrix, with <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">= 1 / (2</font><font face="Symbol" color="#000100" size="3">p r</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) exp(</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> / 2</font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3">)<br>where d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> represents the Euclidean distance between the centroid of area i of the study region and the location of the j</font><font face="Arial" color="#000100" size="3"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> latent factor. Note that if the latent factors are defined on sub-regions rather than points, it is preferable to integrate the above kernel over the latent sub-region (i.e. over all possible distances between the centroid of area i and all locations within the latent sub-region) - the Splus / R function given below impelments this integration when computing the kernel matrix. </font><font face="Symbol" color="#000100" size="3">r </font><font face="Arial" color="#000100" size="3">&gt; 0 is a distance scale governing how rapidly the kernel weights (i.e. the influence of the j</font><font face="Arial" color="#000100" size="2"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> latent factor on the disease risk in the i</font><font face="Arial" color="#000100" size="2"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> area) decline with increasing distance. Best et al (2000b) fix </font><font face="Symbol" color="#000100" size="3">r </font><font face="Arial" color="#000100" size="3">= 1 km. By fixing </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3">, the kernel matrix can be pre-computed outside of WinBUGS (see link in the data file</font><font face="Arial" color="#0000FF" size="3"><u> </u></font><font face="Arial" color="#000100" size="3">for Splus / R code for doing this), thus simplifying the implementation. It is possible to treat </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3"> as uncertain (see </font><font face="Arial" color="#000000" size="3"><a href="#forest"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;5</u></font><font face="Arial" color="#000100" size="3"></a>), but this entails calculating the elements k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> at each MCMC interation within the BUGS code: this leads to big increases in computation time for all but very small study regions and latent grids. (Note that since the overall scale parameter of the Gaussian kernel is common to all elements k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> it can be factored out of the externel calculation of the kernel, and included as an uncertain parameter (here called </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">) in the BUGS model.<br><br>Independent gamma prior distributions are assumed for the uncertainty quantities </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> as this enables the MCMC sampler to exploit conjugacy with the Poisson likelihood. <br><br>See Best et al (2000b) for full details and interpretation of the model, and </font><font face="Arial" color="#000000" size="3"><a href="#Appendix 2"></font><font face="Arial" color="#0000FF" size="3"><u>Appendix&nbsp;2</u></font><font face="Arial" color="#000000" size="3"></a></font><font face="Arial" color="#000100" size="3"> for further technical information about the Poisson-gamma model. <br><br>The code for this model is given below.</font><font face="Arial" color="#0000FF" size="3"><br><br>Model</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : I) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># convolution likelihood: <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Y[i] ~ Poisson( sum_ j { mu[i, j] } )<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># where mu[i, j] = pop[i] * lambda[i, j] and<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># pop[i] = (standardised) population (in 100's) in area i<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># lambda[i, j] = disease rate in area i attributed to jth 'source', where<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># the sources include both observed and latent covariates.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ dpois.conv(mu[i, ])&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1 : J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># rescale kernel matrix<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k1[i, j] &lt;- ker[i, j] / prec<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</font><font face="Arial" color="#000100" size="3"> jth 'source' (jth latent spatial grid cell)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">lambda[i, j] &lt;- beta2 * gamma[j] * k1[i, j]</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># (J+1)th 'source' (overall intercept; represents background rate)</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">lambda[i,J+1] &lt;- beta0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (J+2)th 'source' (effect of observed NO2 covariate in area i)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;lambda[i,J+2] &lt;- beta1 * NO2[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Note: if additional covariates have been measured, these <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># should be included in the same way as NO2, giving terms<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># lambda[i, J+3], lambda[i, J+4],.....etc. </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1 : J+2) { </font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i, j] &lt;- lambda[i, j] * pop[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Priors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># See Table 22.1 in Best et al. (2000b) for further details.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Priors for latent spatial grid cell (gamma) parameters:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># Assume gamma_j ~ gamma(a, t) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># Prior shape parameter for gamma distn on gamma[j]'s will change in proportion to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the size of the latent grid cells, to ensure aggregation consistency. The prior inverse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# scale parameter for gamma distn on gamma[j]'s stays constant across different<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# partitions, but depends on the units used to measure the area of the latent grid cells:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# here we are assuming # 'area' is in sq kilometres, and we take tauG = 1 (per km^2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which corresponds to assuming # that our prior guess at the value of the gamma[j]'s<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# is based on 'observing' about 1 * (area of study region = 30*20km^2) = 600<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># 'prior points' over the study region. </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note: area of latent grid cells is read in from data file<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alphaG &lt;- tauG * area<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tauG &lt;- 1 <br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1 : J) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma[j] ~ dgamma(alphaG, tauG)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Priors for beta coefficients:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3">#<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># Assume priors on each beta are of the form beta ~ gamma(a, t).<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3">#<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># Here, parameter of the prior are chosen by setting the prior mean to give an equal <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># number of cases allocated to each of the 3 'sources' (baseline, NO2 and latent), i.e.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior mean = a / t = a * 3 * Xbar / Ybar,<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># where Ybar is the overall disease rate in number of cases per unit population,<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># and Xbar is the </font><font face="Arial" color="#808080" size="3"><strong>population-weighted mean</strong></font><font face="Arial" color="#808080" size="3"> of covariate X. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># We also take shape parameter a = 0.575, since this gives the ratio of the 90th : 10th<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#808080" size="3"># percentile of the prior distn = 100, which is suitably diffuse.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;YBAR &lt;- sum(Y[])/sum(pop[])&nbsp;&nbsp;&nbsp;# mean number of cases per unit population<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;NO2BAR &lt;- inprod(NO2[], pop[]) / sum(pop[])&nbsp;&nbsp;&nbsp;# population-weighted mean NO2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Shape parameter for Intercept (beta0)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alpha0&lt;- 0.575<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Inverse scale parameter for Intercept (beta0)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau0 &lt;- 3 * alpha0 / YBAR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Shape parameter for effect of NO2 (beta1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alpha1&lt;- 0.575<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Inverse scale parameter for effect of NO2 (beta1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau1 &lt;- 3 * alpha1 * NO2BAR / YBAR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Shape parameter for Latent coefficient (beta2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;alpha2 &lt;- 0.575<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Inverse scale parameter for Latent coefficient (beta2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau2 &lt;- 3 * alpha2&nbsp;&nbsp;&nbsp;/ YBAR<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta0 ~ dgamma(alpha0, tau0)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta1 ~ dgamma(alpha1, tau1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta2 ~ dgamma(alpha2, tau2)<br><br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Summary quantities for posterior inference <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for(i in 1:I) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Overall disease rate in area i <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RATE[i] &lt;- sum(mu[i, ])/pop[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Rate associated with latent spatial factor in area i <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LATENT[i] &lt;- beta2 * inprod(k1[i,], gamma[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Expected rate (number of cases per unit population) attributed to each source <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># (see Table 22.2 in Best et al (2000b) )<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Background (overall baseline) rate per 100 population<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">rate.base &lt;- beta0<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Number of cases per 100 population attributed<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># to NO2 = beta1 * population-weighted mean value<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># of NO2 across the study region. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;rate.no2 &lt;- beta1 * inprod(pop[], NO2[]) / sum(pop[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Number of cases per 100 population attributed to <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># latent sources = beta2 * population-weighted mean<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># value of the latent spatial factor (sum_j k_ij gamma_j)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;rate.latent &lt;- inprod(pop[], LATENT[]) / sum(pop[])<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Percentage of cases attributed to each source:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Total &lt;- rate.base + rate.no2 + rate.latent </font><font face="Arial" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># % cases attributed to baseline risk</font><font face="Arial" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">PC.base &lt;- rate.base / Total * 100<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# % cases attributed to NO2 exposure<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;PC.no2 &lt;- rate.no2 / Total * 100<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# % cases attributed to latent spatial factors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;PC.latent &lt;- rate.latent / Total * 100<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3">Data </font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/HuddersfieldData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Inits </font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/HuddersfieldInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3">R / Splus functions</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/HuddersfieldRCode.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;R&nbsp;&nbsp;Code</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Results</font><font face="Arial" color="#000100" size="2"><br><br>A 10000 iteration burn-in followed by a further 20000 updates gave the following results<br><br></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;PC.base&nbsp;&nbsp;&nbsp;7.903&nbsp;&nbsp;&nbsp;9.548&nbsp;&nbsp;&nbsp;0.6534&nbsp;&nbsp;&nbsp;0.0203&nbsp;&nbsp;&nbsp;4.467&nbsp;&nbsp;&nbsp;34.33&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;PC.latent&nbsp;&nbsp;&nbsp;73.56&nbsp;&nbsp;&nbsp;14.49&nbsp;&nbsp;&nbsp;0.9942&nbsp;&nbsp;&nbsp;40.32&nbsp;&nbsp;&nbsp;75.13&nbsp;&nbsp;&nbsp;96.76&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;PC.no2&nbsp;&nbsp;&nbsp;18.53&nbsp;&nbsp;&nbsp;10.55&nbsp;&nbsp;&nbsp;0.6615&nbsp;&nbsp;&nbsp;0.5751&nbsp;&nbsp;&nbsp;18.18&nbsp;&nbsp;&nbsp;39.63&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;rate.base&nbsp;&nbsp;&nbsp;0.8056&nbsp;&nbsp;&nbsp;0.9752&nbsp;&nbsp;&nbsp;0.0667&nbsp;&nbsp;&nbsp;0.002039&nbsp;&nbsp;&nbsp;0.454&nbsp;&nbsp;&nbsp;3.481&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;rate.latent&nbsp;&nbsp;&nbsp;7.496&nbsp;&nbsp;&nbsp;1.5&nbsp;&nbsp;&nbsp;0.1012&nbsp;&nbsp;&nbsp;4.078&nbsp;&nbsp;&nbsp;7.641&nbsp;&nbsp;&nbsp;9.933&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br>&nbsp;&nbsp;&nbsp;rate.no2&nbsp;&nbsp;&nbsp;1.888&nbsp;&nbsp;&nbsp;1.077&nbsp;&nbsp;&nbsp;0.06748&nbsp;&nbsp;&nbsp;0.05929&nbsp;&nbsp;&nbsp;1.857&nbsp;&nbsp;&nbsp;4.034&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;20000<br></font><font face="Arial" color="#0000FF" size="2"></font><font face="Arial" color="#000100" size="3"><br>These differ slightly from those in Best et al (2000b) Table 22.2 since the data in this example have been randomly perturbed for confidentiality. However, the picture is broadly similar, with 1.84 (95% interval 0.046 to 4.2) cases per 100 population attributed to NO2 exposure, 7.75 (95% interval 4.2 to 10.0) cases per 100 population attributed to latent spatially varying risk factors and the remaining 0.39 (95% iterval 0.0019 to 3.4) cases per 100 population attributed to the (spatially constant) baseline risk. <br><br>Maps showing the posterior mean rate (per 100 population) of frequent cough attributed to the latent risk factors (cf Fig 22.6b in Best et al, 2000b) and the overall rate (per 100 population) of frequent cough in each area in the study region (cf Fig 22.7b in Best et al, 2000b) are show below. The relevant map file is available from the GeoBUGS 1.2 map tool and is called </font><font face="Arial" color="#000100" size="3"><strong><em>Huddersfield_750m_grid.<br></em></strong></font><font face="Arial" color="#000100" size="2"><strong><em><br><br></em></strong></font><font face="Arial" color="#0000FF" size="2"><u><br><img src="geobugs manual9.bmp" alt="[geobugs manual9]"><br><br><br><img src="geobugs manual10.bmp" alt="[geobugs manual10]"><br><br><br></u></font><font face="Arial" color="#000100" size="3"><strong><a id="mvcar.example">7. Intrinsic multivariate CAR prior for mapping multiple diseases:&nbsp;Oral cavity cancer and lung cancer in West Yorkshire, UK</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>This example illustrates the use of the multivariate CAR prior distribution for joint mapping of two diseases. The data represent observed and age and sex standardised expected counts of incidenct cases of oral cavity and lung cancer in each of 126 electoral wards in the West Yorkshire region of England between 1986 and 1991. Some of the counts have been randomly peturbed by a small amount for confidentiality. <br><br>Since both outcomes are rare, the mortality counts Y</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> for cancer k (k=1, 2) in area i (i=1,126) are assumed to follow independent Poisson distributions, conditional on an unknown mean </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= log E</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> + S</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3"><br>where E</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> is the age and sex standardised expected count for cancer k in area i, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> is an intercept term representing the baseline (log) relative risk of cancer k across the study region, and S</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> is the area- and cancer-specific log relative risk of death. For cancer k, we assume that these log relative risks are spatially correlated across areas, and within area i, we assume that the log relative risks for cancer 1 (oral cavity) and cancer 2 (lung) are also correlated due to dependence on shared area-level unmeasured risk factors. We represent these correlation assumptions using an intrinsic bivariate CAR prior for the 2 x 126 dimensional matrix of S</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> values. Technical details of this prior distribution are given in <a href="#MV"></font><font face="Arial" color="#0000FF" size="3"><u>appendix&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3">. The </font><font face="Arial" color="#000100" size="3"><strong><em><a href="#mv.car"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>mv.car</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000100" size="3"> distribution may be used to fit this model. The WiNBUGS code is given below:<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="2"><br><br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood </font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : Nareas) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : Ndiseases) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i, k] ~ dpois(mu[i, k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note dimension of S is reversed:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i, k]) &lt;- log(E[i, k]) + alpha[k] + S[k, i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# rows=k, cols=i because mv.car assumes rows represent variables<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (diseases) and columns represent observations (areas).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The GeoBUGS map tool can only map </font><font face="Arial" color="#000100" size="3"><strong>vectors</strong></font><font face="Arial" color="#000100" size="3">, so need to create separate vector<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of quantities to be mapped, rather than an array (i.e. RR[i,k] won't work!)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# area specific relative risk for disease 1 (oral)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR1[i] &lt;- exp(alpha[1] + S[1, i]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# area specific relative risk for disease 2 (lung)&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR2[i] &lt;- exp(alpha[2] + S[2, i]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># MV CAR prior for the spatial random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># MVCAR prior</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S[1:Ndiseases, 1 : Nareas] ~ mv.car(adj[], weights[], num[], omega[ , ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:sumNumNeigh) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[i] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (k in 1 : Ndiseases) {<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[k] ~ dflat()<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Precision matrix of MVCAR</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omega[1 : Ndiseases, 1 : Ndiseases] ~ dwish(R[ , ], Ndiseases)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Covariance matrix of MVCAR&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma2[1 : Ndiseases, 1 : Ndiseases] &lt;- inverse(omega[ , ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# conditional SD of S[1, ] (oral cancer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma[1] &lt;- sqrt(sigma2[1, 1])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# conditional SD of S[2,] (lung cancer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma[2] &lt;- sqrt(sigma2[2, 2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# within-area conditional correlation <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corr &lt;- sigma2[1, 2] / (sigma[1] * sigma[2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# between oral and lung cancers.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;mean1 &lt;- mean(S[1,])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;mean2 &lt;- mean(S[2,])</font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Data </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/MVCARData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/MVCARInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;alpha[1]&nbsp;&nbsp;&nbsp;-0.008585&nbsp;&nbsp;&nbsp;0.03661&nbsp;&nbsp;&nbsp;2.436E-4&nbsp;&nbsp;&nbsp;-0.08101&nbsp;&nbsp;&nbsp;-0.008497&nbsp;&nbsp;&nbsp;0.06261&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;alpha[2]&nbsp;&nbsp;&nbsp;-0.02293&nbsp;&nbsp;&nbsp;0.008309&nbsp;&nbsp;&nbsp;4.517E-5&nbsp;&nbsp;&nbsp;-0.03935&nbsp;&nbsp;&nbsp;-0.02294&nbsp;&nbsp;&nbsp;-0.006745&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;corr&nbsp;&nbsp;&nbsp;0.8273&nbsp;&nbsp;&nbsp;0.1348&nbsp;&nbsp;&nbsp;0.004714&nbsp;&nbsp;&nbsp;0.4887&nbsp;&nbsp;&nbsp;0.8641&nbsp;&nbsp;&nbsp;0.9715&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;0.2715&nbsp;&nbsp;&nbsp;0.08103&nbsp;&nbsp;&nbsp;0.003361&nbsp;&nbsp;&nbsp;0.1233&nbsp;&nbsp;&nbsp;0.2666&nbsp;&nbsp;&nbsp;0.4429&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;0.3665&nbsp;&nbsp;&nbsp;0.03102&nbsp;&nbsp;&nbsp;2.636E-4&nbsp;&nbsp;&nbsp;0.3099&nbsp;&nbsp;&nbsp;0.365&nbsp;&nbsp;&nbsp;0.4314&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">The posterior correlation between risk of oral cavity and lung cancers is 0.84 (95% CI: 0.51, 0.97) suggesting strong shared geographical pattern of risk between the two diseases. <br>A 1000 iteration burn-in followed by a further 50000 updates gave the following results<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><br><img src="geobugs manual11.bmp" alt="[geobugs manual11]"><br><br><br><img src="geobugs manual12.bmp" alt="[geobugs manual12]"><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="3">Multivariate convolution prior <br></font><font face="Arial" color="#000100" size="3"><br>Note that it is also possible to fit a multivariate equivalent of the BYM convolution model, by including an additional unstructured random effect for each area and disease, and assuming independent bivariate normal priors for each pair of unstructured effects within an area:<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : Nareas) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (k in 1 : Ndiseases) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Y[i, k] ~ dpois(mu[i, k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Dimension of S reversed as before<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">log(mu[i, k]) &lt;- log(E[i, k]) + alpha[k] + S[k, i] + U[i, k]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# area specific relative risk for disease 1 (oral) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR1[i] &lt;- exp(alpha[1] + S[1,i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# area specific relative risk for disease 2 (lung)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">RR2[i] &lt;- exp(alpha[2] + S[2,i])</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># MV CAR prior for the spatial random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># MVCAR prior </font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[1 : Ndiseases, 1:Nareas] ~ mv.car(adj[], weights[], num[], omega[ , ])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : sumNumNeigh) {&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[i] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Bivariate normal prior for unstructured random effects within each area<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : Nareas) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unstructured multivariate normal<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U[i, 1 : Ndiseases] ~ dmnorm(zero[], tau[ , ])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (k in 1 : Ndiseases) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[k] ~ dflat()<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Precision matrix of MVCAR</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;omega[1:Ndiseases, 1:Ndiseases] ~ dwish(R[ , ], Ndiseases)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Covariance matrix of MVCAR&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma2[1 : Ndiseases, 1:Ndiseases] &lt;- inverse(omega[ , ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# conditional SD of S[1,] (oral cancer)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma[1] &lt;- sqrt(sigma2[1, 1])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# conditional SD of S[2,] (lung cancer)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma[2] &lt;- sqrt(sigma2[2, 2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# within-area conditional correlation between spatial component of variation in oral<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# and lung cancers.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">corr &lt;- sigma2[1, 2] / (sigma[1] * sigma[2])<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Precision matrix of MV Normal<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau[1:Ndiseases, 1:Ndiseases] ~ dwish(Q[ , ], Ndiseases)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Covariance matrix of MV Normal<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma2.U[1:2, 1:2] &lt;- inverse(tau[ , ])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma.U[1] &lt;- sqrt(sigma2.U[1, 1])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma.U[2] &lt;- sqrt(sigma2.U[2, 2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# within-area correlation between unstructured component of variation in oral and <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# lung cancers<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">corr.U &lt;- sigma2.U[1, 2] / (sigma.U[1] * sigma.U[2])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># within-area conditional correlation between total random effect <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (i.e. spatial + unstructured components) for oral cancer and for lung cancer<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">corr.sum &lt;- (sigma2[1, 2] + sigma2.U[1, 2]) / <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(sqrt(sigma2[1, 1] + sigma2.U[1, 1]) * sqrt(sigma2[2, 2] + sigma2.U[2, 2]))<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3">mean1 &lt;- mean(S[1,])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3">mean2 &lt;- mean(S[2,])</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Data </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/MVCARConData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/MVCARConInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A 10000 iteration burn-in followed by a further 50000 updates gave the following results<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;alpha[1]&nbsp;&nbsp;&nbsp;-0.01151&nbsp;&nbsp;&nbsp;0.03821&nbsp;&nbsp;&nbsp;2.997E-4&nbsp;&nbsp;&nbsp;-0.08717&nbsp;&nbsp;&nbsp;-0.01135&nbsp;&nbsp;&nbsp;0.06302&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;alpha[2]&nbsp;&nbsp;&nbsp;-0.02305&nbsp;&nbsp;&nbsp;0.01207&nbsp;&nbsp;&nbsp;1.121E-4&nbsp;&nbsp;&nbsp;-0.04691&nbsp;&nbsp;&nbsp;-0.02299&nbsp;&nbsp;&nbsp;4.938E-4&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;corr&nbsp;&nbsp;&nbsp;0.7705&nbsp;&nbsp;&nbsp;0.3008&nbsp;&nbsp;&nbsp;0.0165&nbsp;&nbsp;&nbsp;-0.2615&nbsp;&nbsp;&nbsp;0.8739&nbsp;&nbsp;&nbsp;0.9806&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;corr.U&nbsp;&nbsp;&nbsp;0.4254&nbsp;&nbsp;&nbsp;0.4262&nbsp;&nbsp;&nbsp;0.01909&nbsp;&nbsp;&nbsp;-0.5998&nbsp;&nbsp;&nbsp;0.5537&nbsp;&nbsp;&nbsp;0.9213&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;corr.sum&nbsp;&nbsp;&nbsp;0.7218&nbsp;&nbsp;&nbsp;0.1964&nbsp;&nbsp;&nbsp;0.009922&nbsp;&nbsp;&nbsp;0.2064&nbsp;&nbsp;&nbsp;0.7781&nbsp;&nbsp;&nbsp;0.9413&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;0.1916&nbsp;&nbsp;&nbsp;0.07964&nbsp;&nbsp;&nbsp;0.004244&nbsp;&nbsp;&nbsp;0.0619&nbsp;&nbsp;&nbsp;0.1862&nbsp;&nbsp;&nbsp;0.3634&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;0.2966&nbsp;&nbsp;&nbsp;0.0467&nbsp;&nbsp;&nbsp;0.001779&nbsp;&nbsp;&nbsp;0.2023&nbsp;&nbsp;&nbsp;0.2976&nbsp;&nbsp;&nbsp;0.3863&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma.U[1]&nbsp;&nbsp;&nbsp;0.1079&nbsp;&nbsp;&nbsp;0.04853&nbsp;&nbsp;&nbsp;0.002281&nbsp;&nbsp;&nbsp;0.04019&nbsp;&nbsp;&nbsp;0.09911&nbsp;&nbsp;&nbsp;0.2196&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;sigma.U[2]&nbsp;&nbsp;&nbsp;0.09466&nbsp;&nbsp;&nbsp;0.02739&nbsp;&nbsp;&nbsp;0.001172&nbsp;&nbsp;&nbsp;0.04393&nbsp;&nbsp;&nbsp;0.09444&nbsp;&nbsp;&nbsp;0.149&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;50000<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Again, the posterior correlation between the spatially structured risk components (S) for oral cavity and lung cancers is high (0.82; 95% CI: 0.29, 0.98), although correlation between the unstructured risk components (U) is less strong (0.38; 95% CI: -0.64, 0.92). Since the spatial component of risk dominates, the correlation between the total random effect (U + S) for oral cancer and lung cancer is also high (0.75; 95% CI: 0.36, 0.94), again suggesting strong shared geographical pattern of risk between the two diseases. <br></font><font face="Arial" color="#0000FF" size="3"><u><br></u></font><font face="Arial" color="#0000FF" size="2"><u><br></u></font><font face="Arial" color="#000100" size="3"><strong><a id="shared.example">8. Shared component model for mapping multiple diseases:&nbsp;Oral cavity cancer and lung cancer cancer in West Yorkshire, UK</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3">Knorr-Held and Best (2001) analysed data on mortality from oral cavity and oesophageal cancer in Germany using a shared component model. This model is similar in spirit to conventional factor analysis, and partitions the geographical variation in two diseases into a common (shared) component (</font><font face="Symbol" color="#000100" size="3"><strong>f</strong></font><font face="Arial" color="#000100" size="3">), and two disease-specific (residual) components (</font><font face="Symbol" color="#000100" size="3"><strong>y</strong></font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><strong>y</strong></font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">). Making the rare disease assumption, the likelihood for each disease is assumed to be independent Poisson, conditional on an unknown mean </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="3"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>ik </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i1 </sub></font><font face="Arial" color="#000100" size="3">= log E</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Symbol" color="#000100" size="3">*d</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i2 </sub></font><font face="Arial" color="#000100" size="3">= log E</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3"><br><br>where Y</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> and E</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> are the observed and age/sex standardised expected counts for cancer k in area i respectively, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> is an intercept term representing the baseline (log) relative risk of cancer k across the study region, and </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="3"> is a scaling factor to allow the risk gradient associated with the shared component to be different for each disease (this is in some sense similar to the factor loadings in conventional factor analysis - see Knorr-Held and Best (2001) for more details). Each of the three components (</font><font face="Symbol" color="#000100" size="3"><strong>f</strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3"><strong>y</strong></font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><strong>y</strong></font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">) is assumed to be spatially structured with zero mean; the components are assumed to be independent of each other. Knorr-Held and Best (2001) used a spatial partition model as a prior for each component. In this example, we fit a similar model, but assume an BYM convolution prior for each component. Here we consider the data from <a href="#mvcar.example"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;7</u></font><font face="Arial" color="#000100" size="3"></a> on incidence of oral cavity cancer and lung cancer in 126 electoral wards in the West Yorkshire region of England:<br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : Nareas) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : Ndiseases) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i, k] ~ dpois(mu[i, k])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i, k]) &lt;- log(E[i, k]) + alpha[k] + eta[i, k] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(i in 1:Nareas) { <br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Define log relative risk in terms of disease-specific (psi) and shared (phi) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# random effects <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# changed order of k and i index for psi (needed because car.normal assumes <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# right hand index is areas)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eta[i, 1] &lt;- phi[i] * delta + psi[1, i] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eta[i, 2] &lt;- phi[i] / delta + psi[2, i] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Spatial priors (BYM) for the disease-specific random effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (k in 1 : Ndiseases) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : Nareas) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# convolution prior = sum of unstructured and spatial effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psi[k, i] &lt;- U.sp[k, i] + S.sp[k, i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# unstructured disease-specific random effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U.sp[k, i] ~ dnorm(0, tau.unstr[k])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# spatial disease-specific effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S.sp[k,1 : Nareas] ~ car.normal(adj[], weights[], num[], tau.spatial[k])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;} </font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Spatial priors (BYM) for the shared random effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:Nareas) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# convolution prior = sum of unstructured and spatial effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i] &lt;- U.sh[i] + S.sh[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# unstructured shared random effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U.sh[i] ~ dnorm(0, omega.unstr)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# spatial shared random effects &nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;S.sh[1:Nareas] ~ car.normal(adj[], weights[], num[], omega.spatial)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (k in 1:sumNumNeigh) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[k] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Other priors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (k in 1:Ndiseases) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;alpha[k] ~ dflat()</font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.unstr[k] ~ dgamma(0.5, 0.0005) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.spatial[k] ~ dgamma(0.5, 0.0005) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omega.unstr ~ dgamma(0.5, 0.0005) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omega.spatial ~ dgamma(0.5, 0.0005) </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># scaling factor for relative strength of shared component for each disease<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logdelta ~ dnorm(0, 5.9)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (prior assumes 95% probability that delta^2 is between 1/5 and 5; <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta &lt;- exp(logdelta)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># lognormal assumption is invariant to which disease is labelled 1 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># and which is labelled 2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ratio (relative risk of disease 1 associated with shared component) to <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (relative risk of disease 2 associated with shared component)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - see Knorr-Held and Best (2001) for further details<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;RR.ratio &lt;- pow(delta, 2)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># Relative risks and other summary quantities </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># The GeoBUGS map tool can only map </font><font face="Arial" color="#000100" size="3"><strong>vectors</strong></font><font face="Arial" color="#000100" size="3">, so need to create separate vector<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># of quantities to be mapped, rather than an array (i.e. totalRR[i,k] won't work!)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : Nareas) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMR1[i] &lt;- Y[i,1] / E[i,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# SMR for disease 1 (oral)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMR2[i] &lt;- Y[i,2] / E[i,2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# SMR for disease 2 (lung)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalRR1[i] &lt;- exp(eta[i,1])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# overall RR of disease 1 (oral) in area i<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalRR2[i] &lt;- exp(eta[i,2])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# overall RR of disease 2 (lung) in area i<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># residulal RR specific to disease 1 (oral cancer)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specificRR1[i]&lt;- exp(psi[1,i]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# residulal RR specific to disease 2 (lung cancer)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specificRR2[i]&lt;- exp(psi[2,i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# shared component of risk common to both diseases <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sharedRR[i] &lt;- exp(phi[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note that this needs to be scaled by delta or 1/delta if the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# absolute magnitude of shared RR for each disease is of interest<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logsharedRR1[i] &lt;- phi[i] * delta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logsharedRR2[i] &lt;- phi[i] /delta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="3"> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# empirical variance of shared effects (scaled for disease 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;var.shared[1] &lt;- sd(logsharedRR1[])*sd(logsharedRR1[])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# empirical variance of shared effects (scaled for disease 2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var.shared[2] &lt;- sd(logsharedRR2[])*sd(logsharedRR2[])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# empirical variance of disease 1 specific effects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var.specific[1] &lt;- sd(psi[1,])*sd(psi[1,])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# empirical variance of disease 2 specific effects <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var.specific[2] &lt;- sd(psi[2,])*sd(psi[2,])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># fraction of total variation in relative risks for each disease that is explained <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# by the shared component<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;frac.shared[1] &lt;- var.shared[1] / (var.shared[1] + var.specific[1])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;frac.shared[2] &lt;- var.shared[2] / (var.shared[2] + var.specific[2])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Data </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/SharedData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/SharedInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A 10000 iteration burn-in followed by a further 50000 updates gave the following results<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;RR.ratio&nbsp;&nbsp;&nbsp;0.796&nbsp;&nbsp;&nbsp;0.4432&nbsp;&nbsp;&nbsp;0.0218&nbsp;&nbsp;&nbsp;0.2798&nbsp;&nbsp;&nbsp;0.7005&nbsp;&nbsp;&nbsp;2.013&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;delta&nbsp;&nbsp;&nbsp;0.8655&nbsp;&nbsp;&nbsp;0.2168&nbsp;&nbsp;&nbsp;0.01112&nbsp;&nbsp;&nbsp;0.529&nbsp;&nbsp;&nbsp;0.837&nbsp;&nbsp;&nbsp;1.419&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;frac.shared[1]&nbsp;&nbsp;&nbsp;0.6985&nbsp;&nbsp;&nbsp;0.2388&nbsp;&nbsp;&nbsp;0.01265&nbsp;&nbsp;&nbsp;0.1395&nbsp;&nbsp;&nbsp;0.7641&nbsp;&nbsp;&nbsp;0.9766&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;frac.shared[2]&nbsp;&nbsp;&nbsp;0.7384&nbsp;&nbsp;&nbsp;0.258&nbsp;&nbsp;&nbsp;0.01546&nbsp;&nbsp;&nbsp;0.1434&nbsp;&nbsp;&nbsp;0.8469&nbsp;&nbsp;&nbsp;0.9863&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;var.shared[1]&nbsp;&nbsp;&nbsp;0.01748&nbsp;&nbsp;&nbsp;0.01141&nbsp;&nbsp;&nbsp;4.692E-4&nbsp;&nbsp;&nbsp;0.002347&nbsp;&nbsp;&nbsp;0.01537&nbsp;&nbsp;&nbsp;0.04528&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;var.shared[2]&nbsp;&nbsp;&nbsp;0.03096&nbsp;&nbsp;&nbsp;0.01146&nbsp;&nbsp;&nbsp;6.556E-4&nbsp;&nbsp;&nbsp;0.005942&nbsp;&nbsp;&nbsp;0.0343&nbsp;&nbsp;&nbsp;0.0467&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;var.specific[1]&nbsp;&nbsp;&nbsp;0.0081&nbsp;&nbsp;&nbsp;0.009477&nbsp;&nbsp;&nbsp;4.537E-4&nbsp;&nbsp;&nbsp;4.676E-4&nbsp;&nbsp;&nbsp;0.004586&nbsp;&nbsp;&nbsp;0.03472&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;var.specific[2]&nbsp;&nbsp;&nbsp;0.01093&nbsp;&nbsp;&nbsp;0.01099&nbsp;&nbsp;&nbsp;6.475E-4&nbsp;&nbsp;&nbsp;5.759E-4&nbsp;&nbsp;&nbsp;0.006307&nbsp;&nbsp;&nbsp;0.03705&nbsp;&nbsp;&nbsp;10001&nbsp;&nbsp;&nbsp;50000<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">These indicate that for oral cancer, about 75% of the total between-area variation in risk is captured by the shared component, while for lung cancer about 64% of the total between-area variation in risk is captured by the shared component, although the 95% CI for frac.shared are very wide. RR.ratio is slightly less than 1 (although again with a wide credible interval), indicating that the shared component has a slightly weaker association with risk of oral cancer (disease 1) than with risk of lung cancer (disease 2). <br><br>Maps showing the spatial pattern of the shared component and the disease-specific residual components are shown below. The map file for this study region is called </font><font face="Arial" color="#000100" size="3"><strong><em>WestYorkshire</em></strong></font><font face="Arial" color="#000100" size="3">, and is available in the maps directory of GeoBUGS 1.2.<br></font><font face="Arial" color="#000100" size="1"><br><br><br><img src="geobugs manual13.bmp" alt="[geobugs manual13]"><br><br><br><img src="geobugs manual14.bmp" alt="[geobugs manual14]"><br><br><img src="geobugs manual15.bmp" alt="[geobugs manual15]"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><u><br></u></font><font face="Arial" color="#000100" size="3"><strong><a id="air.pollution">9. Random walk priors for temporal smoothing of daily air pollution estimates</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Shaddick and Wakefield (2002) consider spatiotemporal modelling of daily ambient air pollution at a number of monitoring sites in London. Here we take a subset of their data on a single pollutant measured at one site for 366 days, and model temporal autocorrelation using a random walk prior. <br><br>Conditional on the underlying mean concentration </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> on day t, the likelihood for the observed pollution concetration Y</font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">is assumed to be independent Normal i.e.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>err</sub></font><font face="Arial" color="#000100" size="3">) where 1/</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>err</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the measurement error variance<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>where </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> is the overall mean pollution concentration at the site, and </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">is a (zero mean) random error term representing daily fluctuations about this mean. To reflect the prior belief that these daily fluctuations are correlated, a <a href="#rw"></font><font face="Arial" color="#0000FF" size="3"><u>random&nbsp;walk</u></font><font face="Arial" color="#000100" size="3"></a> prior is assumed for</font><font face="Symbol" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">{q</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, ......, </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>366</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">} (see equation 7 in Shaddick and Wakefield):<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> )&nbsp;&nbsp;&nbsp;for t = 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/2, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 2 )&nbsp;&nbsp;&nbsp;for t = 2, ...., T-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> )&nbsp;&nbsp;&nbsp;for t = T<br><br>where </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denotes all elements of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">except the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">. This prior may be specified in WinBUGS 1.4 using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution, with adjacency vector </font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> listing neighbouring time points (i.e. (t-1) and (t+1) are neighbours of time point t), corresponding weight vector </font><font face="Arial" color="#000100" size="3"><strong><em>weight[]</em></strong></font><font face="Arial" color="#000100" size="3"> set to a sequence of 1's, and vector giving the number of neighbours, </font><font face="Arial" color="#000100" size="3"><strong><em>num[]</em></strong></font><font face="Arial" color="#000100" size="3">, set to 2 for all time points except </font><font face="Arial" color="#000100" size="3"><strong><em>num[1]</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>num[T] </em></strong></font><font face="Arial" color="#000100" size="3">which are set to 1. <br><br>The RW(1) reflects prior beliefs about smoothness of first differences, i.e. sudden jumps between consecutive values of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are unlikely. Alternatively, we may assume a second order random walk prior RW(2) for </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, which represents prior beliefs that the rate of change (gradient) of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is smooth:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">(2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">) / 5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = 2 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">) / 6, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 6 ) for t = 3, ...., T - 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ 4q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">) / 5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = T -1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( -q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>Again this may be specified using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution in WinBUGS 1.4 via appropriate specification of the </font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>weight[]</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>num[]</em></strong></font><font face="Arial" color="#000100" size="3"> vectors.<br><br>The model code for fitting these two models is given below.<br><br></font><font face="Arial" color="#0000FF" size="3">Model</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(t in 1:T) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[t] ~ dnorm(mu[t], tau.err)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[t] &lt;- beta + theta[t]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;# prior for temporal effects</font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># RW prior for theta[t] - specified using car.normal with <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#neighbours (t-1) and (t+1) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># for theta[2],....,theta[T-1], and neighbours (t+1) for <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#theta[1] and (t-1) for theta[T]<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[1:T] ~ car.normal(adj[], weights[], num[], tau) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta ~ dflat()<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Specify weight matrix and adjacency matrix corresponding to </font><font face="Arial" color="#FF0000" size="3">RW(1) prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># (Note - this could be given in the data file instead)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 1:1) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dj[t] &lt;- t+1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 2:(T-1)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[2+(t-2)*2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[2+(t-2)*2] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[3+(t-2)*2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[3+(t-2)*2] &lt;- t+1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in T:T) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-2)*2 + 2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-2)*2 + 2] &lt;- t-1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Alternatively, a weight matrix and adjacency matrix <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#corresponding to </font><font face="Arial" color="#FF0000" size="3">RW(2) prior</font><font face="Arial" color="#000100" size="3"> can<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# be specified or given in the data file <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#(note, no need to change the prior distribution<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# on theta, just the weights/adjacencies)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in 1:1) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t+1] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+1] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in 2:2) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+1] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+1] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+2] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+2] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+3] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+3] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#for(t in 3:(T-2)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[6+(t-3)*4] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[6+(t-3)*4] &lt;- t-2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[7+(t-3)*4] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[7+(t-3)*4] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[8+(t-3)*4] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[8+(t-3)*4] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[9+(t-3)*4] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[9+(t-3)*4] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in (T-1):(T-1)) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 6] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 6] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 7] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 7] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 8] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 8] &lt;- t-2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in T:T) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 9] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 9] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 10] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 10] &lt;- t-2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"># other priors</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau.err ~ dgamma(0.01, 0.01)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# measurement error precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma.err &lt;- 1 / sqrt(tau.err)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma2.err &lt;- 1/tau.err<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.01, 0.01)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# random walk precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma2 &lt;- 1/tau<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# include this variable to use in time series (model fit) plot<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 1:T) { day[t] &lt;- t }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Note that pollution concentrations were not measured every day. However it is necessary to include days with no measurements as missing values (NA) in the data set, otherwise the temporal neighbourhood structure cannot be specified correctly.<br></font><font face="Arial" color="#0000FF" size="3"><br>Data</font><font face="Arial" color="#0000FF" size="3"> </font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/PollutionData.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;data</a></u></font><font face="Arial" color="#000000" size="2"> </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3">Inits </font><font face="Arial" color="#0000FF" size="3"></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Manuals/PollutionInits.html">click&nbsp;here&nbsp;to&nbsp;open&nbsp;initial&nbsp;values</a></u></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><br>Plus click on </font><font face="Arial" color="#000100" size="3"><em>gen inits</em></font><font face="Arial" color="#000100" size="3"> to generate initial values for the missing data<br></font><font face="Arial" color="#000100" size="2"><br><br><br></font><font face="Arial" color="#0000FF" size="3">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>RW(1) prior:<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;beta&nbsp;&nbsp;&nbsp;3.029&nbsp;&nbsp;&nbsp;0.0201&nbsp;&nbsp;&nbsp;9.439E-4&nbsp;&nbsp;&nbsp;2.99&nbsp;&nbsp;&nbsp;3.029&nbsp;&nbsp;&nbsp;3.069&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[1]&nbsp;&nbsp;&nbsp;2.867&nbsp;&nbsp;&nbsp;0.1959&nbsp;&nbsp;&nbsp;0.00221&nbsp;&nbsp;&nbsp;2.483&nbsp;&nbsp;&nbsp;2.863&nbsp;&nbsp;&nbsp;3.254&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[2]&nbsp;&nbsp;&nbsp;2.824&nbsp;&nbsp;&nbsp;0.1779&nbsp;&nbsp;&nbsp;0.004028&nbsp;&nbsp;&nbsp;2.481&nbsp;&nbsp;&nbsp;2.82&nbsp;&nbsp;&nbsp;3.179&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[3]&nbsp;&nbsp;&nbsp;3.115&nbsp;&nbsp;&nbsp;0.1703&nbsp;&nbsp;&nbsp;0.002417&nbsp;&nbsp;&nbsp;2.783&nbsp;&nbsp;&nbsp;3.115&nbsp;&nbsp;&nbsp;3.443&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[4]&nbsp;&nbsp;&nbsp;3.334&nbsp;&nbsp;&nbsp;0.1852&nbsp;&nbsp;&nbsp;0.005685&nbsp;&nbsp;&nbsp;2.968&nbsp;&nbsp;&nbsp;3.336&nbsp;&nbsp;&nbsp;3.694&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[5]&nbsp;&nbsp;&nbsp;3.111&nbsp;&nbsp;&nbsp;0.1689&nbsp;&nbsp;&nbsp;0.002165&nbsp;&nbsp;&nbsp;2.783&nbsp;&nbsp;&nbsp;3.11&nbsp;&nbsp;&nbsp;3.446&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>.......<br>.......<br>&nbsp;&nbsp;&nbsp;mu[360]&nbsp;&nbsp;&nbsp;2.584&nbsp;&nbsp;&nbsp;0.1673&nbsp;&nbsp;&nbsp;0.002305&nbsp;&nbsp;&nbsp;2.258&nbsp;&nbsp;&nbsp;2.583&nbsp;&nbsp;&nbsp;2.916&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[361]&nbsp;&nbsp;&nbsp;2.383&nbsp;&nbsp;&nbsp;0.1716&nbsp;&nbsp;&nbsp;0.003417&nbsp;&nbsp;&nbsp;2.044&nbsp;&nbsp;&nbsp;2.381&nbsp;&nbsp;&nbsp;2.72&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[362]&nbsp;&nbsp;&nbsp;2.414&nbsp;&nbsp;&nbsp;0.1678&nbsp;&nbsp;&nbsp;0.002228&nbsp;&nbsp;&nbsp;2.084&nbsp;&nbsp;&nbsp;2.411&nbsp;&nbsp;&nbsp;2.746&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[363]&nbsp;&nbsp;&nbsp;2.47&nbsp;&nbsp;&nbsp;0.1679&nbsp;&nbsp;&nbsp;0.00229&nbsp;&nbsp;&nbsp;2.147&nbsp;&nbsp;&nbsp;2.47&nbsp;&nbsp;&nbsp;2.802&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[364]&nbsp;&nbsp;&nbsp;2.516&nbsp;&nbsp;&nbsp;0.1712&nbsp;&nbsp;&nbsp;0.002963&nbsp;&nbsp;&nbsp;2.176&nbsp;&nbsp;&nbsp;2.52&nbsp;&nbsp;&nbsp;2.847&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[365]&nbsp;&nbsp;&nbsp;2.399&nbsp;&nbsp;&nbsp;0.1706&nbsp;&nbsp;&nbsp;0.002618&nbsp;&nbsp;&nbsp;2.063&nbsp;&nbsp;&nbsp;2.398&nbsp;&nbsp;&nbsp;2.729&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;mu[366]&nbsp;&nbsp;&nbsp;2.288&nbsp;&nbsp;&nbsp;0.196&nbsp;&nbsp;&nbsp;0.003037&nbsp;&nbsp;&nbsp;1.91&nbsp;&nbsp;&nbsp;2.284&nbsp;&nbsp;&nbsp;2.684&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;0.2709&nbsp;&nbsp;&nbsp;0.03888&nbsp;&nbsp;&nbsp;0.002482&nbsp;&nbsp;&nbsp;0.2006&nbsp;&nbsp;&nbsp;0.27&nbsp;&nbsp;&nbsp;0.3485&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;sigma.err&nbsp;&nbsp;&nbsp;0.2433&nbsp;&nbsp;&nbsp;0.03411&nbsp;&nbsp;&nbsp;0.002153&nbsp;&nbsp;&nbsp;0.1717&nbsp;&nbsp;&nbsp;0.2449&nbsp;&nbsp;&nbsp;0.3063&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Plot of posterior median (red line) and posterior 95% intervals (dashed blue lines) for mu[t] (the true mean daily pollutant concentration), with observed concentrations shown as black dots. (This plot was produced by selecting the </font><font face="Arial" color="#000100" size="3"><em>model fit</em></font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#000100" size="3"><em>Compare</em></font><font face="Arial" color="#000100" size="3"> menu (available from the </font><font face="Arial" color="#000100" size="3"><em>Inference</em></font><font face="Arial" color="#000100" size="3"> menu), with </font><font face="Arial" color="#000100" size="3"><em>mu</em></font><font face="Arial" color="#000100" size="3"> specified as the </font><font face="Arial" color="#000100" size="3"><em>node</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><em>day</em></font><font face="Arial" color="#000100" size="3"> as the </font><font face="Arial" color="#000100" size="3"><em>axis</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"> as </font><font face="Arial" color="#000100" size="3"><em>other</em></font><font face="Arial" color="#000100" size="3">). Note that the dashed blue line shows the posterior 95% interval for the estimated mean daily concentration, and is not a predictive interval - hence we would not necessarily expect all of the observed data points to lie within the interval.<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF8040" size="6"><strong>MISSING FIGURE<br></strong></font><font face="Arial" color="#000100" size="3"><br><br>Equivalent plot assuming an RW(2) prior. Note the greater amount of smoothing imposed by this prior:<br><br></font><font face="Arial" color="#FF8040" size="6"><strong>MISSING FIGURE</strong></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="2"><u></u></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Appendix">Appendix 1: Technical details of Structured Multivariate Gaussian and Conditional Autoregressive (CAR) models and hyperprior specification.</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br>(Note: for clarity of exposition, we parameterise the Normal distribution in terms of the mean and </font><font face="Arial" color="#000100" size="3"><em>variance</em></font><font face="Arial" color="#000100" size="3"> in the following discussion. However, </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> parameterisation of the CAR and structured MVN models is in terms of the mean and precision as usual.)<br><br>Assume we have a set of area-specific spatially correlated Gaussian data or random effects S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, i=1,..., N (where N is the number of areas in the study region). Suppose their joint distribution may be expressed as follows: <br><br></font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> ~ MVN(</font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3">, v</font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3">) <br><br>where </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="3"><sub>N </sub></font><font face="Arial" color="#000100" size="3">), MVN denotes the N-dimensional multivariate normal distribution, </font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"> is the 1 x N mean vector, v &gt; 0 controls the overall variability of the S</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is an N x N positive definite matrix. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Joint">Joint specification</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>We may assume a parametric form for the elements of the between-area correlation matrix:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3">)<br>where d</font><font face="Arial" color="#000100" size="3"><sub>ij </sub></font><font face="Arial" color="#000100" size="3">= distance between areas i and j. WinBUGS 1.4 allows two options for the funtion f(.) (see Richardson (1992) for further details of these functions):<br><br></font><font face="Arial" color="#000100" size="3"><strong>1. Powered exponential family<br></strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">f, k</font><font face="Arial" color="#000100" size="3">) = exp[</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">(</font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Symbol" color="#000100" size="2"><sup>k</sup></font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">] where </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">&gt; 0, </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> in (0, 2]<br><br>The parameter </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> controls the rate of decline of correlation with distance:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> large </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; rapid decay<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">small </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; slow decay<br><br>One possible strategy for specifying a prior for </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> is to choose a uniform distribution between </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> where </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> are chosen to give a sensible range of values for correlations both at a distance equal to the </font><font face="Arial" color="#000100" size="3"><em>maximum</em></font><font face="Arial" color="#000100" size="3"> distance between any pair of areas in the study region, and at a distance equal to the </font><font face="Arial" color="#000100" size="3"><em>minimum</em></font><font face="Arial" color="#000100" size="3"> distance between any pair of areas in the study. For example, if the minimum distance is 1 km (say), and the maximum distance is 20 km (say), then values of </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">= 0.04 and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> = 5 would give a diffuse but plausible prior range of correlations (assuming </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 1</font><font face="Symbol" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="3"> between 0.007 and 0.96 at a distance of 1 km, and between 0 and 0.45 at a distance of 20 km. </font><font face="Arial" color="#000100" size="3"><em>Note that it is advisable to choose a value of </em></font><font face="Arial" color="#000100" size="3"></font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3"><sub>min </sub></font><font face="Arial" color="#000100" size="3"><em>that prevents the correlation at the maximum distance between observations in the study region from being too high, since this can lead to identifiability problems between the overall mean, </em></font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"><em>, of the spatial random variables and the correlation parameter, </em></font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"><em>.</em></font><font face="Arial" color="#000100" size="3"><br><br>The parameter </font><font face="Symbol" color="#000100" size="3">k </font><font face="Arial" color="#000100" size="3">controls the amount by which spatial variations in the data are smoothed. Large values of </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> lead to greater smoothing, with </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 2 corresponding to the Gaussian correlation function (although the resulting covariance matrix is nearly singular). It is often difficult to learn much about this parameter, so unless there is a good reason for believing otherwise, it is usually advisable to set </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 1 a priori. <br><br></font><font face="Arial" color="#000100" size="3"><strong>2. Disc model<br></strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2 / </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> * {cos</font><font face="Symbol" color="#000100" size="2"><sup>-</sup></font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Symbol" color="#000100" size="3">-</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">[(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)(1 </font><font face="Symbol" color="#000100" size="3">-</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">))]</font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> }&nbsp;&nbsp;&nbsp;for d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">&lt; a</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0&nbsp;&nbsp;&nbsp;for d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">&gt; a</font><font face="Arial" color="#000100" size="3"><br><br>The parameter </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> controls the rate of decline of correlation with distance:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> large </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; slow decay<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a </font><font face="Arial" color="#000100" size="3">small </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; rapid decay<br><br>The disc function leads to an approximately linear decrease in correlation with increasing distance, with correlation declining to zero at a distance equal to </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">. </font><font face="Arial" color="#000100" size="3"><em>Again, it is advisable to choose a prior for </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><em>that prevents the correlation at the maximum distance between observations in the study region from being too high, since this can lead to identifiability problems between the overall mean, </em></font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"><em>, of the spatial random variables and the correlation parameter,</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em>. An upper prior bound on </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> equal to a small multiple of the maximum distance in the study region is therefore a sensible 'default' choice. The minimum value allowed a priori for </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> should also be chosen carefully since values of </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> less than the minimum distance between observations in the study region will not be identifiable.<br></em></font><font face="Arial" color="#000100" size="3"><br>Exploratory analysis using variograms maybe be helpful to help chose an appropriate specification for the correlation function and associated parameters. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Conditional">Conditional specification</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="2">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="2"><u>top</a></u></font><font face="Arial" color="#000100" size="2">] <br></font><font face="Arial" color="#000100" size="3"><br>By writing the between-area covariance matrix in the following form:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v</font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = v(</font><font face="Arial" color="#000100" size="3"><strong>I</strong></font><font face="Arial" color="#000100" size="3"> - </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M<br><br></strong></font><font face="Arial" color="#000100" size="3">where </font><font face="Arial" color="#000100" size="3"><strong>I </strong></font><font face="Arial" color="#000100" size="3">= N x N identity matrix<br></font><font face="Arial" color="#000100" size="3"><strong>M </strong></font><font face="Arial" color="#000100" size="3">= N x N diagonal matrix, with elements M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> proportional to the conditional variance of S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="3"><strong>C </strong></font><font face="Arial" color="#000100" size="3">= N x N weight matrix, with elements C</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> reflecting spatial association between areas i and j<br></font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3">= controls overall strength of spatial dependence<br><br>and using standard multivariate normal theory (e.g. Johnson and Kotz, 1972; Besag and Kooperberg, 1995), the joint multivariate Gaussian model can be expressed in the form of a set of conditional distributions<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal (</font><font face="Symbol" color="#000100" size="3">m </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3">C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> (s</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">-m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> ), <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(here </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> denotes summation over j = 1 to N, not covariance matrix, and </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes all the elements of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> except S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>From a modelling perspective, use of the joint formulation requires specification of the elements of the covariance matrix </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> (see above), while use of the conditional formulation reduces to specification of the matrices </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> and the spatial dependence parameter </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3">. Various constraints are needed on the values of </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> in order to ensure that </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is symmetric positive definite:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* S</strong></font><font face="Arial" color="#000100" size="3"> is only symmetric if C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>jj</sub></font><font face="Arial" color="#000100" size="3"> = C</font><font face="Arial" color="#000100" size="2"><sub>ji</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Var( S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) = vM</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> &gt; 0 so M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> must be &gt; 0</font><font face="Symbol" color="#000100" size="3"><strong><br>&nbsp;&nbsp;&nbsp;* </strong></font><font face="Arial" color="#000100" size="3">To ensure S is positive definite, </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> must lie between </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>min </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>max </sub></font><font face="Arial" color="#000100" size="3">where </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>min</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;g </font><font face="Arial" color="#000100" size="3"><sub>max</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are the smallest and largest eigenvalues of </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>-1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong><br>&nbsp;&nbsp;&nbsp;* </strong></font><font face="Arial" color="#000100" size="3">In practice, we often expect positive spatial dependence, so constrain prior for </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> to be between 0 and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> = 0 implies no spatial dependence</font><font face="Arial" color="#000100" size="3"><sub><br><br></sub></font><font face="Arial" color="#000100" size="3"><strong><sub><a id="Intrinsic">Intrinsic CAR model</a></sub></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="3"><strong><sub><br></sub></strong></font><font face="Arial" color="#000100" size="3"><br>Besag, York and Mollie (1991) propose an intrinsic version of this CAR model in which the covariance matrix </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is not positive definite. Their model corresponds to choosing C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> if areas i and j are adjacent and C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise (with C</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> also set to 0), M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, and setting </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">which turns out to always be 1 with this particular choice of C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> and M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3">. Here, n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the number of areas which are adjacent to area i. Comparison with the equations above shows that this leads to the following model for the conditional distribution of S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> :<br><br>S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal ( S.bar</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, v / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">)<br><br>where S.bar</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> in </sub></font><font face="Symbol" color="#000100" size="3"><sub>d</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes the set of labels of the &quot;neighbours&quot; of area i. Hence S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> has a normal distribution with conditional mean given by the average of the neighbouring S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">'s and conditional variance inversely proportional to the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> . Note that an equivalent specification is take </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 if areas i and j are adjacent and W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise, and set C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> / W</font><font face="Arial" color="#000100" size="2"><sub>i+</sub></font><font face="Arial" color="#000100" size="3"> where W</font><font face="Arial" color="#000100" size="2"><sub>i+</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">. The </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> and (</font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3">) distributions in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> requires the user to specify </font><font face="Arial" color="#000100" size="3"><em>unnormalised weights</em></font><font face="Arial" color="#000100" size="3">.<br><br>Since the CAR model defined above is improper (the overall mean of the S</font><font face="Arial" color="#000100" size="3"><sub>i </sub></font><font face="Arial" color="#000100" size="3">is not defined), it can only be used as a prior distribution for spatially distributed random effects, and not as a likelihood for data. It is often convenient to assume that suchrandom effects have zero mean. Besag and Kooperberg (1995) show that constraining the random effects to sum to zero and specifying a separate intercept term with a location invariant Uniform(-infty, +infty) prior is equivalent to the unconstrained parameterisation with no separate intercept. WinBUGS 1.4 includes a distribution called </font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> which corresponds to an improper (flat) prior on the whole real line. This prior must always be used for the intercept term in a model including CAR random effects.<br><br>We must also specify prior distributions for the overall variance parameter v. As usual in WinBUGS, the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> (and </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3">) distributions are parameterised in terms of the precision </font><font face="Symbol" color="#000100" size="3">t </font><font face="Arial" color="#000100" size="3">= 1/</font><font face="Arial" color="#000100" size="3">v</font><font face="Symbol" color="#000100" size="3"> . </font><font face="Arial" color="#000100" size="3">Care is needed when choosing a prior for</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="3"> since the posterior variance of the random effects can be quite sensitive. One option is a gamma</font><font face="Arial" color="#000100" size="3"> distribution with shape and inverse scale parameters both equal to 0.01. This has a mean of 0.01/0.01 = 1 and a large variance of 0.01/(0.01)</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> = 100; however, this tends to place most of the prior mass away from zero (on the scale of the random effects standard deviation), and so in situations when the true spatial dependence between areas is negligible (i.e. standard deviation close to zero) this may induce artefactual spatial structure in the posterior. Kelsall and Wakefield (1999) suggest an alternative gamma(0.5, 0.0005) prior for the precision parameter of the spatial random effects in a CAR model. This expresses the prior belief that the random effects standard deviation is centered around 0.05 with a 1% prior probability of being smaller than 0.01 or larger than 2.5. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Proper">Proper CAR model</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]<br><br>If </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> is constrained to lie in the interval (</font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) where </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are the smallest and largest eigenvalues of </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>-1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> as defined above, rather than being fixed to its maximum as in the intrinsic CAR, then the resulting distribution is proper provided the constraints on </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> are still satisfied. The choice C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> if areas i and j are adjacent and C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise (with C</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> also set to 0) and M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, where n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the number of areas which are adjacent to area i is still valid for the proper CAR. In the context of disease mapping Cressie and Chan (1989) and Stern and Cressie (1999) choose an alternative parameterisation:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> (the inverse of the expected count or population size in area i)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = (E</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> / E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">for neighbouring areas i, j and 0 otherwise<br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="MV">Multivariate intrinsic CAR model</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]<br><br>Assume we have a multivariate p-dimensional vector of spatially correlated Gaussian data or random effects in each area, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = (S</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> , S</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3">,....., S</font><font face="Arial" color="#000100" size="2"><sub>pi</sub></font><font face="Arial" color="#000100" size="3"> )', i=1,..., N. The CAR models discussed above extend naturally to a multivariate setting by replacing the univariate Gaussian conditional distribution for S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">with a multivariate conditional distribution. In the case of the intrinsic CAR prior with 0-1 adjacency weights as used by Besag, York and Mollie (1991), and taking the case of p = 2 for simplicity, this gives:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | (</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>1(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>2(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">) ~ Bivariate Normal (</font><font face="Arial" color="#000100" size="3"><strong>S.bar</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>V</strong></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">), <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(here (</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>1(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>2(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">) denotes the elements of the 2 x N matrix S excluding the ith area (column))<br><br>where </font><font face="Arial" color="#000100" size="3"><strong>S.bar</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">(</font><font face="Arial" color="#000100" size="3">S.bar</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">,</font><font face="Symbol" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">S.bar</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3">) with S.bar</font><font face="Arial" color="#000100" size="2"><sub>ip</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>j in </sub></font><font face="Symbol" color="#000100" size="2"><sub>d</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>jp</sub></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and, as in the univariate case, </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denote the set of labels of the &quot;neighbours&quot; of area i and the number of neighbours, respectively. </font><font face="Arial" color="#000100" size="3"><strong>V</strong></font><font face="Arial" color="#000100" size="3"> is a 2 x 2 covariance matix with diagonal elements v</font><font face="Arial" color="#000100" size="2"><sub>11</sub></font><font face="Arial" color="#000100" size="3"> and v</font><font face="Arial" color="#000100" size="2"><sub>22</sub></font><font face="Arial" color="#000100" size="3"> representing the conditional variances of S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and S</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">respectively, and off-diagonal element v</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3"> representing the (conditional) within-area covariance between S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and S</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">. In general </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> has a p-dimensional multivariate normal distribution with pth element of the conditional mean vector given by the average of the neighbouring S</font><font face="Arial" color="#000100" size="2"><sub>jp</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">'s and conditional covariance matrix inversely proportional to the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, with pth diagonal element representing the conditional variance of the pth component of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> and off-diagonal elements representing the conditional covariances between each pair of the p elements of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3">. <br><br>Gelfand and Vounatsou (2003) discuss a multivariate generalisation of the proper version of CAR distribution, but only the improper intrinsic multivariate CAR is currently implemented in WinBUGS. <br><br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Appendix 2">Appendix 2: Technical details of the Poisson-gamma Spatial Moving Average convolution model .</a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]<br><br>Spatial moving average models are a flexible class of models that have been used to describe continuous spatial processes, particularly in geostatistical applications. Such models are constructed by integrating a simple two-dimensional random noise process (for example, a grid of iid Gaussian random variables) with a smoothing kernel that is a function of distance and, possibly, location. The kernel can be thought of as a device to `smear out' the random noise process in two-dimensional space to give a smooth surface.<br><br>Spatial moving average models have been developed primarily for continuous spatial processes and are currently not implementable in WinBUGS 1.4. However, Ickstadt and Wolpert (1998) and Best et al (2000b) proposed a discrete version of a gamma moving average process, for use in identity-link Poisson regression models. Suppose we have a set of area-specific spatially correlated Poisson count data (or random effects) S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, i=1,..., N (where N is the number of areas in the study region). Ickstadt and Wolpert (1998) and Best et al (2000b) model spatial dependence at the level of the Poisson mean, and assume that the counts S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> are conditionally independent given this mean:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Poisson( </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) <br><br>The model for each </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is constructed by specifying an arbitrary grid of latent iid gamma random variables </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> (j=1,...,J where J is the total number of grid cells defining the latent process) covering the study region. These are then convolved with a kernel matrix whose elements, k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">, represent the relative contribution of the latent variable in grid cell j to the Poisson mean in area i:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"><sub> </sub></font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>Best et al (2000b) assume an isotropic, stationary Gaussian kernel function (although other kernel forms are easily accommodated, such as an adjacency-based kernel - see <a href="#forest"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;5</u></font><font face="Arial" color="#000100" size="3"></a>):<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> / (2</font><font face="Symbol" color="#000100" size="3">p r</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) exp(</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> / 2</font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">)<br><br>where </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> can be thought of as a scale factor for the </font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="3">'s, d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is the distance between the centroid of area i and the centroid of latent grid cell j, and </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3"> is the spatial range parameter governing how rapidly the influence of the latent gamma random variables on the area-specific Poisson means declines with distance. <br><br>One interpretation of Poisson-gamma moving average model is to view the gamma random variables as representing the location and magnitude of unmeasured risk factors, and the area-specific Poisson means </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">as representing the cumulative effect of these risk factors in each area, weighted by their distance from the area according to the kernel 'weights' k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">. <br><br>The model may be extended to include observed covariates and an offset adjustment (e.g. to account for different populations in different areas). Observed covariates are included as additive terms in the linear predictor </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">as in a standard identity link Poisson regression:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>where X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the value of the kth observed covariate in area i. Note that due to the identity link, all covariates and regression coefficients must take positive values, yielding an interpretation as additive excess risk factors. The latent terms </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">may then be thought of as a spatial (non-negative) random effect for area i. Adjustment for an offset - say the population living in each area, N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> - is easily achieved by setting </font><font face="Symbol" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>Note that Best et al (2004) discuss how to standardise the offset N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for different age and sex distributions within each area in an epidemiological application of these models. <br><br>Estimation of the </font><font face="Arial" color="#000100" size="3"><strong><em>pois.conv</em></strong></font><font face="Arial" color="#000100" size="3"> distribution is carried out in WinBUGS 1.4 using a data augmentation scheme to exploit the Poisson-gamma conjugacy of the full conditionals for the </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">parameters (see Ickstadt and Wolpert (1998) and Best et al (2000b) for details). It is also a good idea to assume gamma prior distributions for any other uncertain parameters in the linear predictor </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> (e.g. the </font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">parameters above) to exploit this conjugacy, although it is possible to assume any suitable prior distribution with positive support for these other parameters. Hyperprior specification is discussed in detail by Ickstadt and Wolpert (1998) and Best et al (2000b). Note however that the prior shape (a) and precision (b) parameters of the latent gamma variables should be chosen such that </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">has prior mean proportional to the area of the j</font><font face="Arial" color="#000100" size="2"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> latent grid cell. This makes the model spatially extensible in the sense that any partition of the latent gamma random variables will lead to identical probability distributions for the kernel-weighted sums </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Refs">References</a> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3"><u>top</a></u></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br>Besag, J., York, J. and Mollie, A. (1991). Bayesian image restoration, with two applications in spatial statistics.</font><font face="Arial" color="#000100" size="2"><em> Annals of the Institute of Statistical Mathematics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>43</strong></font><font face="Arial" color="#000100" size="2">, 1--59, (With discussion).<br><br>Besag, J. and Kooperberg, C.L. (1995). On conditional and intrinsic autoregressions. </font><font face="Arial" color="#000100" size="2"><em>Biometrika</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>82</strong></font><font face="Arial" color="#000100" size="2">, 733--746.</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="2">Best, N.G., Richardson, S. and Thomson, A. (2004). A comparison of Bayesian spatial models for disease mapping. </font><font face="Arial" color="#000100" size="2"><em>Statistical Methods in Medical Research</em></font><font face="Arial" color="#000100" size="2"> (to appear).<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Best, N.G., Ickstadt, K.and Wolpert, R.L. and Briggs, D.J. (2000a). </font><font face="Arial" color="#000100" size="2"><em>Journal of the American Statistical Association</em></font><font face="Arial" color="#000100" size="2">,</font><font face="Arial" color="#000100" size="2"><strong> 95</strong></font><font face="Arial" color="#000100" size="2">, 1076-1088.<br><br>Best, N.G., Ickstadt, K., Wolpert, R.L. and Briggs, D.J. (2000b). Combining models of health and exposure data: the SAVIAH study. In </font><font face="Arial" color="#000100" size="2"><em>Spatial Epidemiology: Methods and Applications</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J.C. Wakefield, N.G. Best and D.J. Briggs (eds), Oxford: Oxford University Press, p. 393-414.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Clayton, D.G and Kaldor, J. (1987). Empirical Bayes estimates of age-standardized relative risks for use in disease mapping. </font><font face="Arial" color="#000100" size="2"><em>Biometrics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>43</strong></font><font face="Arial" color="#000100" size="2">, 671--681.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Cressie, N.A. and Chan, N.H. (1989). Spatial modeling of regional variables. </font><font face="Arial" color="#000100" size="2"><em>Journal of the American Statistical Association</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>84</strong></font><font face="Arial" color="#000100" size="2">, 393--401.</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2"><br>Diggle, P.J., Tawn, J.A. and Moyeed, R.A. (1998). Model-based geostatistics. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>47</strong></font><font face="Arial" color="#000100" size="2">, 299-350.<br><br>Fahrmeir, L. and Lang, S. (2001). Bayesian inference for generlaized additive mixed models based on Markov random field priors. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>50</strong></font><font face="Arial" color="#000100" size="2">, 201-220.<br><br>Gelfand, A. and Vounatsou, P. (2003). Proper multivariate conditional autoregressive models for spatial data analysis. </font><font face="Arial" color="#000100" size="2"><em>Biostatistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>4</strong></font><font face="Arial" color="#000100" size="2">, 11-25.<br><br>Ickstadt, K. and Wolpert, R.L. (1998). Multiresolution assessment of forest inhomogeneity. In </font><font face="Arial" color="#000100" size="2"><em>Case Studies in Bayesian Statistics, Volume 3. </em></font><font face="Arial" color="#000100" size="2">Lecture Notes in Statistics, </font><font face="Arial" color="#000100" size="2"><strong>121</strong></font><font face="Arial" color="#000100" size="2">. C. Gatsonis, J.S. Hodges, R.E. Kass, R. McCulloch, P. Rossi and N.D. Singpurwalla (eds), New York: Springer-Verlag, p. 371-386.<br><br>Johnson, N.L. and Kotz, S. (1972). </font><font face="Arial" color="#000100" size="2"><em>Distributions in Statistics: continuous multivariate</em></font><font face="Arial" color="#000100" size="2">. Wiley: New York.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Kelsall, J.E. and Wakefield, J.C. (1999). Discussion of &quot;Bayesian models for spatially correlated disease and exposure data&quot;, by Best </font><font face="Arial" color="#000100" size="2"><em>et al.</em></font><font face="Arial" color="#000100" size="2"> In</font><font face="Arial" color="#000100" size="2"><em> Bayesian Statistics 6</em></font><font face="Arial" color="#000100" size="2">. J.M. Bernardo, J.O. Berger, A.P. Dawid and A.F.M. Smith (eds), Oxford: Oxford University Press, p. 151.<br><br>Knorr-Held L. and Best N.G. (2001). A shared component model for joint and selective clustering of two diseases. </font><font face="Arial" color="#000100" size="2"><em>Journal of the Royal Statistical Society, Series A</em></font><font face="Arial" color="#000100" size="2">. </font><font face="Arial" color="#FF00FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br>Mollie, A. (1996). Bayesian mapping of disease. In </font><font face="Arial" color="#000100" size="2"><em>Markov Chain Monte Carlo in Practice</em></font><font face="Arial" color="#000100" size="2">. W.R. Gilks, S. Richardson and D.J. Spiegelhalter (eds.), New York: Chapman &amp; Hall, pp. 359--379.<br><br>Richardson, S. (1992). Statistical methods for geographical correlation studies. In </font><font face="Arial" color="#000100" size="2"><em>Geographical and Environmental Epidemiology</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J. Cuzick, D. English and R. Stern (eds.), Oxford: Oxford University Press, p. 181-204.<br><br>Shaddick, G. and Wakefield, J. (2002). Modelling daily multivariate pollutant data at multiple sites. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>51</strong></font><font face="Arial" color="#000100" size="2">, 351-372.<br><br>Stern, H.S. and Cressie, N.A. (1999). Inference for extremes in disease mapping. In </font><font face="Arial" color="#000100" size="2"><em>Disease mapping and risk assessment for public health</em></font><font face="Arial" color="#000100" size="2">. A. Lawson, A. Biggeri, D. Bohning, E. Lesaffre, J-F. Viel and R. Bertollini (eds.), Chichester: Wiley, p. 63--84.<br><br>Wakefield, J.C., Best, N.G., and Waller, L.A. (2000). Bayesian Approaches to Disease Mapping. In </font><font face="Arial" color="#000100" size="2"><em>Spatial Epidemiology: Methods and Applications</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J.C. Wakefield, N.G. Best and D.J. Briggs (eds), Oxford: Oxford University Press, p. 104-127.<br><br>Wolpert, R.L. and Ickstadt, K. (1998). Poisson/Gamma random field models for spatial statistics. </font><font face="Arial" color="#000100" size="2"><em>Biometrika</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>85</strong></font><font face="Arial" color="#000100" size="2">, 251-267.</font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Equivmodel</title></head><body><p><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( k in 1 : P ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i , k] ~ dnorm(m[i , k], tau1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m[i , k] &lt;- mu + sign[T[i , k]] * phi / 2 + sign[k] * pi / 2 + delta[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[i , k] &lt;- group[i] * (k - 1.5) + 1.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta[i] ~ dnorm(0.0, tau2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau1 ~ dgamma(0.001, 0.001) sigma1 &lt;- 1 / sqrt(tau1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau2 ~ dgamma(0.001, 0.001) sigma2 &lt;- 1 / sqrt(tau2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta &lt;- exp(phi)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equiv &lt;- step(theta - 0.8) - step(theta - 1.2)<br>&nbsp;&nbsp;&nbsp;}<br></font></p></body></html>
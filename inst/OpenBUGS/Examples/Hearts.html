<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Hearts</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Hearts: a mixture model for count data</strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3"><br>The table below presents data given by Berry (1987) on the effect of a drug used to treat patients with frequent premature ventricular contractions (PVCs) of the heart. </font><font face="Arial" color="#000100" size="2"><img src="hearts1.jpg" alt="[hearts1]"></font><font face="Arial" color="#000100" size="3"><br>Farewell and Sprott (1988) model these data as a mixture distribution of Poisson counts in which some patients are &quot;cured&quot; by the drug, whilst others experience varying levels of response but remain abnormal. A zero count for the post-drug PVC may indicate a &quot;cure&quot;, or may represent a sampling zero from a patient with a mildly abnormal PVC count. The following model thus is assumed:<br><br>&nbsp;&nbsp;&nbsp;x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Poisson(</font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;for all patients<br>&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Poisson(</font><font face="Symbol" color="#000100" size="3">bl</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;for all </font><font face="Arial" color="#000100" size="3"><em>uncured </em></font><font face="Arial" color="#000100" size="3">patients<br>&nbsp;&nbsp;&nbsp;P(cure)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">To eliminate nuisance parameters l</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3">, Farewell and Sprott use the conditional distribution of y</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3"> given t</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3"> = x</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3"> + y</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3">. This is equivalent to a binomial likelihood for y</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3"> with denominator t</font><font face="Arial" color="#000100" size="2">i</font><font face="Arial" color="#000100" size="3"> and probability p = b /(1+b) (see Cox and Hinkley, 1974 pp. 136-137 for further details of the conditional distribution for Poisson variables). Hence the final mixture model may be expressed as follows:<br><br>&nbsp;&nbsp;&nbsp;P(y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 0 | t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"> + (1 </font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="3">) (1 </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> p) t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;P(y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;(1 </font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="3">) (t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">! / (y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">! (t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)!)) (p</font><font face="Arial" color="#000100" size="2"><sup>y</sup></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(1 </font><font face="Symbol" color="#000100" size="3">- </font><font face="Arial" color="#000100" size="3">p)</font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sup>(t</sup></font><font face="Arial" color="#000100" size="2"><sup>i </sup></font><font face="Symbol" color="#000100" size="2"><sup>-</sup></font><font face="Arial" color="#000100" size="2"><sup> y</sup></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="2"><sup>)</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 1,2,...,t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>The BUGS code for this model is given below:<br><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dbin(P[state1[i]], t[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state[i] ~ dbern(theta)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state1[i] &lt;- state[i] + 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[i] &lt;- x[i] + y[i] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop[i] &lt;- P[state1[i]] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P[1] &lt;- p <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P[2] &lt;- 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p) &lt;- alpha<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0,1.0E-4)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta &lt;- exp(alpha) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(theta) &lt;- delta <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta ~ dnorm(0, 1.0E-4)<br>&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Heartsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Heartsinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5">Results </font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br></font><font face="Arial" color="#000000" size="2"><img src="hearts2.jpg" alt="[hearts2]"></center></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Air</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="air0.bmp" alt="[air0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="6">Air: Berkson measurement error</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">Whittemore and Keller (1988) use an approximate maximum likelihood approach to analyse the data shown below on reported respiratory illness versus exposure to nitrogen dioxide (NO</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">) in 103 children. Stephens and Dellaportas (1992) later use Bayesian methods to analyse the same data. </font><font face="Arial" color="#000100" size="2"><br><center><img src="air1.bmp" alt="[air1]"><br></center><br></font><font face="Arial" color="#000100" size="3">A discrete covariate z</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> (j = 1,2,3) representing NO</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> concentration in the child's bedroom classified into 3 categories is used as a surrogate for true exposure. The nature of the measurement error relationship associated with this covariate is known precisely via a calibration study, and is given by</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> z</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">e</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> <br><br>where </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> = 4.48, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> = 0.76 and </font><font face="Symbol" color="#000100" size="3">e</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> is a random element having normal distribution with zero mean and variance </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><sup> (</sup></font><font face="Arial" color="#000100" size="3">=</font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">1/</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"><sup>)</sup></font><font face="Arial" color="#000100" size="3"> = 81.14. Note that this is a Berkson (1950) model of measurement error, in which the true values of the covariate are expressed as a function of the observed values. Hence the measurement error is independent of the latter, but is correlated with the true underlying covariate values. In the present example, the observed covariate z</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> takes values 10, 30 or 50 for j = 1, 2, or 3 respectively (i.e. the mid-point of each category), whilst x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> is interpreted as the &quot;true average value&quot; of NO</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> in group j. The response variable is binary, reflecting presence/absence of respiratory illness, and a logistic regression model is assumed. That is <br><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(p</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">where p</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> is the probability of respiratory illness for children in the jth exposure group. The regression coefficients </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> are given vague independent normal priors. The graphical model is shown below:<br></font><font face="Arial" color="#000100" size="2"><center></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="air2.bmp" alt="[air2]"><br></strong></font><font face="Arial" color="#000100" size="1"><br></center><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : J) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[j] ~ dbin(p[j], n[j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p[j]) &lt;- theta[1] + theta[2] * X[j]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X[j] ~ dnorm(mu[j], tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[j] &lt;- alpha + beta * Z[j]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[1] ~ dnorm(0.0, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[2] ~ dnorm(0.0, 0.001)<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/airdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/airinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5">Results <br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates <br><center></font><font face="Arial" color="#000000" size="2"><br><img src="air3.bmp" alt="[air3]"></center></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="3">Re-parameterised model with centred covariates:&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( j in 1 : J ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[j] ~ dbin(p[j],n[j])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(p[j]) &lt;- theta0+ theta[2] * (X[j] - mean(mu[]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">X[j] ~ dnorm(mu[j],tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[j] &lt;- alpha + beta * Z[j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">theta0 ~ dnorm(0.0,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">theta[2] ~ dnorm(0.0,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">theta[1] &lt;- theta0 - theta[2] * mean(mu[])<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/airinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#0000FF" size="5">Results <br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates, with over-relaxation.<br><center></font><font face="Arial" color="#000000" size="2"><br><img src="air4.bmp" alt="[air4]"></center></font><font face="Arial" color="#000100" size="2"><br><br></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>t-df</title></head><body><p><font face="Arial" color="#000000" size="5"><strong><img src="t-df0.bmp" alt="[t-df0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Simulating data: learning about the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;degrees of freedom of a <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-distribution</font><font face="Arial" color="#000000" size="5"><strong><br></strong></font><font face="Arial" color="#000000" size="2"><strong><br></strong></font><font face="Arial" color="#000000" size="3">This example uses simulated data: we generate n = 1000 observations from a (standard) t distribution with </font><font face="Arial" color="#000000" size="3"><em>d = 4</em></font><font face="Arial" color="#000000" size="3"> degrees of freedom:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;d &lt;- 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : 1000) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dt(0, 1, d)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>We let the sampler run for a while (just to check that we're simulating from the correct distribution) and then we save a set of simulated data using the 'save state' facility (select </font><font face="Arial" color="#000000" size="3"><em>Save State</em></font><font face="Arial" color="#000000" size="3"> from the </font><font face="Arial" color="#000000" size="3"><em>Model</em></font><font face="Arial" color="#000000" size="3"> menu).<br><br>Check: should have mean 0, variance 2, etc.<br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;y[1]&nbsp;&nbsp;&nbsp;0.01129&nbsp;&nbsp;&nbsp;1.383&nbsp;&nbsp;&nbsp;0.01415&nbsp;&nbsp;&nbsp;-2.645&nbsp;&nbsp;&nbsp;-0.01056&nbsp;&nbsp;&nbsp;2.843&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000000" size="3"><br>&nbsp;&nbsp;&nbsp;<img src="t-df1.bmp" alt="[t-df1]"></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000000" size="3">To analyse the simulated data: first we try a model for learning about the degrees of freedom as a continuous quantity:<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Model:<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:1000) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dt(0, 1, d)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;d ~ dunif(2, 100)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# degrees of freedom must be at least two<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;d&nbsp;&nbsp;&nbsp;4.282&nbsp;&nbsp;&nbsp;0.4398&nbsp;&nbsp;&nbsp;0.01448&nbsp;&nbsp;&nbsp;3.493&nbsp;&nbsp;&nbsp;4.252&nbsp;&nbsp;&nbsp;5.217&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br><br></font><font face="Arial" color="#0000FF" size="2"><img src="t-df2.bmp" alt="[t-df2]"><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000000" size="3">Now we attempt to model the degrees of freedom parameter with a discrete uniform prior on {2, 3, 4, ..., 50}. The sampler soon converges to </font><font face="Arial" color="#000000" size="3"><em>d</em></font><font face="Arial" color="#000000" size="3"> = 4 but mixes poorly.<br></font><font face="Arial" color="#0000FF" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Model:<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (j in 1:49) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[j] &lt;- 1 / 49<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.value[j] &lt;- j + 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:1000) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dt(0, 1, d)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;K ~ dcat(p[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;d &lt;- d.value[K]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;d&nbsp;&nbsp;&nbsp;4.204&nbsp;&nbsp;&nbsp;0.4102&nbsp;&nbsp;&nbsp;0.03144&nbsp;&nbsp;&nbsp;4.0&nbsp;&nbsp;&nbsp;4.0&nbsp;&nbsp;&nbsp;5.0&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong><img src="t-df3.bmp" alt="[t-df3]"><br></strong></font><font face="Arial" color="#000000" size="3"><br>We should get better mixing if we specify the prior for </font><font face="Arial" color="#000000" size="3"><em>d</em></font><font face="Arial" color="#000000" size="3"> on a finer grid, e.g. {2.0, 2.1, 2.2, ..., 6.0}:<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Model:<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1:41) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[j] &lt;- 1 / 41<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.value[j] &lt;- 2 + (j - 1) * 0.1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:1000) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dt(0, 1, d)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;K ~ dcat(p[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;d &lt;- d.value[K]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;d&nbsp;&nbsp;&nbsp;4.277&nbsp;&nbsp;&nbsp;0.4162&nbsp;&nbsp;&nbsp;0.01194&nbsp;&nbsp;&nbsp;3.5&nbsp;&nbsp;&nbsp;4.3&nbsp;&nbsp;&nbsp;5.1&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;10000<br><br><br><img src="t-df4.bmp" alt="[t-df4]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Simulated data:<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;click to opensimulated t4 data&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"></font></p></body></html>
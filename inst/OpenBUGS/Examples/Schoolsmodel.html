<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Schoolsmodel</title></head><body><p><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(p in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[p] ~ dnorm(mu[p], tau[p])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[p] &lt;- alpha[school[p], 1] + alpha[school[p], 2] * LRT[p] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ alpha[school[p], 3] * VR[p, 1] + beta[1] * LRT2[p] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta[2] * VR[p, 2] + beta[3] * Gender[p] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta[4] * School.gender[p, 1] + beta[5] * School.gender[p, 2]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta[6] * School.denom[p, 1] + beta[7] * School.denom[p, 2]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta[8] * School.denom[p, 3]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(tau[p]) &lt;- theta + phi * LRT[p]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma2[p] &lt;- 1 / tau[p]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LRT2[p] &lt;- LRT[p] * LRT[p]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min.var &lt;- exp(-(theta + phi * (-34.6193))) # lowest LRT score = -34.6193<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max.var &lt;- exp(-(theta + phi * (37.3807))) # highest LRT score = 37.3807<br><br>&nbsp;&nbsp;&nbsp;# Priors for fixed effects:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : 8) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[k] ~ dnorm(0.0, 0.0001) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta ~ dnorm(0.0, 0.0001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi ~ dnorm(0.0, 0.0001)<br><br>&nbsp;&nbsp;&nbsp;# Priors for random coefficients:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : M) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[j, 1 : 3] ~ dmnorm(gamma[1:3 ], T[1:3 ,1:3 ]); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha1[j] &lt;- alpha[j,1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;# Hyper-priors:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma[1 : 3] ~ dmnorm(mn[1:3 ], prec[1:3 ,1:3 ]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[1 : 3, 1 : 3 ] ~ dwish(R[1:3 ,1:3 ], 3)<br>&nbsp;&nbsp;&nbsp;}<br></font></p></body></html>
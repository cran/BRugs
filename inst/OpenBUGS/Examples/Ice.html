<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Ice</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Ice: non-parametric smoothing in an age-cohort<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Breslow and Clayton (1993) analyse breast cancer rates in Iceland by year of birth (K = 11 cohorts from 1840-1849 to 1940-1949) and by age (J =13 groups from 20-24 to 80-84 years). Due to the number of empty cells we consider a single indexing over I = 77 observed number of cases, giving data of the following form.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="ice1.jpg" alt="[ice1]"></center></font><font face="Arial" color="#000100" size="3"><br>In order to pull in the extreme risks associated with small birth cohorts, Breslow and<br>Clayton first consider the exchangeable model<br><br><br>&nbsp;&nbsp;&nbsp;cases</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;log person-years</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>age</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>year</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Normal( 0, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> )<br><br></font><font face="Arial" color="#000100" size="3"><strong>Autoregressive smoothing of relative risks</strong></font><font face="Arial" color="#000100" size="3"><br><br>They then consider the alternative approach of smoothing the rates for the cohorts by assuming an auto-regressive model on the </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">'s, assuming the second differences are independent normal variates. This is equivalent to a model and prior distribution <br>&nbsp;&nbsp;&nbsp;cases</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;log person-years</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>age</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>year</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Normal( 0, 0.000001</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> )<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">|</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Normal( 0, 0.000001</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> )<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">|</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1,...,k-1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Normal( 2 </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>k-1</sub></font><font face="Symbol" color="#000100" size="3">- b</font><font face="Arial" color="#000100" size="2"><sub>k-2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> ) k &gt; 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>We note that </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> are given &quot;non-informative&quot; priors, but retain a </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> term in order to provide the appropriate likelihood for </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">.<br><br>For computational reasons Breslow and Clayton impose constraints on their random effects </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>k </sub></font><font face="Arial" color="#000100" size="3">in order that their mean and linear trend are zero, and counter these constraints by introducing a linear term b x year</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and allowing unrestrained estimation of </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>j</sub></font><font face="Arial" color="#000100" size="3">. Since we allow free movement of the </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">'s we dispense with the linear term, and impose a &quot;corner&quot; constraint </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> =0 . <br></font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:I) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cases[i] ~ dpois(mu[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i]) &lt;- log(pyr[i]) + alpha[age[i]] + beta[year[i]]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[1] &lt;- 2 * beta[2] - beta[3]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[1] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[2] &lt;- (2 * beta[1] + 4 * beta[3] - beta[4]) / 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[2] &lt;- 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 3 : K - 2) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[k] &lt;- (4 * beta[k - 1] + 4 * beta[k + 1]- beta[k - 2] - beta[k + 2]) / 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[k] &lt;- 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[K - 1] &lt;- (2 * beta[K] + 4 * beta[K - 2] - beta[K - 3]) / 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[K - 1] &lt;- 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[K] &lt;- 2 * beta[K - 1] - beta[K - 2] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[K] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betaprec[k] &lt;- Nneighs[k] * tau<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[k] ~ dnorm(betamean[k], betaprec[k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logRR[k] &lt;- beta[k] - beta[5]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.like[k] &lt;- Nneighs[k] * beta[k] * (beta[k] - betamean[k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[1] &lt;- 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 : Nage) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[j] ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d &lt;- 0.0001 + sum(tau.like[]) / 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r &lt;- 0.0001 + K / 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(r, d)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Examples/Icedata.html"></u></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="3"><u><a href="../Examples/Iceinits.html"></u></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5">Results <br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 100000 updates gave the parameter estimates<br><center><br></font><font face="Arial" color="#000000" size="2"><img src="ice2.jpg" alt="[ice2]"></center></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>BiRats</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birats: a bivariate normal hierarchical model<br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">We return to the Rats example, and illustrate the use of a multivariate Normal (MVN) population distribution for the regression coefficients of the growth curve for each rat. This is the model adopted by Gelfand etal (1990) for these data, and assumes </font><font face="Arial" color="#000100" size="3"><em>a priori</em></font><font face="Arial" color="#000100" size="3"> that the intercept and slope parameters for each rat are correlated. For example, positive correlation would imply that initially heavy rats (high intercept) tend to gain weight more rapidly (steeper slope) than lighter rats. The model is as follows<br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>b</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ MVN(</font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3"><strong>W</strong></font><font face="Arial" color="#000100" size="3">) <br><br>where Y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is the weight of the ith rat measured at age x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">, and </font><font face="Symbol" color="#000100" size="3"><strong>b</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes the vector </font><font face="Symbol" color="#000100" size="3">(b</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3">). We assume 'non-informative' independent univariate Normal priors for the separate components </font><font face="Symbol" color="#000100" size="3">m</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">m</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">. A Wishart(R, </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3">) prior was specified for </font><font face="Symbol" color="#000100" size="3"><strong>W</strong></font><font face="Arial" color="#000100" size="3">, the population precision matrix of the regression coefficients. To represent vague prior knowledge, we chose the the degrees of freedom </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3"> for this distribution to be as small as possible (i.e. 2, the rank of </font><font face="Symbol" color="#000100" size="3"><strong>W</strong></font><font face="Arial" color="#000100" size="3">). The scale matrix was specified as<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="birats1.jpg" alt="[birats1]"></font><font face="Arial" color="#000100" size="3"><br></center>This represents our prior guess at the order of magnitude of the </font><font face="Arial" color="#000100" size="3"><em>covariance</em></font><font face="Arial" color="#000100" size="3"> matrix </font><font face="Symbol" color="#000100" size="3"><strong>W</strong></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> for </font><font face="Symbol" color="#000100" size="3"><strong>b</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> (see Classic BUGS manual (version 0.5) section on Multivariate normal models), and is equivalent to the prior specification used by Gelfand et al. Finally, a non-informative Gamma(0.001, 0.001) prior was assumed for the measurement precision </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">.<br><center><br></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1"><img src="birats2.jpg" alt="[birats2]"></font><font face="Arial" color="#000100" size="5"><strong><br></center><br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( i in 1 : N ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta[i , 1 : 2] ~ dmnorm(mu.beta[], R[ , ])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( j in 1 : T ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Y[i, j] ~ dnorm(mu[i , j], tauC)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i, j] &lt;- beta[i, 1] + beta[i, 2] * x[j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu.beta[1 : 2] ~ dmnorm(mean[], prec[ , ])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">R[1 : 2 , 1 : 2] ~ dwish(Omega[ , ], 2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tauC ~ dgamma(0.001, 0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- 1 / sqrt(tauC)<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/BiRatsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/BiRatsinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#0000FF" size="5">Results <br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br></font><font face="Arial" color="#000000" size="2"><img src="birats3.jpg" alt="[birats3]"></font><font face="Arial" color="#000100" size="2"><br></center><br></font></p></body></html>
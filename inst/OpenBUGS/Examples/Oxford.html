<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Oxford</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Oxford: smooth fit to log-odds ratios</strong></font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">Breslow and Clayton (1993) re-analyse 2 by 2 tables of cases (deaths from childhood cancer) and controls tabulated against maternal exposure to X-rays, one table for each of 120 combinations of age (0-9) and birth year (1944-1964). The data may be arranged to the following form.<br><center><br><br></font><font face="Arial" color="#000100" size="2"><img src="oxford1.jpg" alt="[oxford1]"></font><font face="Arial" color="#000100" size="3"></center>Their most complex model is equivalent to expressing the log(odds-ratio) </font><font face="Symbol" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for the table in stratum </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> as<br><br>&nbsp;&nbsp;&nbsp;log</font><font face="Symbol" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">year</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">(year</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> - 22) + b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br><br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">They use a quasi-likelihood approximation of the full hypergeometric likelihood obtained by conditioning on the margins of the tables. <br><br>We let r</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denote number of exposures among the n</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> controls in stratum </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">, and r</font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denote number of exposures for the n</font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> cases. The we assume<br><br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="3"><sub><br><br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Binomial(p</font><font face="Arial" color="#000100" size="3"><sup>1</sup></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="3"><sup>1</sup></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sup>0</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + log</font><font face="Symbol" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> <br><br>Assuming this model with independent vague priors for the </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">'s provides the correct conditional likelihood. The appropriate graph is shown below<br></font><font face="Arial" color="#0000FF" size="5"><br><center></font><font face="Arial" color="#000100" size="2"><img src="oxford2.jpg" alt="[oxford2]"><br><br><br></font><font face="Arial" color="#000100" size="3">BUGS</font><font face="Arial" color="#000100" size="3"><em> language for Oxford example:</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r0[i] ~ dbin(p0[i], n0[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r1[i] ~ dbin(p1[i], n1[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p0[i]) &lt;- mu[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p1[i]) &lt;- mu[i] + logPsi[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logPsi[i] &lt;- alpha + beta1 * year[i] + beta2 * (year[i] * year[i] - 22) + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0, tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta1 ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta2 ~ dnorm(0.0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(1.0E-3, 1.0E-3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Oxforddata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/Oxfordinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates <br><center><br></font><font face="Arial" color="#000000" size="2"><img src="oxford3.jpg" alt="[oxford3]"></center><br></font><font face="Arial" color="#000000" size="3">These estimates compare well with Breslow and Clayton (1993) PQL estimates of </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="3"> = 0.566 +/- 0.070, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000000" size="2"><sub>1</sub></font><font face="Arial" color="#000000" size="3"> = -0.469 +/- 0.0167, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000000" size="2"><sub>2</sub></font><font face="Arial" color="#000000" size="3"> = 0.0071 +/- 0.0033, </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000000" size="3"> = 0.15 +/- 0.10.<br></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Rats-drop</title></head><body><p><font face="Arial" color="#0000FF" size="5"><strong><img src="bugsicon.jpg" alt="[bugsicon]">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rats-drop: the rats example, illustrating the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effect of different dropout assumptions<br></strong></font><font face="Arial" color="#000100" size="2"><br>This example is taken from section 6 of Gelfand </font><font face="Arial" color="#000100" size="2"><em>et al</em></font><font face="Arial" color="#000100" size="2"> (1990), and concerns 30 young rats whose weights were measured weekly for five weeks. Part of the data is shown below, where Y</font><font face="Arial" color="#000100" size="1"><sub>ij </sub></font><font face="Arial" color="#000100" size="2">is the weight of the ith rat measured at age x</font><font face="Arial" color="#000100" size="1"><sub>j</sub></font><font face="Arial" color="#000100" size="2">. <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Weights Y</font><font face="Arial" color="#000100" size="1"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"> of rat i on day x</font><font face="Arial" color="#000100" size="1"><sub>j</sub></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</font><font face="Arial" color="#000100" size="1"><sub>j</sub></font><font face="Arial" color="#000100" size="2"> = 8&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;29 &nbsp;&nbsp;&nbsp;36 <br>&nbsp;&nbsp;&nbsp;__________________________________&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;Rat 1&nbsp;&nbsp;&nbsp;151&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;246&nbsp;&nbsp;&nbsp;283&nbsp;&nbsp;&nbsp;320<br>&nbsp;&nbsp;&nbsp;Rat 2&nbsp;&nbsp;&nbsp;145&nbsp;&nbsp;&nbsp;199&nbsp;&nbsp;&nbsp;249&nbsp;&nbsp;&nbsp;293&nbsp;&nbsp;&nbsp;354<br>&nbsp;&nbsp;&nbsp;.......<br>&nbsp;&nbsp;&nbsp;Rat 30&nbsp;&nbsp;&nbsp;153&nbsp;&nbsp;&nbsp;200&nbsp;&nbsp;&nbsp;244&nbsp;&nbsp;&nbsp;286&nbsp;&nbsp;&nbsp;324 <br><br><br>A plot of the 30 growth curves suggests some evidence of downward curvature.<br><br>The model is essentially a random effects linear growth curve<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Y</font><font face="Arial" color="#000100" size="1"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3">(x</font><font face="Arial" color="#000100" size="1"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> - x</font><font face="Arial" color="#000100" size="1"><sub>bar</sub></font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="1"><sub>a</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="1"><sub>b</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>where x</font><font face="Arial" color="#000100" size="1"><sub>bar</sub></font><font face="Arial" color="#000100" size="2"> = 22, and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"> represents the </font><font face="Arial" color="#000100" size="2"><em>precision</em></font><font face="Arial" color="#000100" size="2"> (1/variance) of a normal distribution. We note the absence of a parameter representing correlation between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> unlike in Gelfand </font><font face="Arial" color="#000100" size="2"><em>et al</em></font><font face="Arial" color="#000100" size="2"> 1990. However, see the </font><font face="Courier" color="#000100" size="2">Birats</font><font face="Arial" color="#000100" size="2"> example in Volume 2 which does explicitly model the covariance between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="2">and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2">. For now, we standardise the x</font><font face="Arial" color="#000100" size="1"><sub>j</sub></font><font face="Arial" color="#000100" size="2">'s around their mean to reduce dependence between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="2"> in their likelihood: in fact for the full balanced data, complete independence is achieved. (Note that, in general, prior independence does not force the posterior distributions to be independent).<br><br></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="2"> , </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="1"><sub>a </sub></font><font face="Arial" color="#000100" size="2">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>c </sub></font><font face="Arial" color="#000100" size="2">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="1"><sub>b </sub></font><font face="Arial" color="#000100" size="2">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="1"><sub>c </sub></font><font face="Arial" color="#000100" size="2">are given independent ``noninformative'' priors. Interest particularly focuses on the intercept at zero time (birth), denoted </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>0</sub></font><font face="Arial" color="#000100" size="2"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="2"> - </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="1"><sub>c</sub></font><font face="Arial" color="#000100" size="2"> x</font><font face="Arial" color="#000100" size="1"><sub>bar</sub></font><font face="Arial" color="#000100" size="2">. <br><br></font><font face="Arial" color="#000100" size="3"><center></font><font face="Arial" color="#000100" size="3"><em>Graphical model for rats example:</em></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="rats-drop1.jpg" alt="[rats-drop1]"></strong></font><font face="Arial" color="#000100" size="3"><br><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for rats example:</em></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><br><img src="rats-drop2.jpg" alt="[rats-drop2]"><br><br><br></center><br>Note the use of a very flat but conjugate prior for the population effects: a locally uniform prior could also have been used.</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Data </font><font face="Arial" color="#000100" size="2"> click on one of the arrows to open the data <br><br>(Note: the response data (Y) for the rats example can also be found in the file ratsy.odc in rectangular format. The covariate data (X) can be found in S-Plus format in file ratsx.odc. To load data from each of these files, focus the window containing the open data file before clicking on &quot;Data&quot; from the &quot;Model&quot; menu.)<br><br></font><font face="Arial" color="#0000FF" size="5">Inits </font><font face="Arial" color="#000100" size="2">list( alpha.c = 150, beta.c = 10, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.c = 1, alpha.tau = 1, beta.tau = 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br>Gelfand </font><font face="Arial" color="#000100" size="2"><em>et al</em></font><font face="Arial" color="#000100" size="2"> 1990 also consider the problem of missing data, and delete the last observation of cases 6-10, the last two from 11-20, the last 3 from 21-25 and the last 4 from 26-30. The appropriate data file is obtained by simply replacing data values by NA (see below). The model specification is unchanged, since the distinction between observed and unobserved quantities is made in the data file and not the model specification.<br></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp; click on one of the arrows to open the data for the missing value analysis <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Missing at random gives beta.c estimate of 6.54 (6.26 to 6.84)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Extra data list for sensitivity analysis in informative dropout model</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(k=0.02)</font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="rats-drop3.jpg" alt="[rats-drop3]"><br></font><font face="Arial" color="#000100" size="2"><br>Initial values for informative dropout model, probability of missing depending on Y[i,j] with a as intercept<br></font><font face="Arial" color="#0000FF" size="5">Inits </font><font face="Arial" color="#000100" size="2">list( alpha.c = 250, beta.c =6, tau.c = 1, alpha.tau = 1, beta.tau = 1, a = 0)</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3">Second set of initial values</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2">list( alpha.c = 100, beta.c =4, tau.c = .1, alpha.tau = .1, beta.tau = .1, a = 1)</font><font face="Arial" color="#000100" size="2"><br><br><br><br>With k=.02, get estimate of beta.c</font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;<br><br>node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;beta.c&nbsp;&nbsp;&nbsp;6.273&nbsp;&nbsp;&nbsp;0.15&nbsp;&nbsp;&nbsp;0.009028&nbsp;&nbsp;&nbsp;5.976&nbsp;&nbsp;&nbsp;6.276&nbsp;&nbsp;&nbsp;6.561&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;3000<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="2"><br><br></font></p></body></html>
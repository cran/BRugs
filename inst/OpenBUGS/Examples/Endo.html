<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Endo</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="endo0.bmp" alt="[endo0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Endo: conditional inference in<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case-control studies</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">Breslow and Day (1980) analyse a set of data from a case-control study relating endometrial cancer with exposure to estrogens. 183 pairs of cases and controls were studied, and the full data is shown below.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="endo1.bmp" alt="[endo1]"><br></font><font face="Arial" color="#000100" size="3"></center>We denote estrogen exposure as x</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> for the ith case-control pair, where j=1 for a case and j=2 for a control. The conditional likelihood for the log (odds ratio) </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> is then given by </font><font face="Symbol" color="#000100" size="3">P</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> exp </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> / (exp </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> + exp </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3">)<br><br>We shall illustrate three methods of fitting this model. It is convenient to denote the fixed disease status as a variable Y</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> = 1, Y</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3"> = 0.<br><br>First, Breslow and Day point out that for case-control studies with a single control per case, we may obtain this likelihood by using unconditional logistic regression for each case-control pair. That is<br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Binomial(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">,2)<br>&nbsp;&nbsp;&nbsp;logit p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> (x</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> x</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3">)<br><br>Second, the Classic BUGS manual (version 0.5) section on </font><font face="Arial" color="#000100" size="3"><em>Conditional likelihoods in case-control studies</em></font><font face="Arial" color="#000100" size="3"> discusses fitting this likelihood directly by assuming the model <br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>i.</sub></font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">~&nbsp;&nbsp;&nbsp;Multinomial(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>.</sub></font><font face="Arial" color="#000100" size="3">, 1)<br>&nbsp;&nbsp;&nbsp;p</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;e</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> / </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> e</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;log e</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> x</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><br><br>Finally, the Classic BUGS manual (version 0.5) shows how the multinomial-Poisson transformation can be used. In general, this will be more efficient than using the multinomial-logistic parameterisation above, since it avoids the time-consuming evaluation of </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> e</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">. However, in the present example this summation is only over J=2 elements, whilst the multinomial-Poisson parameterisation involves estimation of an additional intercept parameter for each of the 183 strata. Consequently the latter is </font><font face="Arial" color="#000100" size="3"><em>less</em></font><font face="Arial" color="#000100" size="3"> efficient than the multinomial-logistic in this case.<br><br>We note that all these formulations may be easily extended to include additional subject-specific covariates, and that the second and third methods can handle arbitrary numbers of controls per case. In addition, the Bayesian approach allows the incorporation of hierarchical structure, measurement error, missing data and so on.<br><br>All these techniques are illustrated in the code given below, which includes a transformation of the original summary statistics into full data. In this example, all but the second conditional-likelihood approach are commented out. <br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;# transform collapsed data into full<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : I){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i,1] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i,2] &lt;- 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# loop around strata with case exposed, control not exposed (n10)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : n10){ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,1] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,2] &lt;- 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# loop around strata with case not exposed, control exposed (n01)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (n10+1) : (n10+n01)){ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,1] &lt;- 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,2] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# loop around strata with case exposed, control exposed (n11)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (n10+n01+1) : (n10+n01+n11)){ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,1] &lt;- 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,2] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# loop around strata with case not exposed, control not exposed (n00)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (n10+n01+n11+1) :I ){ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,1] &lt;- 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;est[i,2] &lt;- 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;# PRIORS<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0,1.0E-6) ; <br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# LIKELIHOOD<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : I) { # loop around strata&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># METHOD 1 - logistic regression<br>&nbsp;&nbsp;&nbsp;# Y[i,1] ~ dbin( p[i,1], 1) <br>&nbsp;&nbsp;&nbsp;# logit(p[i,1]) &lt;- beta * (est[i,1] - est[i,J]) <br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# METHOD 2 - conditional likelihoods<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i, 1 : J] ~ dmulti( p[i, 1 : J],1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:2){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, j] &lt;- e[i, j] / sum(e[i, ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log( e[i, j] ) &lt;- beta * est[i, j] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;# METHOD 3 fit standard Poisson regressions relative to baseline<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#for (j in 1:J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;Y[i, j] ~ dpois(mu[i, j]);<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;log(mu[i, j]) &lt;- beta0[i] + beta*est[i, j]; <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#beta0[i] ~ dnorm(0, 1.0E-6) </font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Endodata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( cklick to open )</font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Endoinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( cklick to open )</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#0000FF" size="5">Results <br></font><font face="Arial" color="#000000" size="3"><br>A 5000 update burn in followed by a further 10000 updates gave the parameter estimates<br></font><font face="Arial" color="#000000" size="2"><img src="endo2.bmp" alt="[endo2]"><br></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Cervix</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Cervix: case - control study with errors in<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;covariates</strong></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3">Carroll, Gail and Lubin (1993) consider the problem of estimating the odds ratio of a disease d in a case-control study where the binary exposure variable is measured with error. Their example concerns exposure to herpes simplex virus (HSV) in women with invasive cervical cancer (d=1) and in controls (d=0). Exposure to HSV is measured by a relatively inaccurate western blot procedure w for 1929 of the 2044 women, whilst for 115 women, it is also measured by a refined or &quot;gold standard'' method x. The data are given in the table below. They show a substantial amount of misclassification, as indicated by low sensitivity and specificity of w in the &quot;complete'' data, and Carroll, Gail and Lubin also found that the degree of misclassification was significantly higher for the controls than for the cases (p=0.049 by Fisher's exact test).<br><center> </font><font face="Arial" color="#000100" size="2"><img src="cervix1.jpg" alt="[cervix1]"><br></center></font><font face="Arial" color="#000100" size="3"><br>They fitted a prospective logistic model to the case-control data as follows<br><br>&nbsp;&nbsp;&nbsp;d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Bernoulli(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;i = 1,...,2044 <br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>0C</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;i = 1,...,2044 <br><br>where </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> is the log odds ratio of disease. Since the relationship between d and x is only directly observable in the 115 women with &quot;complete'' data, and because there is evidence of differential measurement error, the following parameters are required in order to estimate the logistic model<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>1,1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P(w=1 | x=0, d=0)<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>1,2</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P(w=1 | x=0, d=1)<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>2,1</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P(w=1 | x=1, d=0)<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="2"><sub>2,2</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P(w=1 | x=1, d=1)<br>&nbsp;&nbsp;&nbsp;q&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P(x=1)<br><br><br>The differential probability of being exposed to HSV (x=1) for cases and controls is calculated as follows<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="cervix2.jpg" alt="[cervix2]"></font><font face="Arial" color="#000100" size="3"><br></center>The BUGS code is given below. </font><font face="Arial" color="#000100" size="3">The role of the variables </font><font face="Courier" color="#000100" size="3">x</font><font face="Courier" color="#000100" size="2">1</font><font face="Arial" color="#000100" size="3"> and </font><font face="Courier" color="#000100" size="3">d</font><font face="Courier" color="#000100" size="2">1</font><font face="Arial" color="#000100" size="3"> is to pick the appropriate value of </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> (the incidence of w) for any given true exposure status x and disease status d. Since x and d take the values 0 or 1, and the subscripts for </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> take values 1 or 2, we must first add 1 to each </font><font face="Courier" color="#000100" size="3">x[i]</font><font face="Arial" color="#000100" size="3"> and </font><font face="Courier" color="#000100" size="3">d[i]</font><font face="Arial" color="#000100" size="3"> in the BUGS code before using them as index values for </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3">. BUGS does not allow subscripts to be functions of variable quantities --- hence the need to create </font><font face="Courier" color="#000100" size="3">x1</font><font face="Arial" color="#000100" size="3">and </font><font face="Courier" color="#000100" size="3">d1</font><font face="Arial" color="#000100" size="3"> for use as subscripts. In addition, note that </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> were not simulated directly in BUGS, but were calculated as functions of other parameters. This is because the dependence of </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> on d would have led to a cycle in the graphical model which would no longer define a probability distribution. <br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">x[i] ~ dbern(q) # incidence of HSV<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(p[i]) &lt;- beta0C + beta * x[i]&nbsp;&nbsp;&nbsp;# logistic model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">d[i] ~ dbern(p[i]) # incidence of cancer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">x1[i] &lt;- x[i] + 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">d1[i] &lt;- d[i] + 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">w[i] ~ dbern(phi[x1[i], d1[i]])&nbsp;&nbsp;&nbsp;# incidence of w<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">q ~ dunif(0.0, 1.0) # prior distributions<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta0C ~ dnorm(0.0, 0.00001);<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta ~ dnorm(0.0, 0.00001);<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1 : 2) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(k in 1 : 2){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[j, k] ~ dunif(0.0, 1.0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># calculate gamma1 = P(x=1|d=0) and gamma2 = P(x=1|d=1) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;gamma1 &lt;- 1 / (1 + (1 + exp(beta0C + beta)) / (1 + exp(beta0C)) * (1 - q) / q)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;gamma2 &lt;- 1 / (1 + (1 + exp(-beta0C - beta)) / (1 + exp(-beta0C)) * (1 - q) / q)<br>&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Cervixdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Cervixinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="5"> <br></font><font face="Arial" color="#000100" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates <br><center><br></font><font face="Arial" color="#000100" size="2"><img src="cervix3.jpg" alt="[cervix3]"></font><font face="Arial" color="#000100" size="3"><br></center>Re-parameterised model with centred covariates:<br><br>&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i] ~ dbern(q) # incidence of HSV<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p[i]) &lt;- beta0 + beta * (x[i] - mean(w[])) # logistic model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[i] ~ dbern(p[i]) # incidence of cancer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1[i] &lt;- x[i] + 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1[i] &lt;- d[i] + 1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w[i] ~ dbern(phi[x1[i], d1[i]])&nbsp;&nbsp;&nbsp;# incidence of w<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q ~ dunif(0.0, 1.0) # prior distributions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta0 ~ dnorm(0.0, 0.00001);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0.0, 0.00001);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : 2) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(k in 1 : 2){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[j, k] ~ dunif(0.0, 1.0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# calculate gamma1 = P(x=1|d=0) and gamma2 = P(x=1|d=1) <br>&nbsp;&nbsp;&nbsp;gamma1 &lt;- 1 / (1 + (1 + exp(beta0C + beta)) / (1 + exp(beta0C)) * (1 - q) / q)<br>&nbsp;&nbsp;&nbsp;gamma2 &lt;- 1 / (1 + (1 + exp(-beta0C - beta)) / (1 + exp(-beta0C)) * (1 - q) / q)<br>&nbsp;&nbsp;&nbsp;beta0C &lt;- beta0 - mean(w[]) * beta<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Cervixinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )<br><center></font><font face="Arial" color="#000100" size="1"><br><img src="cervix4.jpg" alt="[cervix4]"></center></font></p></body></html>
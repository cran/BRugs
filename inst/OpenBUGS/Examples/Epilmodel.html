<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Epilmodel</title></head><body><p><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(k in 1 : T) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[j, k]) &lt;- a0 + alpha.Base * (log.Base4[j] - log.Base4.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.Trt * (Trt[j] - Trt.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.BT * (BT[j] - BT.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.Age * (log.Age[j] - log.Age.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.V4 * (V4[k] - V4.bar) <br>&nbsp;&nbsp;&nbsp;+ b1[j] + b[j, k]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[j, k] ~ dpois(mu[j, k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[j, k] ~ dnorm(0.0, tau.b); # subject*visit random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1[j] ~ dnorm(0.0, tau.b1) # subject random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BT[j] &lt;- Trt[j] * log.Base4[j] # interaction<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Base4[j] &lt;- log(Base[j] / 4) log.Age[j] &lt;- log(Age[j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# covariate means:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Age.bar &lt;- mean(log.Age[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trt.bar &lt;- mean(Trt[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BT.bar &lt;- mean(BT[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Base4.bar &lt;- mean(log.Base4[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V4.bar &lt;- mean(V4[]) <br>&nbsp;&nbsp;&nbsp;# priors:<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a0 ~ dnorm(0.0,1.0E-4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Base ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Trt ~ dnorm(0.0,1.0E-4); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.BT ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Age ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.V4 ~ dnorm(0.0,1.0E-4)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.b1 ~ dgamma(1.0E-3,1.0E-3); sigma.b1 &lt;- 1.0 / sqrt(tau.b1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.b ~ dgamma(1.0E-3,1.0E-3); sigma.b &lt;- 1.0/ sqrt(tau.b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# re-calculate intercept on original scale: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 &lt;- a0 - alpha.Base * log.Base4.bar - alpha.Trt * Trt.bar <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- alpha.BT * BT.bar - alpha.Age * log.Age.bar - alpha.V4 * V4.bar<br>&nbsp;&nbsp;&nbsp;}<br></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>temp</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="temp0.bmp" alt="[temp0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Rats: a normal hierarchical model<br></strong></font><font face="Arial" color="#000100" size="3"><br>This example is taken from section 6 of Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> (1990), and concerns 30 young rats whose weights were measured weekly for five weeks. Part of the data is shown below, where Y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the weight of the ith rat measured at age x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">. <br><center><br></font><font face="Arial" color="#000100" size="2"><img src="temp1.bmp" alt="[temp1]"><br></center></font><font face="Arial" color="#000100" size="3"><br>A plot of the 30 growth curves suggests some evidence of downward curvature.<br><br>The model is essentially a random effects linear growth curve<br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">(x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> - x</font><font face="Arial" color="#000100" size="2"><sub>bar</sub></font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>a</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="3">)<br><br>where x</font><font face="Arial" color="#000100" size="2"><sub>ba</sub></font><font face="Arial" color="#000100" size="3"><sub>r</sub></font><font face="Arial" color="#000100" size="3"> = 22, and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> represents the </font><font face="Arial" color="#000100" size="3"><em>precision</em></font><font face="Arial" color="#000100" size="3"> (1/variance) of a normal distribution. We note the absence of a parameter representing correlation between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> unlike in Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> 1990. However, see the </font><font face="Courier" color="#000100" size="3">Birats</font><font face="Arial" color="#000100" size="3"> example in Volume 2 which does explicitly model the covariance between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. For now, we standardise the x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">'s around their mean to reduce dependence between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> in their likelihood: in fact for the full balanced data, complete independence is achieved. (Note that, in general, prior independence does not force the posterior distributions to be independent).<br><br></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>a</sub></font><font face="Symbol" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Symbol" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are given independent ``noninformative'' priors. Interest particularly focuses on the intercept at zero time (birth), denoted </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"> - </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"> x</font><font face="Arial" color="#000100" size="2"><sub>bar</sub></font><font face="Arial" color="#000100" size="3">. <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><em><center>Graphical model for rats example:</em></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="temp2.bmp" alt="[temp2]"></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for rats example:</em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></center><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( j in 1 : T ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i , j] ~ dnorm(mu[i , j],tau.c)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i , j] &lt;- alpha[i] + beta[i] * (x[j] - xbar)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[i] ~ dnorm(alpha.c,alpha.tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[i] ~ dnorm(beta.c,beta.tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.c ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau.c)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.c ~ dnorm(0.0,1.0E-6)&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.tau ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta.c ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta.tau ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 &lt;- alpha.c - xbar * beta.c&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><br><br>Note the use of a very flat but conjugate prior for the population effects: a locally uniform prior could also have been used.<br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Ratsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/Ratsinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br>(Note: the response data (Y) for the rats example can also be found in the file ratsy.odc in rectangular format. The covariate data (X) can be found in S-Plus format in file ratsx.odc. To load data from each of these files, focus the window containing the open data file before clicking on &quot;load&nbsp;data&quot; from the &quot;Specification&quot; dialog.)<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates:<br><center></font><font face="Arial" color="#000000" size="2"><br><img src="temp3.bmp" alt="[temp3]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="3">These results may be compared with Figure 5 of Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> 1990 --- we note that the mean gradient of independent fitted straight lines is 6.19.<br><br>Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> 1990 also consider the problem of missing data, and delete the last observation of cases 6-10, the last two from 11-20, the last 3 from 21-25 and the last 4 from 26-30. The appropriate data file is obtained by simply replacing data values by NA (see below). The model specification is unchanged, since the distinction between observed and unobserved quantities is made in the data file and not the model specification.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Ratsmissdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> 1990 focus on the parameter estimates and the predictions for the final 4 observations on rat 26. These predictions are obtained automatically in </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> by monitoring the relevant Y[] nodes. The following estimates were obtained:<br><center></font><font face="Arial" color="#000100" size="2"><br><img src="temp4.bmp" alt="[temp4]"></center></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">We note that our estimate 6.58 of </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"> is substantially greater than that shown in Figure 6 of Gelfand </font><font face="Arial" color="#000100" size="3"><em>et</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>al </em></font><font face="Arial" color="#000100" size="3">1990. However, plotting the growth curves indicates some curvature with steeper gradients at the beginning: the mean of the estimated gradients of the reduced data is 6.66, compared to 6.19 for the full data. Hence we are inclined to believe our analysis. The observed weights for rat 26 were 207, 257, 303 and 345, compared to our predictions of 204, 250, 295 and 341.</font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="temp5.bmp" alt="[temp5]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Seeds: Random effect logistic regression<br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">This example is taken from Table 3 of Crowder (1978), and concerns the proportion of seeds that germinated on each of 21 plates arranged according to a 2 by 2 factorial layout by seed and type of root extract. The data are shown below, where r</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> are the number of germinated and the total number of seeds on the</font><font face="Arial" color="#000100" size="3"><em> i </em></font><font face="Arial" color="#000100" size="3">th plate, </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> =1,...,N. These data are also analysed by, for example, Breslow: and Clayton (1993). <br><center><br></font><font face="Arial" color="#000100" size="2"><img src="temp6.bmp" alt="[temp6]"><br></font><font face="Arial" color="#000100" size="3"></center>The model is essentially a random effects logistic, allowing for over-dispersion. If p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the probability of germination on the </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> th plate, we assume<br><br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> + b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal(0, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> , x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> are the seed type and root extract of the </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> th plate, and an interaction term </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> is included. </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Arial" color="#000100" size="3"><sub></sub></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Arial" color="#000100" size="3"><sub></sub></font><font face="Arial" color="#000100" size="3"></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Arial" color="#000100" size="3"><sub></sub></font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> are given independent &quot;noninformative&quot; priors. <br><br></font><font face="Arial" color="#000100" size="3"><center></font><font face="Arial" color="#000100" size="3"><em>Graphical model for seeds example<br><br></em></font><font face="Arial" color="#000100" size="3"><img src="temp7.bmp" alt="[temp7]"><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for seeds example</em></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"></center>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r[i] ~ dbin(p[i],n[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0.0,tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p[i]) &lt;- alpha0 + alpha1 * x1[i] + alpha2 * x2[i] + <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha12 * x1[i] * x2[i] + b[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha1 ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha2 ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha12 ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Seedsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/Seedsinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A burn in of 1000 updates followed by a further 10000 updates gave the following parameter estimates:<br><center></font><font face="Arial" color="#000000" size="2"><br><img src="temp8.bmp" alt="[temp8]"></font><font face="Arial" color="#000100" size="2"><br></center></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">We may compare simple logistic, maximum likelihood (from EGRET), penalized quasi-likelihood (PQL) Breslow and Clayton (1993) with the </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> results<br><center></font><font face="Arial" color="#000100" size="2"><br><img src="temp9.bmp" alt="[temp9]"><br></center><br></font><font face="Arial" color="#000100" size="3">Heirarchical centering is an interesting reformulation of random effects models. Introduce the variables<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><sub><br><br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">=</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br><br></sub></font><font face="Arial" color="#000100" size="3">the model then becomes<br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br><br>The graphical model is shown below&nbsp;&nbsp;&nbsp;<center><br></font><font face="Arial" color="#000100" size="2"><img src="temp10.bmp" alt="[temp10]"><br><br>&nbsp;&nbsp;&nbsp;</center></font><font face="Arial" color="#000100" size="3">This formulation of the model has two advantages: the squence of random numbers generated by the Gibbs sampler has better correlation properties and the time per update is reduced because the updating for the </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> parameters is now conjugate.</font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Mice</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="mice0.bmp" alt="[mice0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#0000FF" size="5"><strong>Mice: Weibull regression</strong></font><font face="Arial" color="#000000" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>Dellaportas and Smith (1993) analyse data from Grieve (1987) on photocarcinogenicity in four groups, each containing 20 mice, who have recorded a survival time and whether they died or were censored at that time. A portion of the data, giving survival times in weeks, are shown below. A </font><font face="Arial" color="#000100" size="3"><em>* </em></font><font face="Arial" color="#000100" size="3">indicates censoring.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="mice1.bmp" alt="[mice1]"></center></font><font face="Arial" color="#000100" size="3"><br>The survival distribution is assumed to be Weibull. That is<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">(t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>z</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = re</font><font face="Symbol" color="#000100" size="3"><strong><sup>b</sup></strong></font><font face="Arial" color="#000100" size="3"><strong><sup>z</sup></strong></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><sup>r - 1</sup></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">exp(-e</font><font face="Symbol" color="#000100" size="3"><strong><sup>b</sup></strong></font><font face="Arial" color="#000100" size="3"><strong><sup>z</sup></strong></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="3"><sup>t</sup></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="2"><sup>r</sup></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where t</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the failure time of an individual with covariate vector </font><font face="Arial" color="#000100" size="3"><strong>z</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3"><strong>b </strong></font><font face="Arial" color="#000100" size="3">is a vector of unknown regression coefficients. This leads to a baseline hazard function of the form <br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3">(t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = rt</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="2"><sup>r - 1</sup></font><font face="Arial" color="#000100" size="3"><br><br><br>Setting </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = e</font><font face="Symbol" color="#000100" size="3"><strong><sup>b</sup></strong></font><font face="Arial" color="#000100" size="3"><strong><sup>z</sup></strong></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="3"> gives the parameterisation<br><br>&nbsp;&nbsp;&nbsp;t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Weibull(</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>For censored observations, the survival distribution is a truncated Weibull, with lower bound corresponding to the censoring time. The regression </font><font face="Symbol" color="#000100" size="3"><strong>b </strong></font><font face="Arial" color="#000100" size="3">coefficients were assumed a priori to follow independent Normal distributions with zero mean and ``vague'' precision 0.0001. The shape parameter r for the survival distribution was given a Gamma(1, 0.0001) prior, which is slowly decreasing on the positive real line. <br><br>Median survival for individuals with covariate vector </font><font face="Arial" color="#000100" size="3"><strong>z</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is given by m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = (log2e</font><font face="Symbol" color="#000100" size="3"><sup>-</sup></font><font face="Symbol" color="#000100" size="3"><strong><sup>b</sup></strong></font><font face="Arial" color="#000100" size="3"><strong><sup>z</sup></strong></font><font face="Arial" color="#000100" size="2"><sup>i</sup></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><sup>1/r</sup></font><font face="Arial" color="#000100" size="3"><sup><br></sup></font><font face="Arial" color="#000100" size="3"><br>The appropriate graph and BUGS language are below, using an undirected dashed line to represent a logical range constraint. <br></font><font face="Arial" color="#000100" size="2"><br><center>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><img src="mice2.bmp" alt="[mice2]"></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;<br><br></font><font face="Arial" color="#000100" size="3"></center>&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in 1 : M) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : N) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[i, j] ~ dweib(r, mu[i])I(t.cen[i, j],)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- exp(beta[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[i] ~ dnorm(0.0, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;median[i] &lt;- pow(log(2) * exp(-beta[i]), 1/r) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r ~ dexp(0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;veh.control &lt;- beta[2] - beta[1] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test.sub &lt;- beta[3] - beta[1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.control &lt;- beta[4] - beta[1]<br>&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>We note a number of tricks in setting up this model. First, individuals who are censored are given a missing value in the vector of failure times t, whilst individuals who fail are given a zero in the censoring time vector t.cen (see data file listing below). The truncated Weibull is modelled using I(t.cen[i],) to set a lower bound. Second, we set a parameter beta[j] for each treatment group </font><font face="Arial" color="#000100" size="3"><em>j</em></font><font face="Arial" color="#000100" size="3">.</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">The contrasts beta[j] with group 1 (the irradiated control) are calculated at the end. Alternatively, we could have included a grand mean term in the relative risk model and constrained beta[1] to be zero.<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Micedata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Miceinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A burn in of 1000 updates followed by a further 10000 updates gave the parameter estimates</font><font face="Arial" color="#000100" size="3"><br><center><img src="mice3.bmp" alt="[mice3]"></font><font face="Arial" color="#000100" size="2"><br><br></center></font></p></body></html>
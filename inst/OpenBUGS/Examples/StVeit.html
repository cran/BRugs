<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>StVeit</title></head><body><p><font face="Arial" color="#0000FF" size="5"><strong><br><img src="bugsicon.jpg" alt="[bugsicon]">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;St Veit-Klinglberg, Austria - <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Radiocarbon calibration with stratification<br></strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">This example is from the book Buck CE, Cavanagh WG &amp; Litton CD (1996) </font><font face="Arial" color="#000100" size="3"><em>Bayesian approach to interpreting archaeological data</em></font><font face="Arial" color="#000100" size="3">. Wiley: Chichester p218-226<br>See also Buck CE, Litton CD &amp; Shennan SJ (1994) A case study in combining radiocarbon and archaeological information: the Early Bronze Age settlement of St Veit-Klinglberg, Lan Salzburg, Austria. </font><font face="Arial" color="#000100" size="3"><em>Germania</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>2</strong></font><font face="Arial" color="#000100" size="3"> 427-447. The model was set up by Andrew Millard. </font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">&copy; Andrew Millard 2001 <br><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model{ <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[1] ~ dunif(theta[2], theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[2] ~ dunif(theta[3], theta[1])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[3] ~ dunif(theta[9], theta[2])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[4] ~ dunif(theta[9], theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[5] ~ dunif(theta[7], theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[6] ~ dunif(theta[7], theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[7] ~ dunif(theta[9], theta7max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta7max &lt;- min(theta[5], theta[6])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[8] ~ dunif(theta[9], theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[9] ~ dunif(theta[10], theta9max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta9max &lt;-min(min(theta[3], theta[4]), min(theta[7], theta[8]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[10] ~ dunif(theta[11], theta[9])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[11] ~ dunif(0 ,theta[10])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;bound[1] &lt;- ranked(theta[1:8], 8)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;bound[2] &lt;- ranked(theta[1:8], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;bound[3] &lt;- ranked(theta[9:11], 3)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;bound[4] &lt;- ranked(theta[9:11], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (j in 1 : 5){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[j + 11] ~ dunif(0, theta.max)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;within[j, 1] &lt;- 1 - step(bound[1] - theta[j + 11])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 2 : 4){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;within[j, k] &lt;- step(bound[k - 1] - theta[j + 11]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- step(bound[k] - theta[j + 11])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;within[j, 5] &lt;- step(bound[4] - theta[j + 11])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:nDate){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X[i] ~ dnorm(mu[i], tau[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau[i] &lt;- 1/pow(sigma[i],2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- interp.lin(theta[i], calBP[], C14BP[])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># monitor the following variable to smooth density of theta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta.smooth[i] &lt;- 10 * round(theta[i] / 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/StVietdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a> <a href="../Examples/RadioCarbonCurve.html"></font><font face="Arial" color="#0000FF" size="5"><u>Radio&nbsp;Carbon&nbsp;Calibration&nbsp;Curve</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/StVietinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</a></u></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5">Results<br><center><br><img src="stveit1.jpg" alt="[stveit1]"><br><img src="stveit2.jpg" alt="[stveit2]"><br><img src="stveit3.jpg" alt="[stveit3]"><br><img src="stveit4.jpg" alt="[stveit4]"><br><img src="stveit5.jpg" alt="[stveit5]"><br><img src="stveit6.jpg" alt="[stveit6]"><br><img src="stveit7.jpg" alt="[stveit7]"><br><img src="stveit8.jpg" alt="[stveit8]"><br><img src="stveit9.jpg" alt="[stveit9]"><br><img src="stveit10.jpg" alt="[stveit10]"><br><img src="stveit11.jpg" alt="[stveit11]"><br><img src="stveit12.jpg" alt="[stveit12]"><br><img src="stveit13.jpg" alt="[stveit13]"><br><img src="stveit14.jpg" alt="[stveit14]"><br><img src="stveit15.jpg" alt="[stveit15]"><br><img src="stveit16.jpg" alt="[stveit16]"><br><br><img src="stveit17.jpg" alt="[stveit17]"></center></font></p></body></html>
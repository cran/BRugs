<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Blockers</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Blocker: random effects meta-analysis of clinical<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trials<br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">Carlin (1992) considers a Bayesian approach to meta-analysis, and includes the following examples of 22 trials of beta-blockers to prevent mortality after myocardial infarction.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="blockers1.jpg" alt="[blockers1]"></center></font><font face="Arial" color="#000100" size="3"><br>In a random effects meta-analysis we assume the true effect (on a log-odds scale) </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> in a trial</font><font face="Arial" color="#000100" size="3"><em> i </em></font><font face="Arial" color="#000100" size="3">is drawn from some population distribution.Let r</font><font face="Arial" color="#000100" size="2"><sup>C</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denote number of events in the control group in trial </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">, and r</font><font face="Arial" color="#000100" size="2"><sup>T</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denote events under active treatment in trial </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">. Our model is:<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="2"><sup>C</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sup>C</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sup>C</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;r</font><font face="Arial" color="#000100" size="2"><sup>T</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sup>T</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sup>T</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sup>C</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">=</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3">logit(p</font><font face="Arial" color="#000100" size="2"><sup>T</sup></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</sub></font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal(d,</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="3">)<br><br>``Noninformative'' priors are given for the </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">'s. </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> and d. The graph for this model is shown in below. We want to make inferences about the population effect d, and the predictive distribution for the effect </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>new</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">in a new trial. </font><font face="Arial" color="#000100" size="3"><em>Empirical Bayes </em></font><font face="Arial" color="#000100" size="3">methods estimate d and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> by maximum likelihood and use these estimates to form the predictive distribution p(</font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>new</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">| d</font><font face="Arial" color="#000100" size="2"><sub>hat</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>hat</sub></font><font face="Arial" color="#000100" size="3"> ). </font><font face="Arial" color="#000100" size="3"><em>Full Bayes</em></font><font face="Arial" color="#000100" size="3"> allows for the uncertainty concerning d and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">. <br><br></font><font face="Arial" color="#0000FF" size="5"><strong><center></strong></font><font face="Arial" color="#000100" size="3"><em>Graphical model for blocker example:<br></em></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#0000FF" size="5"><strong><img src="blockers2.jpg" alt="[blockers2]"></strong></font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for blocker example:</em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1"><br><br><br></center><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( i in 1 : Num ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">rc[i] ~ dbin(pc[i], nc[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">rt[i] ~ dbin(pt[i], nt[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(pc[i]) &lt;- mu[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(pt[i]) &lt;- mu[i] + delta[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i] ~ dnorm(0.0,1.0E-5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">delta[i] ~ dt(d, tau, 4)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">d ~ dnorm(0.0,1.0E-6)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.001,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">delta.new ~ dt(d, tau, 4)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- 1 / sqrt(tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Blockersdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#000100" size="3"></a> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Blockersinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#000000" size="2"> </a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br></font><font face="Arial" color="#000000" size="2"><img src="blockers3.jpg" alt="[blockers3]"><br></font><font face="Arial" color="#000100" size="1"><br></center></font><font face="Arial" color="#000100" size="3">Our estimates are lower and with tighter precision - in fact similar to the values obtained by Carlin for the empirical Bayes estimator. The discrepancy appears to be due to Carlin's use of a uniform prior for </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> in his analysis, which will lead to increased posterior mean and standard deviation for d, as compared to our (approximate) use of p(</font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) &nbsp;~&nbsp;1&nbsp;/&nbsp;</font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(see his Figure 1).<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">In some circumstances it might be reasonable to assume that the population distribution has heavier tails, for example a t distribution with low degrees of freedom. This is easily accomplished in </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> by using the dt distribution function instead of dnorm for </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="3"><sub>new</sub></font><font face="Arial" color="#000100" size="3">. </font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1"><br><br><br><br><br><br><br><br><br><br><br><br><br><br></font></p></body></html>
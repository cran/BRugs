<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Hips3</title></head><body><p><font face="Arial" color="#000000" size="2"><strong><img src="hips30.bmp" alt="[hips30]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Hips model 3: MC estimates for<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each strata, allowing<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for parameter uncertainty in<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;revision hazard, h - gives<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results for Table 3</font><font face="Arial" color="#000000" size="2"><strong><br><br></strong></font><font face="Arial" color="#000100" size="1"></font><font face="Times New Roman" color="#000100" size="3">Spiegelhalter, D.J. and Best, N.G. &ldquo;Bayesian approaches to multiple sources of evidence and uncertainty in complex cost-effectiveness modelling&rdquo;. </font><font face="Times New Roman" color="#000100" size="3"><u>Statistics in Medicine 22</u></font><font face="Times New Roman" color="#000100" size="3">, (2003), 3687-3709.<br></font><font face="Arial" color="#000000" size="3"><br>n = 10000 updates (1 per simulated set of parameter values) are required for this model; monitor C, BL, BQ to get posterior mean and sd for each subgroup for results in top part of Table 3.<br><br></font><font face="Arial" color="#000000" size="3"><strong>For results in bottom part of Table 3:</strong></font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000000" size="3"><u>Approach&nbsp;1:&nbsp;p(s,&nbsp;theta)&nbsp;=&nbsp;p(s&nbsp;|&nbsp;theta)&nbsp;p(theta)</u></font><font face="Arial" color="#000000" size="3"><br>m_theta and v_theta are the mean and variance across subgroups for a given value of theta<br>=&gt; within BUGS code, calculate mean and variance of C[k], BL[k], BQ[k] across subgroups at each iteration, then take Monte Carlo expectation at end of run<br>=&gt; monitor mean.C, mean.BL, mean.BQ, var.C, var.BL, var.BQ<br><br></font><font face="Arial" color="#000000" size="3"><u>Approach&nbsp;2:&nbsp;p(s,&nbsp;theta)&nbsp;=&nbsp;p(theta&nbsp;|&nbsp;s)&nbsp;p(s)</u></font><font face="Arial" color="#000000" size="3"><br>overall mean, m = weighted mean of posterior means of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run var due to uncertainty, vP2 = weighted mean of posterior variances of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run var due to heterogeneity = vH2 = weighted variance of posterior means of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000000" size="3"><strong>Sections of the code that have changed from Model 1 are shown in bold<br></strong></font><font face="Arial" color="#000000" size="1"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">model {<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(k in 1 : K) { # loop over strata<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Cost and benefit equations <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">#######################<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Costs<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(t in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;ct[k, t] &lt;- inprod(pi[k, t, ], c[]) / pow(1 + delta.c, t - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">C[k] &lt;- C0 + sum(ct[k, ])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Benefits - life expectancy<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(t in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;blt[k, t] &lt;- inprod(pi[k, t, ], bl[]) / pow(1 + delta.b, t - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">BL[k] &lt;- sum(blt[k, ])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Benefits - QALYs<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(t in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;bqt[k, t] &lt;- inprod(pi[k, t, ], bq[]) / pow(1 + delta.b, t - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">BQ[k] &lt;- sum(bqt[k, ])<br><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Markov model probabilities:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">#######################<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Transition matrix<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(t in 2 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 1, 1] &lt;- 1 - gamma[k, t] - lambda[k, t]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 1, 2] &lt;- gamma[k, t] * lambda.op<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 1, 3] &lt;- gamma[k, t] *(1 - lambda.op)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 1, 4] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 1, 5] &lt;- lambda[k, t] <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 2, 1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 2, 2] &lt;- 0 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 2, 3] &lt;- 0 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 2, 4] &lt;- 0 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 2, 5] &lt;- 1 <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 3, 1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 3, 2] &lt;- 0 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k,t,3,3] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 3, 4] &lt;- 1 - lambda[k, t]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 3, 5] &lt;- lambda[k, t]<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 4, 1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 4, 2] &lt;- rho * lambda.op<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k,t,4,3] &lt;- rho * (1 - lambda.op)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 4, 4] &lt;- 1 - rho - lambda[k, t]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 4, 5] &lt;- lambda[k, t]<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 5, 1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 5, 2] &lt;- 0 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 5, 3] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 5, 4] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">Lambda[k, t, 5,5 ] &lt;- 1<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">gamma[k, t] &lt;- h[k] * (t - 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Marginal probability of being in each state at time 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">pi[k,1,1] &lt;- 1 - lambda.op pi[k,1, 2] &lt;- 0 pi[k,1, 3] &lt;- 0 ; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi[k,1, 4] &lt;- 0 pi[k,1, 5] &lt;- lambda.op<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"># Marginal probability of being in each state at time t &gt; 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(t in 2 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">for(s in 1 : S) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;pi[k, t, s] &lt;- inprod(pi[k, t - 1, ], Lambda[k, t, , s])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2"><strong># age-sex specific revision hazard<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>for(k in 1 : K) { <br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>logh[k] ~ dnorm(logh0[k], tau)<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>h[k] &lt;- exp(logh[k]) <br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>}<br><br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong># Calculate mean and variance across strata at each iteration <br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong># (Gives overall mean and variance using approach 1)<br><br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>mean.C &lt;- inprod(p.strata[], C[])<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>mean.BL &lt;- inprod(p.strata[], BL[])<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>mean.BQ &lt;- inprod(p.strata[], BQ[])<br><br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>for(k in 1:12) {<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>C.dev[k] &lt;- pow(C[k]-mean.C , 2)<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>BL.dev[k] &lt;- pow(BL[k]-mean.BL , 2)<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>BQ.dev[k] &lt;- pow(BQ[k]-mean.BQ , 2)<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>&nbsp;&nbsp;&nbsp;}<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>var.C &lt;- inprod(p.strata[], C.dev[])<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>var.BL &lt;- inprod(p.strata[], BL.dev[])<br></strong></font><font face="Arial" color="#000000" size="1"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></font><font face="Arial" color="#000000" size="2"><strong>var.BQ &lt;- inprod(p.strata[], BQ.dev[])</strong></font><font face="Arial" color="#FF00FF" size="2"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">}<br><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Hipsdata3.html"></font><font face="Arial" color="#0000FF" size="5"><strong><u>Data</u></strong></font><font face="Arial" color="#0000FF" size="5"><strong></a></strong></font><font face="Arial" color="#000000" size="3"> ( click to open )<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#0000FF" size="2"><strong> <br><img src="hips31.bmp" alt="[hips31]"><br></strong></font><font face="Arial" color="#FF0000" size="1"><br></font><font face="Arial" color="#000000" size="3">Note: results for the bottom panel of Table 3 (approach 1) for costs are given by<br>m = posterior mean of mean.C = 4609<br>vP1 = posterior variance of mean.C = 31.82 * 31.82<br>vH1 = posterior mean of var.C = 174400<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000000" size="3"><strong>&nbsp;&nbsp;&nbsp;'Model' to calculate overall mean (m), var due to uncertainty (vP2) and var due to heterogeneity (vH2) &nbsp;&nbsp;&nbsp;using approach 2</strong></font><font face="Arial" color="#000000" size="3"><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;No updates needed - just compile model, load data, and gen inits, then use node tool from info menu to obtain values of &nbsp;&nbsp;&nbsp;mC, mBL, mBQ, vP2.C, vP2.BL, vP2.BQ, vH2.C, vH2.BL, vH2.BQ, TC, TBL, TBQ, pcC, pcBL, pcBQ.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;model { <br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# overall mean outcome (m)<br>mC &lt;- inprod(p.strata[], C[])<br>mBL &lt;- inprod(p.strata[], BL[])<br>mBQ &lt;- inprod(p.strata[], BQ[])<br><br># variance due to uncertainty, vP<br>for(k in 1:12) {<br>VC[k] &lt;- sdC[k]*sdC[k]<br>VBL[k] &lt;- sdBL[k]*sdBL[k]<br>VBQ[k] &lt;- sdBQ[k]*sdBQ[k]<br>}<br>vP2.C &lt;- inprod(p.strata[], VC[])<br>vP2.BL &lt;- inprod(p.strata[], VBL[])<br>vP2.BQ &lt;- inprod(p.strata[], VBQ[])<br><br># variance due to heterogeneity, vH<br>for(k in 1:12) { devC[k] &lt;- pow(C[k] - mC, 2) }<br>vH2.C &lt;- inprod(p.strata[], devC[])<br>for(k in 1:12) { devBL[k] &lt;- pow(BL[k] - mBL, 2) }<br>vH2.BL &lt;- inprod(p.strata[], devBL[])<br>for(k in 1:12) { devBQ[k] &lt;- pow(BQ[k] - mBQ, 2) }<br>vH2.BQ &lt;- inprod(p.strata[], devBQ[])<br><br># Percent of total variance due to heterogeneity<br>TC &lt;- vP2.C + vH2.C<br>pcC &lt;- vH2.C/TC<br>TBL &lt;- vP2.BL + vH2.BL<br>pcBL &lt;- vH2.BL/TBL<br>TBQ &lt;- vP2.BQ + vH2.BQ<br>pcBQ &lt;- vH2.BQ/TBQ<br><br>}<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Hipsdata32.html"></font><font face="Arial" color="#0000FF" size="5"><strong><u>Data</u></strong></font><font face="Arial" color="#0000FF" size="5"><strong></a></strong></font><font face="Arial" color="#000000" size="3"> ( click to open, posterior means and posterior sd of C, BL and BQ from running model&nbsp;3)</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><strong>Results</strong></font><font face="Arial" color="#0000FF" size="2"><strong> <br></strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">mC 4609.03<br>mBL 8.687390000000001<br>mBQ 8.01488<br>vP2.C 11472.793425<br>vP2.BL 3.3068250474E-6<br>vP2.BQ 7.493649773900001E-4<br>vH2.C 163953.4291<br>vH2.BL 6.713258897899999<br>vH2.BQ 5.464389485600001<br>TC 175426.222525<br>TBL 6.713262204725046<br>TBQ 5.465138850577391<br>pcC 0.9346004647431485<br>pcBL 0.999999507419054<br>pcBQ 0.9998628827193821</font></p></body></html>
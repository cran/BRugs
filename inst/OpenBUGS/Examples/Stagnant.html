<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Stagnant</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="stagnant0.bmp" alt="[stagnant0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Stagnant: a changepoint problem <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and an illustration of how NOT<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to do MCMC!)</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">Carlin, Gelfand and Smith (1992) analyse data from Bacon and Watts (1971) concerning a changepoint in a linear regression.<br><img src="stagnant1.bmp" alt="[stagnant1]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><br>Note the repeated x's.</strong></font><font face="Arial" color="#000100" size="3"><br><br>We assume a model with two straight lines that meet at a certain changepoint x</font><font face="Arial" color="#000100" size="3"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> --- this is slightly different from the model of Carlin, Gelfand and Smith (1992) who do not constrain the two straight lines to cross at the changepoint. We assume<br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~&nbsp;&nbsp;&nbsp;Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>J[i]</sub></font><font face="Arial" color="#000100" size="3"> (x</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> - x</font><font face="Arial" color="#000100" size="3"><sub>k</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;J[i]=1 if i &lt;= k &nbsp;&nbsp;&nbsp;J[i]=2 if i &gt; k<br><br>giving E(Y) = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> at the changepoint, with gradient </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> before, and gradient </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> after the changepoint. We give independent &quot;noninformative'' priors to </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="3"><strong>Note: alpha is E(Y) at the changepoint, so will be highly correlated with k. This may be a very poor parameterisation. <br><br>Note way of constructing a uniform prior on the integer k, and making the regression<br>parameter depend on a random changepoint.<br></strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ dnorm(mu[i],tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- alpha + beta[J[i]] * (x[i] - x[k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J[i] &lt;- 1 + step(i - k - 0.5)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;punif[i] &lt;- 1/N<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;for( j in 1 : 2 ) {<br>&nbsp;&nbsp;&nbsp;beta[j] ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;k ~ dcat(punif[])<br>&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantinits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#000100" size="3"><br>Traces of two chains shows complete dependence on starting values<br><br><img src="stagnant2.bmp" alt="[stagnant2]"><br><img src="stagnant3.bmp" alt="[stagnant3]"></font><font face="Arial" color="#00FF00" size="5"><strong><br></strong></font><font face="Arial" color="#FF0000" size="5"><strong>Results are hopeless - no mixing at all. </strong></font><font face="Arial" color="#00FF00" size="5"><strong></strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong>Note: alpha is E(Y) at the changepoint, so will be highly correlated with k. This may be a very poor parameterisation. <br><br>TRY USING CONTINUOUS PARAMETERISATION<br></strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Y[i] ~ dnorm(mu[i], tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i] &lt;- alpha + beta[J[i]] * (x[i] - x.change)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">J[i] &lt;- 1 + step(x[i] - x.change)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.001, 0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha ~ dnorm(0.0,1.0E-6)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1 : 2) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta[j] ~ dnorm(0.0,1.0E-6)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- 1 / sqrt(tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">x.change ~ dunif(-1.3,1.1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantcdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantcinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Stagnantcinits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="5"> <br><br><img src="stagnant4.bmp" alt="[stagnant4]"><br><img src="stagnant5.bmp" alt="[stagnant5]"><br><img src="stagnant6.bmp" alt="[stagnant6]"><br><br><br>Not wonderful mixing, but reasonable<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong>Good fit to data , (monitor mu and use as predicted values) use 'model fit' in Compare tool<br></strong></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="3"><strong>Strong correlation of alpha and changepoint<br></strong></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3"><br>alpha&nbsp;&nbsp;&nbsp;x.change &nbsp;&nbsp;&nbsp;-0.932941<br></font></p></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Icemodel</title></head><body><p><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:I) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cases[i] ~ dpois(mu[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i]) &lt;- log(pyr[i]) + alpha[age[i]] + beta[year[i]]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[1] &lt;- 2 * beta[2] - beta[3]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[1] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[2] &lt;- (2 * beta[1] + 4 * beta[3] - beta[4]) / 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[2] &lt;- 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 3 : K - 2) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[k] &lt;- (4 * beta[k - 1] + 4 * beta[k + 1]- beta[k - 2] - beta[k + 2]) / 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[k] &lt;- 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[K - 1] &lt;- (2 * beta[K] + 4 * beta[K - 2] - beta[K - 3]) / 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[K - 1] &lt;- 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betamean[K] &lt;- 2 * beta[K - 1] - beta[K - 2] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nneighs[K] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;betaprec[k] &lt;- Nneighs[k] * tau<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1 : K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[k] ~ dnorm(betamean[k], betaprec[k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logRR[k] &lt;- beta[k] - beta[5]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.like[k] &lt;- Nneighs[k] * beta[k] * (beta[k] - betamean[k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[1] &lt;- 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 : Nage) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[j] ~ dnorm(0, 1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d &lt;- 0.0001 + sum(tau.like[]) / 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r &lt;- 0.0001 + K / 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(r, d)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}<br></font></p></body></html>
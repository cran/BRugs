<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Inhalers</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bugsicon.jpg" alt="[bugsicon]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;Inhaler: ordered catagorical data<br></strong></font><font face="Arial" color="#000100" size="3"><br>Ezzet and Whitehead (1993) analyse data from a two-treatment, two-period crossover trial to compare 2 inhalation devices for delivering the drug salbutamol in 286 asthma patients. Patients were asked to rate the clarity of leaflet instructions accompanying each device, using a 4-point ordinal scale. In the table below, the first entry in each cell (r,c) gives the number of subjects in Group 1 (who received device A in period 1 and device B in period 2) giving response r in period 1 and response c in period 2. The entry in brackets is the number of Group 2 subjects (who received the devices in reverse order) giving this response pattern. <br><center><br></font><font face="Arial" color="#000100" size="2"><img src="inhalers1.jpg" alt="[inhalers1]"></center></font><font face="Arial" color="#000100" size="3"><br>The response R</font><font face="Arial" color="#000100" size="3"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> th subject (</font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> = 1,...,286) in the </font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> th period (</font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> = 1,2) thus assumes integer values between 1 and 4. It may be expressed in terms of a continuous latent variable Y</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> taking values on (-inf, inf) as follows:<br><br>&nbsp;&nbsp;&nbsp;R</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> = j if Y</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> in [a</font><font face="Arial" color="#000100" size="2"><sub>j - 1</sub></font><font face="Arial" color="#000100" size="3">, a</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">), j = 1,..,4<br><br>where a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> = -inf and a</font><font face="Arial" color="#000100" size="2"><sub>4</sub></font><font face="Arial" color="#000100" size="3"> = inf. Assuming a logistic distribution with mean </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> for Y</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3">, then the cumulative probability Q</font><font face="Arial" color="#000100" size="2"><sub>itj</sub></font><font face="Arial" color="#000100" size="3"> of subject </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> rating the treatment in period </font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> as worse than category </font><font face="Arial" color="#000100" size="3"><em>j </em></font><font face="Arial" color="#000100" size="3">(i.e. Prob( Y</font><font face="Arial" color="#000100" size="2"><sub>it</sub></font><font face="Arial" color="#000100" size="3"> &gt;= a</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) is given by<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;logitQ</font><font face="Arial" color="#000100" size="2"><sub>itj</sub></font><font face="Arial" color="#000100" size="3"> = -(a</font><font face="Arial" color="#000100" size="2">j</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>s</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">+ b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> represents the random effect for subject </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">. Here, </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="3"><sub>s</sub></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">depends only on the period </font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> and the </font><font face="Arial" color="#000100" size="3"><em>sequence</em></font><font face="Arial" color="#000100" size="3"> s</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 1,2 to which patient </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> belongs. It is defined as<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>11</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="3">/ 2 + </font><font face="Symbol" color="#000100" size="3">p </font><font face="Arial" color="#000100" size="3">/ 2<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3"> = -</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> / 2 - </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> / 2 - </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>21</sub></font><font face="Arial" color="#000100" size="3"> = -</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> / 2 + </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> / 2<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>22</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> / 2 - </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> / 2 + </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;<br>where </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> represents the treatment effect, </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> represents the period effect and </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> represents the carryover effect. The probability of subject </font><font face="Arial" color="#000100" size="3"><em>i </em></font><font face="Arial" color="#000100" size="3">giving response</font><font face="Arial" color="#000100" size="3"><em> j </em></font><font face="Arial" color="#000100" size="3">in period </font><font face="Arial" color="#000100" size="3"><em>t</em></font><font face="Arial" color="#000100" size="3"> is thus given by p</font><font face="Arial" color="#000100" size="2"><sub>itj</sub></font><font face="Arial" color="#000100" size="3"> = Q</font><font face="Arial" color="#000100" size="2"><sub>itj - 1</sub></font><font face="Arial" color="#000100" size="3"> - Q</font><font face="Arial" color="#000100" size="2"><sub>itj</sub></font><font face="Arial" color="#000100" size="3">, where Q</font><font face="Arial" color="#000100" size="2"><sub>it0</sub></font><font face="Arial" color="#000100" size="3"> = 1 and Q</font><font face="Arial" color="#000100" size="2"><sub>it4</sub></font><font face="Arial" color="#000100" size="3"> = 0 (see also the Bones example). <br><br>The </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language for this model is shown below. We assume the b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">'s to be normally distributed with zero mean and common precision </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">. The fixed effects </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> are given vague normal priors, as are the unknown cut points a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> and a</font><font face="Arial" color="#000100" size="2"><sub>3</sub></font><font face="Arial" color="#000100" size="3">. We also impose order constraints on the latter using the I(,) notation in </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3">, to ensure that a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> &lt; a</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> &lt; a</font><font face="Arial" color="#000100" size="2"><sub>3</sub></font><font face="Arial" color="#000100" size="3">. <br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Construct individual response data from contingency table<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : Ncum[1, 1]) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (t in 1 : T) { response[i, t] &lt;- pattern[1, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (Ncum[1,1] + 1) : Ncum[1, 2]) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 2 for (t in 1 : T) { response[i, t] &lt;- pattern[1, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 2 : Npattern) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in (Ncum[k - 1, 2] + 1) : Ncum[k, 1]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 1 for (t in 1 : T) { response[i, t] &lt;- pattern[k, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in (Ncum[k, 1] + 1) : Ncum[k, 2]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 2 for (t in 1 : T) { response[i, t] &lt;- pattern[k, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Model<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (t in 1 : T) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : Ncut) {<br>&nbsp;&nbsp;&nbsp;# <br>&nbsp;&nbsp;&nbsp;# Cumulative probability of worse response than j<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(Q[i, t, j]) &lt;- -(a[j] + mu[group[i], t] + b[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Probability of response = j<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, t, 1] &lt;- 1 - Q[i, t, 1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 : Ncut) { p[i, t, j] &lt;- Q[i, t, j - 1] - Q[i, t, j] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, t, (Ncut+1)] &lt;- Q[i, t, Ncut]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response[i, t] ~ dcat(p[i, t, ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Subject (random) effects<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0.0, tau)<br>&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Fixed effects<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (g in 1 : G) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(t in 1 : T) { <br>&nbsp;&nbsp;&nbsp;# logistic mean for group i in period t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[g, t] &lt;- beta * treat[g, t] / 2 + pi * period[g, t] / 2 + kappa * carry[g, t] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0, 1.0E-06)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi ~ dnorm(0, 1.0E-06)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kappa ~ dnorm(0, 1.0E-06)<br><br>&nbsp;&nbsp;&nbsp;# ordered cut points for underlying continuous latent variable <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[1] ~ dnorm(0, 1.0E-06)I(, a[2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[2] ~ dnorm(0, 1.0E-06)I(a[1], a[3])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[3] ~ dnorm(0, 1.0E-06)I(a[2], ) <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(1 / tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.sigma &lt;- log(sigma)<br><br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Note that the data is read into </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> in the original contigency table format to economize on space and effort. The indivdual responses for each of the 286 patients are then constructed within </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3">. <br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Inhalersdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Inhalersinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br></font><font face="Arial" color="#000000" size="2"><img src="inhalers2.jpg" alt="[inhalers2]"><br></font><font face="Arial" color="#000000" size="3"><br></center>The estimates can be compared with those of Ezzet and Whitehead, who used the Newton-Raphson method and numerical integration to obtain maximum-likelihood estimates of the parameters. They reported </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000000" size="3"> = 1.17 +/- 0.75, </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000000" size="3"> = -0.23 +/- 0.20, </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000000" size="3"> = 0.21 +/- 0.49, log</font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000000" size="3"> = 0.17 +/- 0.23, a1 = 0.68, a2 = 3.85, a3 = 5.10</font></p></body></html>
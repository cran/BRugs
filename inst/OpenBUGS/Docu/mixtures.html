<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>mixtures</title></head><body><p><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000000" size="5"><strong><img src="mixtures0.bmp" alt="[mixtures0]">&nbsp;&nbsp;&nbsp;Mixtures: each observation is from a mixture of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributions of different complexity<br></strong></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000000" size="3">Note that we do not require reversible jump techniques as this is really only a single model.<br><br>Suppose that for each i: x[i] ~ N(mu, 1) with probability p; and x[i] ~ N(0, 1) otherwise (i.e. with probability 1 - p). We generate 100 observations with p = 0.4 and mu = 3 as follows. We forward sample </font><font face="Arial" color="#000000" size="3"><em>once</em></font><font face="Arial" color="#000000" size="3"> from the model below by compiling the code and then using the 'gen inits' facility. The simulated data can then be obtained by selecting </font><font face="Arial" color="#000000" size="3"><em>Save State</em></font><font face="Arial" color="#000000" size="3"> from the </font><font face="Arial" color="#000000" size="3"><em>Model</em></font><font face="Arial" color="#000000" size="3"> menu.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;p &lt;- 0.4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[2] &lt;- mu<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : 100) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] ~ dbern(p)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index[i] &lt;- group[i] + 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(m[index[i]], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>We may observe the underlying mixture distribution by monitoring any one of the y[i]'s over a number of additional sampling cycles. For example, the following kernel density plot was obtained after monitoring y[1] for 1000 iterations:<br><center><br></font><font face="Arial" color="#000100" size="2"><br><img src="mixtures1.bmp" alt="[mixtures1]"></font><font face="Arial" color="#000100" size="5"><br></font><font face="Arial" color="#0000FF" size="2"></center>T</font><font face="Arial" color="#000000" size="3">o analyse the simulated data we use the following code:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu ~ dunif(-5, 5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;p ~ dunif(0, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[2] &lt;- mu<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:100) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] ~ dbern(p)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index[i] &lt;- group[i] + 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(m[index[i]], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>After 6000 iterations (with a burn-in of 1000) we have good agreement with the 'true' values:<br><br></font><font face="Arial" color="#000000" size="3"><strong>node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000000" size="3">mu&nbsp;&nbsp;&nbsp;3.049&nbsp;&nbsp;&nbsp;0.2088&nbsp;&nbsp;&nbsp;0.004593&nbsp;&nbsp;&nbsp;2.656&nbsp;&nbsp;&nbsp;3.046&nbsp;&nbsp;&nbsp;3.474&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>p&nbsp;&nbsp;&nbsp;0.4257&nbsp;&nbsp;&nbsp;0.06002&nbsp;&nbsp;&nbsp;0.001317&nbsp;&nbsp;&nbsp;0.3111&nbsp;&nbsp;&nbsp;0.424&nbsp;&nbsp;&nbsp;0.5457&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#0000FF" size="5">Initial values</font><font face="Arial" color="#000000" size="3">:<br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;list(mu = 0, p = 0.5)<br><br></font><font face="Arial" color="#0000FF" size="5">Simulated data:</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="2">list(<br>y = c(<br>2.401893189187883,0.2400077667887621,-0.1556589480882761,-0.8457182007723154,0.37008097263224,<br>3.586009960655263,1.598955590680827,3.826518138558907,-0.9630895329522409,0.6951468806412424,<br>3.129328672725175,0.01025316168135796,0.4887298480200992,0.3865632519840305,-0.2697534502300845,<br>-1.18891944058751,4.654771935717583,0.8063807170988319,-0.9867060769784521,0.9154433557950319,<br>-0.5419217214549653,3.358942981432516,3.33734145389337,3.3960739633218,2.038185222382867,<br>5.241414085016386,3.362823353717864,-0.6013483154102028,0.441480491316843,2.96228336554288,<br>-2.278054802181326,1.446861613005477,1.49864667127073,2.819410923921955,3.668112206659865,<br>0.8253991892717565,1.117718710956935,3.976040128045549,1.261678474198661,-0.03343173803015926,<br>-0.4908566523519207,0.3532664087054739,-1.679362022373703,-1.555760053262808,1.213022071911081,<br>3.421072023150202,2.523431239569371,-1.218844344999495,-0.270208787763775,-0.1217560919494103,<br>2.033835091596821,0.4654798734609423,-0.7231540561359688,2.146640407714382,4.286633169106659,<br>1.445348149793759,0.180718235361594,1.527791426438174,-1.010060680847808,1.969758236040937,<br>-0.3553936244225268,1.465488166547136,3.32669874753109,1.061348836020805,2.31746192198435,<br>0.9564080472865206,1.877477903911581,-0.6964242592539615,5.695159167887606,2.807268123194206,<br>-1.69815612298043,0.1881330355284009,0.04018232765300667,2.272096174325846,0.9694913345710192,<br>3.979152197443702,-0.7028546956095989,1.371423010966528,1.646618045628321,0.1919331499516834,<br>3.587928853903195,0.1219688057614579,2.570950727333546,1.888563572434331,1.10249950266553,<br>4.119103539377994,3.824513529111282,1.509248826260637,1.156700011660602,-0.0343697724869282,<br>3.816521442901518,0.0675520018218364,-0.002197033376085265,2.994147650487649,1.856351699226103,<br>3.539838516568062,0.5861211569557628,4.343058450523658,0.1760647082096519,3.678908111531086))<br></font></p></body></html>
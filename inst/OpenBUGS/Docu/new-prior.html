<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>new-prior</title></head><body><p><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000000" size="5"><strong><img src="new-prior0.bmp" alt="[new-prior0]">&nbsp;&nbsp;&nbsp;New-prior: using a new prior distribution <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(illustrated with normal)<br></strong></font><font face="Arial" color="#FF0000" size="2"><br></font><font face="Arial" color="#000000" size="3">This example uses the 'zeros' trick at the prior level. A single zero Poisson observation, with mean phi = phi(</font><font face="Arial" color="#000000" size="3"><em>mu</em></font><font face="Arial" color="#000000" size="3">), say, contributes a term exp(-phi) to the likelihood for </font><font face="Arial" color="#000000" size="3"><em>mu</em></font><font face="Arial" color="#000000" size="3">; if this is combined with a 'flat' prior for </font><font face="Arial" color="#000000" size="3"><em>mu</em></font><font face="Arial" color="#000000" size="3"> then the resulting density function for </font><font face="Arial" color="#000000" size="3"><em>mu</em></font><font face="Arial" color="#000000" size="3"> will be proportional to exp(-phi).<br><br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">x.rep[i] &lt;- x[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# replicate data<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">x[i] ~ dnorm(mu[1], prec[1])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">x.rep[i] ~ dnorm(mu[2], prec[2])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[2] ~ dnorm(0, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 'known' normal prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;trick using a zero to construct a normal(0, 1) prior for mu[1]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">zero &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">zero ~ dpois(phi)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likelihood is exp(-phi)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">phi &lt;- 0.5 * pow(mu[1], 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# -log(N(0, 1))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[1] ~ dflat()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 'flat' prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (k in 1:2) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">prec[k] &lt;- 1 / (sigma[k] * sigma[k])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma[k] ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Data:<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7))<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Initial values:<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;list(sigma = c(1, 1), mu = c(0, 0))<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000000" size="3">The agreement is not wonderful after 10000 iterations ('burn-in' = 5000), but note the high MC error for mu[1]:</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="1"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;mu[1]&nbsp;&nbsp;&nbsp;0.3216&nbsp;&nbsp;&nbsp;0.4179&nbsp;&nbsp;&nbsp;0.01316&nbsp;&nbsp;&nbsp;-0.5135&nbsp;&nbsp;&nbsp;0.3275&nbsp;&nbsp;&nbsp;1.163&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;mu[2]&nbsp;&nbsp;&nbsp;0.307&nbsp;&nbsp;&nbsp;0.4083&nbsp;&nbsp;&nbsp;0.005944&nbsp;&nbsp;&nbsp;-0.541&nbsp;&nbsp;&nbsp;0.3134&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;1.15&nbsp;&nbsp;&nbsp;0.4463&nbsp;&nbsp;&nbsp;0.009842&nbsp;&nbsp;&nbsp;0.6216&nbsp;&nbsp;&nbsp;1.051&nbsp;&nbsp;&nbsp;2.251&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;1.17&nbsp;&nbsp;&nbsp;0.466&nbsp;&nbsp;&nbsp;0.01028&nbsp;&nbsp;&nbsp;0.6254&nbsp;&nbsp;&nbsp;1.058&nbsp;&nbsp;&nbsp;2.389&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;5000<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000000" size="3">Agreement is OK after 100000 iterations!</font><font face="Arial" color="#FF0000" size="2"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><strong>node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;mu[1]&nbsp;&nbsp;&nbsp;0.3139&nbsp;&nbsp;&nbsp;0.4083&nbsp;&nbsp;&nbsp;0.003015&nbsp;&nbsp;&nbsp;-0.523&nbsp;&nbsp;&nbsp;0.3242&nbsp;&nbsp;&nbsp;1.102&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;100000<br>&nbsp;&nbsp;&nbsp;mu[2]&nbsp;&nbsp;&nbsp;0.3103&nbsp;&nbsp;&nbsp;0.4077&nbsp;&nbsp;&nbsp;0.001173&nbsp;&nbsp;&nbsp;-0.5394&nbsp;&nbsp;&nbsp;0.3188&nbsp;&nbsp;&nbsp;1.103&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;100000<br>&nbsp;&nbsp;&nbsp;sigma[1]&nbsp;&nbsp;&nbsp;1.156&nbsp;&nbsp;&nbsp;0.4536&nbsp;&nbsp;&nbsp;0.002268&nbsp;&nbsp;&nbsp;0.6189&nbsp;&nbsp;&nbsp;1.053&nbsp;&nbsp;&nbsp;2.286&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;100000<br>&nbsp;&nbsp;&nbsp;sigma[2]&nbsp;&nbsp;&nbsp;1.158&nbsp;&nbsp;&nbsp;0.4497&nbsp;&nbsp;&nbsp;0.002164&nbsp;&nbsp;&nbsp;0.6225&nbsp;&nbsp;&nbsp;1.056&nbsp;&nbsp;&nbsp;2.308&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;100000<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Note that the autocorrelation is quite high:<br><center></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br><img src="new-prior1.bmp" alt="[new-prior1]"><br></center></font></p></body></html>